<?xml version="1.0" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<xwikidoc version="1.3" reference="Presentation.PresentationSkin" locale="">
  <web>Presentation</web>
  <name>PresentationSkin</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <creationDate>1564816944000</creationDate>
  <parent>Presentation.WebHome</parent>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <date>1565156921000</date>
  <contentUpdateDate>1565156921000</contentUpdateDate>
  <version>1.1</version>
  <title>Presentation Skin</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.0</syntaxId>
  <hidden>true</hidden>
  <content>= Example =

Check out this [[Presentation about XWiki as web development platform&gt;&gt;XWikiPresentation]] to see this skin in action.

= Usage =

To use this Presentation Skin, follow these steps:

1. Create a document with some content such as for example:(((
{{code language="none"}}
= XWiki =

A collaborative development platform runtime based on the wiki paradigm


(% style="font-size: 70%;" %)
(((
Vincent Massol
October 2011
)))

=== Agenda ===

* What is XWiki?
* Development Capabilities
* Why use XWiki?
* QA

=== Slide 1 ===

This is a paragraph on slide 1

(% class="build" %)
* item 1
* item 2

=== Slide 2 ===

Hello world!

image:http://www.xwiki.org/xwiki/bin/download/ColorThemes/MainCT/logo.png

=== Slide 3 ===

|=Header1|=Header2
|//value1//|**value2**

##monospace##

=== Slide 4 ===

{{code language="java"}}
...
// Find all sections and create one &lt;article&gt; per section
def xdom =
   xwiki.getDocument("Main.Test2").getDocument().getXDOM()
xdom.getBlocks(new ClassBlockMatcher(
  HeaderBlock.class), Block.Axes.DESCENDANT).each()
{
...
}
{{/code}}
{{/code}}
)))
1. Attach an Object of type ##Presentation.PresentationClass##
1. Click the "Run the presentation" button!
</content>
  <attachment>
    <filename>logo.png</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1564816944000</date>
    <version>1.1</version>
    <comment/>
    <content>iVBORw0KGgoAAAANSUhEUgAAADMAAAAzCAYAAAA6oTAqAAAECklEQVR4XtWaMWgTURjH36AQMdobFBwU0k4ODh06ZMhwQweHtrl7LwEHhwxOpZWisXQQLASt0sGhg4NDBoeCDqIpdOxQJIUODhkydAjYoYNChw4OBZ/vP5SGkr7/Xd7l2jz4CDfk3f2+7733/77vTgx6VOq5zNy3exPlz7ezYpgHQJ42xlrzG2N6fmO0Y669oYWZ/57LA+TEZhtjhQsBCILAKxbDahjKj2GolnAdF2aukfO7YXAdF6BcLmeDQM0Vi+pDEMiX09PTt2JPUCzKtoHQJ2Ym3DMT30kTBg40zmydfY5YjoUnTkG6gWQHnkkDxvf9K8ahTQD0sKXIMAgpAHoDhVuVSiXjBsNBzH0+nf8Msh4DJqwC4HyTX3DDQcEEgVyz3R97J+5a3bcBGeCVQcBgiRNH7ksp74o4Qyl133jgt31itZTk0RyG4ZRZ4n8tETnEc4l+xsyMmjAAR5bJj80mLVnVvzHa5qKJiJR8AnIspcwTAHoYTDIg49GCDQgRAghZBYfkHlMiiQHvA2AQXoMIQjvs+1M+EUkOA7Bqv6E6MGKWiyuKBmSXHjSDGDj72UkTNUuAVkGzbCC4H5EAYlyVN4kGbGPpcFGUX8nS2gSwMwD3qNy2A6mGzaNQcALSTBSEb1rZIRGq96fupZ+YP+0SIQc1JkC1MyALxAEdou5uRhT7AcsSkJ44qHu6hiyBKbexRQsI7AjzpATARRUPbQH6R0SxJC7TQNJpe2AL6HKyAMv1jHi3kxe1pt/T3u4UxPJWNnZRx22VAeiKyOhnN/O66vk97fmNgp4V2VOQN82WWNnRxDoGyIuTJRAtWYcWUZDqSEsvetpuIx0D7Qnx+sc4ACIZoofB1f0X0aA/UZoSeuH6OACiGKJ3Epl2cpGRtSiRQQQjLbEXI+3IkcEAEPYF2TNeP70DEqG1KEDYF7Y9A5CEMwJZ6Xk8c6AFwjNMOgMg9fiSgKhJou6AeWWDxf/RAyAAqeRmh6RSrEbZT5jnwlIaVJR9ZM21KJVq6m8IUHeweqaXKOKtggWINcbTrzRR8trUHe1dALj3s917AOusUoRnXZsZAMarlYHB8JJX7aFSTKrNhCU5kO4M+ldJl7zY7BF6Ce8TjogKiLof4Zi2ANAGPQGqJKUlDwmItvWBtRAZfVVMmN+sZcmNwyHsHq4gBXiNiaIVJCNa+prQ5rdjrj2b01ifwJIl8PCjf+ySJJqI5AHSZez9zCOS9hz0Xs78pNlzLnkzwu+GwbVrLwFAPEvgdQkXRQ6T7jtN/rZZ7RJRJDDuDXqkSs7fAQCEqDKFiZM2ke8AHL7QIOruAMP3Lk9E+UTwAEKKNUomcITh384gtUHDMOXGOj+aL7UR0WwT0RwuIEQoDZD/0b05QnZ/b5kAAAAASUVORK5CYII=</content>
    <filesize>1091</filesize>
  </attachment>
  <attachment>
    <filename>logobig.png</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1564816944000</date>
    <version>1.1</version>
    <comment/>
    <content>iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAABnlBMVEUAAAD/eAAAh8r/AABwtwBQUFJAQEBPT1IAh8dQUFJQUFJgYGBQUFJVVVVQUFBRUVJQUFJQUFJVVVVQUFNQUFAAhsxNTU1PT1JSUlJPT1NOTlVPT1JRUVFPT1JQUFJRUVP/dwBRUVFQUFRQUFJQUFFQUFL/AABQUFNPT1JPT1JQUFJQUFJRUVFSUlJQUFJQUFMAiMtOTlNQUFJQUFJQUFJPT1JRUVFQUFNQUFFQUFNQUFJQUFJQUFJRUVJRUVFQUFJRUVNQUFL/dwD/AAAAh8v/eQD/AABxtwAAgL//gABzuQBTU1P/dwD/AAD/AABwtwCAvwBRUVFPT1FPT1MAhsr/dwD/AABxtwD/dwAAh8v/AAD/dQD/dgAAiMwAh8v/dwD/AABwtwD/dwD/eAAAicj/dgD/AAAAhstwtgD/AAAAhs1wtwBQUFD/AABPT1JttgD/AABwtwBwtwBvuQAAh8v/AAD/dwBwtwAAiMz/AAD/dwBxtwBvtwAAhspRUVNQUFJQUFJPT1P/AABPT1H/AAAAh8v/dwBQUFJwtwD////MOmDDAAAAhHRSTlMAYGBgYPsE9yCf3wjvDBCb6/MYzzAoFOcclyTXaLdgeIcsQNOjfFRsp2S72zw4gFxYNOODj8dIUL+zr8uTq0zDi3BYWPMoKFgEBCgo8/ME8wRYdESDg4OD4+MgTByL29vj44sgHFTbVFSLTIsgHFQcTNsgTPv7+/t4eHh4h4f3+vb3h4ddWm4uAAAAAWJLR0SJHGEmzAAADCpJREFUeF7s1KEOwjAURuGKmio0hgSBHY/RpIgWVT1HsoVlTEwgMfexCYKErS0TJCRLzqeP+nNz1boBAAAAAIDgrLYuLIfoYi8vdXNbKDF4efOXryXuo3yIqgzDKBPl20LnZcoX/xaizDWFEqGXuTrkUzhJuXwKKymbT6ElpdWPGAuMxVinY7Uxpjq3axurvR62xjx2e/UnT3bupqd1KwgD8CzqY8VO4sRB+cYREJQACQgSuIRvVpXKok276Lq7SrVStV100e7u4u3P7gqpvQJyRvEcTwLPL7BehPJ6zhmnkyM8O5u01yesdP/Ie37w4CElec2Ch//yCu31CKseffng4nF1q/hS9WAdwppX8KXqgCSZCC+JjPqwWnhJPyQ5Q7ysYJSHFeFlt4akTPGaG91h3eA1EQk5wesGmsMa4HUHJCKu4A2J3rDmHl5XbZOEAt7ijbSGNfLxliEJSD28qdLWGVbawNsk2nwPSwRNjWHFAZY4puzdY5m9ur6wytdYpkaZa3pY6t5oC8scYrknytocFvpGWVgFWEgoa/uwcaMrrAfYOKastWClqymsxIONSKBlWfEu9IQ18mGlQFmLYMcbaQlrq4K8wurBUqOpI6z4DBZkitYCtvZKGsIKz2FrTllrw9phKf+wzAzWdihzHVgb5h9WBGsBZW8Ce8d5h9WDvSllr+nD3kG+YSUerHkpCZiCIZENiz/tczxYLldhzxvlF9bIh71qTCK6YKi08worbYBhQEJuwBA08wkrDsDQMiRlCIZaKY+wwnMwHIYkJrwHw63JIawhGK5LJKgegCFyH1YLDGdNEvVUBMO+67C6YKjukLBdDwwLt2H9wGo3FyQuAYM/dhnWVhEMXXJgAobijruwnipgeCAnIjAEsauwyh3mT7XCtGplN2GVrllZheTKDAyHxsk6yhXzmZwp1cDQcrHodAyGTpkcinkvq/IrdAMwNNrk1FYVDIn0cubc4/UZx+481nRLdu137POasnOPYChuSS2U8wvW95SDFhiCOln5639Z/S1QsCJDeZjxpltSH8EIz6VLg/sCMTRCn1fpy5cG9wWiYEQ+3PMgUBoUFIh9EtATGIJoKBBIKHMnAuM1MYlA3WIY+wKlQU4iULeEJliPlLt9gbolMsGakAJ9gbolULCGhhQwlzk98xAM9yFJEprn3uRyq+coJiXaFTB0cygNxSdSY+Q7r1uLKuz5u6TIJ9d1a8z886jS49UttwVrQsp8dlm3yh2JAxP90y35grUdkjrhJRi2aQVXYLgMSaHyHhgeHP3Hd+qkUtpw8lrbBUMjJQEKDhMljghPSa0LVt0ay20RPvtEinXBUDwlth2hNyv9dessJaZmAIbPpFwfgNgep1E/weLXLak9TjOTLFj661ZEDC3ZgqW/bvXIWk+6YOmvWwdkKREvWPrrFu7IyqmvpWDpr1tbTgqW/rpVTGmp5plAwdIiynYWWOoIFCw9ZlnuSJptgWmfImENDH0jtdKhH39XeZrdfD+mNfRUyWix4EBgDU2dXR/2vDvGxqX241T5oeZWFhuXJ6SM1NtcvPqWUI/WWGvVmy7lPRXHqfqPXvkFy9BaC2ur7JeaoVDB0l+3+DfdpvoLlpobxQMFBUt13ZrTM1r4CgqW6rrljRkDV+mCpf+mW8qYYEkXLP17nDH/h6FFm8Oc8+oW95MW54Y2SPmIOd3qyy256JdWwBC1sFaX3PNddlO/cSl/VV7GgjbQI0Q80kaaQsCUNtQtMndlaEOFM/DwDxzfWTll1tcNVg5gQcdHWfXvccqU0Y9y6u/Sxlt4yMacbH2U0x7Z+iinEb0TM6zsskTvRLmGFe3V6d1oBlhJo01q/Evcvaw0DERhAJ4EarVaL9jUheAddCVxo6K2i5BAAllpAi21LdRKQbIspRS8ITPz2i67S3P+IZzvAWYRhjMnJ/yT0HHtwlwnFGSNLW1gD4iTRYFnFeYFkShmnAwkSbe/LqheKhpWaQuq13SoSDqjN1HAhy/J/Alw7xbsUlD1YkUWv4uV5lOJSATVtQZgKcLFTCHSlftqKjGTsv7yav775d5MYVbsrbEvQT65bq1daUCrTq5XsQLF+XUrkbA+nOMsOXGZKthI5AgHEtYNwRxnyYnLaKhgnbwOwpEGHCzHWXbiMlAGgpyFXWnAFXSNL03wjSQuPWXAy1nYlgZs5GH9aIJf5GFZyoDFtLPwKy3wrIn5zuKvWXiBP2/y1Cz+07D+qMn2myynIX+f1cI+QTP0Wfwd/JOG7DB08Ozvhs8adMz9brg0l5BPQdSuatSdIFooyAn7PGuZJIBVbxnmWYyT0uxAG9jNGCalbDP4rKaN1LLSZ/D/7F3fS+NoFL0gSUnStKYraWzVZV07nU79QW1r1c7YiuBLaWFG8MGneRoQ4uCLD/NsYP/tYR4W1w3L9uPk9ub74nkvhNNCTs+99xzKC2x8FOZTQWCfAzThxUzaRa/g2CMTgQssvPLobR++Q9oBEFgoTkgT4N35OIINMhphN9MF3BoZjIqCgwW4W2YAEFhA7IXR179Qw6rBd+U4DkkU8lWIb3LrhOuU9aI4AgtHoHWuCu5g9VvABoT28JTGqe8Vowq6PmkLPJRV/RNFdbDGPhGRNwF2Jw0XWOmLy9AtpNwaWcrvNnWDolNAB6t0k/qgqe4WPiIcpcrigWGidgibQPxH29ysI3x9exPatDn1iuRgndnw53XGAA1l9ceFSbNT+ovnRngo7GFRBNYsC7tiVIw01//USTclYHdLBoK9jR2g0FsT1JqZXVz2gVR5o6tk8DvOpm+2gzX5v5KiiZK7pRtbTrZHJpXfDHa3vmTtodfqxu5ubSkJLIbKvkutR4R4pMWuBai2/OKPAI20wBsmrQNNBFYXF1h4bEY5Ig1Q4SvGdoxLjdpWK93mE2+nhkUCNyukBF+t8khAbvHF8RzHpIioa1CP7Y7FvP4yKxvTkHxhsVtPuyVdgvVxlY2Hsn4HAu+EgBdjt1ZVeZRLVJpA35wKpkpeYC7lljdcWer9tvaZ8Xur6230x5qXuw9WeXQTdrUevV6udgIzW9c44PtIyWzaJRi9krabbvullfc2fga+HlE06mpuHwz1wtaG1gILx0BHueWdCq2snwOjSSHYZ0r+JSCwMHdr29aubzWSK/R2NBunrjckN6Fb8i06orVCPZ3crV6g9LDSX9a+PvtqLcGtCvlNt5qS2+fYtBwW11drV9cLjhdMPSIh+GOOlf6H22/JL3y9v6NlYH/QIqXsnMPBepwnf2P+juE7E5JbVY5Nzx9PyT9wy+BnOxJs9Tl6Gx+fkld4x9AwORXYweKwSB7myWvM7xgsok6+Yxp2aDncJv/GPYP5WNqQj2nABdbiW4qsrwtwmCgfBBE2WQYG10ka1xwZ4G6NVgZ7wnMFeJWkccUiZIa+8JI7PiJcS9JY45HIn3K5g+VGhJGFuFvyu1sdCxBYjGTRDD1D08cUwcmiA2Aix4ID4LCUmywaWfiqvLyRi5PFILfWZ8SKyp+AwILI4pBbzZAY4Q+BihyALDbfyM9LtfjQIwGyvElOMvirgMBCyQLklsgd5xbgYMFkccmtNrEgCgCBBZPFJbeCWP7seURyZNHIkp7qxxb648bJ4rjjtDhWt56BCyOELPYBwYCyRxd4xSBksbtIbvbyYQYcBEBk8YdwZG/JH6kEjcqTRWFXcNrTh5YvcLIY5dZUTL0HPcoHWbRRFhMPDhBpwUwWmlLmSP2yOiRAFjh6dYSyDqckQBbqBfazt96BazUxsmhPxoyPLWBfTYwsb5lNN4ZTFRcINGEkC08pq0uMVo9jyh9ZFLkS49bYAsQoQBb3RrXVEPCz9imfZFHPErhSicvANBwgi3ffIGgQC44AB0uSLDqU2JncBFaAJcmiqkTlXxXiCidL/sFxtqo25Zws2pTYiW8HaVNmy6bck0U75fSDt23iReS81luW0yDSgCwKUw8eEz/i5xdRXH+eEelBFlHcf3lwd9D42c4dqjAIRmEY/kEYnGQx2RYUTAZvYCDYNrAYlkyCsIHFYB1e+LLpCz94EN7nBg58/T3hJPe6MbOmFgcdxhI+fZGaParsFhx4jOWPsRiLsaBzFOjQCXEJHXScCZ39Ij4ox3bY6hcQ8QQD6r0K9OOeKwMAAAAAAH9jOCbZJ+wumQAAAABJRU5ErkJggg==</content>
    <filesize>3754</filesize>
  </attachment>
  <attachment>
    <filename>prettify.js</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1564816944000</date>
    <version>1.1</version>
    <comment/>
    <content>Ly8gQ29weXJpZ2h0IChDKSAyMDA2IEdvb2dsZSBJbmMuCi8vCi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwovLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAovLwovLyAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAovLwovLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgovLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoKCi8qKgogKiBAZmlsZW92ZXJ2aWV3CiAqIHNvbWUgZnVuY3Rpb25zIGZvciBicm93c2VyLXNpZGUgcHJldHR5IHByaW50aW5nIG9mIGNvZGUgY29udGFpbmVkIGluIGh0bWwuCiAqCiAqIDxwPgogKiBGb3IgYSBmYWlybHkgY29tcHJlaGVuc2l2ZSBzZXQgb2YgbGFuZ3VhZ2VzIHNlZSB0aGUKICogPGEgaHJlZj0iaHR0cDovL2dvb2dsZS1jb2RlLXByZXR0aWZ5Lmdvb2dsZWNvZGUuY29tL3N2bi90cnVuay9SRUFETUUuaHRtbCNsYW5ncyI+UkVBRE1FPC9hPgogKiBmaWxlIHRoYXQgY2FtZSB3aXRoIHRoaXMgc291cmNlLiAgQXQgYSBtaW5pbXVtLCB0aGUgbGV4ZXIgc2hvdWxkIHdvcmsgb24gYQogKiBudW1iZXIgb2YgbGFuZ3VhZ2VzIGluY2x1ZGluZyBDIGFuZCBmcmllbmRzLCBKYXZhLCBQeXRob24sIEJhc2gsIFNRTCwgSFRNTCwKICogWE1MLCBDU1MsIEphdmFzY3JpcHQsIGFuZCBNYWtlZmlsZXMuICBJdCB3b3JrcyBwYXNzYWJseSBvbiBSdWJ5LCBQSFAgYW5kIEF3awogKiBhbmQgYSBzdWJzZXQgb2YgUGVybCwgYnV0LCBiZWNhdXNlIG9mIGNvbW1lbnRpbmcgY29udmVudGlvbnMsIGRvZXNuJ3Qgd29yayBvbgogKiBTbWFsbHRhbGssIExpc3AtbGlrZSwgb3IgQ0FNTC1saWtlIGxhbmd1YWdlcyB3aXRob3V0IGFuIGV4cGxpY2l0IGxhbmcgY2xhc3MuCiAqIDxwPgogKiBVc2FnZTogPG9sPgogKiA8bGk+IGluY2x1ZGUgdGhpcyBzb3VyY2UgZmlsZSBpbiBhbiBodG1sIHBhZ2UgdmlhCiAqICAge0Bjb2RlIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Ii9wYXRoL3RvL3ByZXR0aWZ5LmpzIj48L3NjcmlwdD59CiAqIDxsaT4gZGVmaW5lIHN0eWxlIHJ1bGVzLiAgU2VlIHRoZSBleGFtcGxlIHBhZ2UgZm9yIGV4YW1wbGVzLgogKiA8bGk+IG1hcmsgdGhlIHtAY29kZSA8cHJlPn0gYW5kIHtAY29kZSA8Y29kZT59IHRhZ3MgaW4geW91ciBzb3VyY2Ugd2l0aAogKiAgICB7QGNvZGUgY2xhc3M9cHJldHR5cHJpbnQufQogKiAgICBZb3UgY2FuIGFsc28gdXNlIHRoZSAoaHRtbCBkZXByZWNhdGVkKSB7QGNvZGUgPHhtcD59IHRhZywgYnV0IHRoZSBwcmV0dHkKICogICAgcHJpbnRlciBuZWVkcyB0byBkbyBtb3JlIHN1YnN0YW50aWFsIERPTSBtYW5pcHVsYXRpb25zIHRvIHN1cHBvcnQgdGhhdCwgc28KICogICAgc29tZSBjc3Mgc3R5bGVzIG1heSBub3QgYmUgcHJlc2VydmVkLgogKiA8L29sPgogKiBUaGF0J3MgaXQuICBJIHdhbnRlZCB0byBrZWVwIHRoZSBBUEkgYXMgc2ltcGxlIGFzIHBvc3NpYmxlLCBzbyB0aGVyZSdzIG5vCiAqIG5lZWQgdG8gc3BlY2lmeSB3aGljaCBsYW5ndWFnZSB0aGUgY29kZSBpcyBpbiwgYnV0IGlmIHlvdSB3aXNoLCB5b3UgY2FuIGFkZAogKiBhbm90aGVyIGNsYXNzIHRvIHRoZSB7QGNvZGUgPHByZT59IG9yIHtAY29kZSA8Y29kZT59IGVsZW1lbnQgdG8gc3BlY2lmeSB0aGUKICogbGFuZ3VhZ2UsIGFzIGluIHtAY29kZSA8cHJlIGNsYXNzPSJwcmV0dHlwcmludCBsYW5nLWphdmEiPn0uICBBbnkgY2xhc3MgdGhhdAogKiBzdGFydHMgd2l0aCAibGFuZy0iIGZvbGxvd2VkIGJ5IGEgZmlsZSBleHRlbnNpb24sIHNwZWNpZmllcyB0aGUgZmlsZSB0eXBlLgogKiBTZWUgdGhlICJsYW5nLSouanMiIGZpbGVzIGluIHRoaXMgZGlyZWN0b3J5IGZvciBjb2RlIHRoYXQgaW1wbGVtZW50cwogKiBwZXItbGFuZ3VhZ2UgZmlsZSBoYW5kbGVycy4KICogPHA+CiAqIENoYW5nZSBsb2c6PGJyPgogKiBjYmV1c3QsIDIwMDYvMDgvMjIKICogPGJsb2NrcXVvdGU+CiAqICAgSmF2YSBhbm5vdGF0aW9ucyAoc3RhcnQgd2l0aCAiQCIpIGFyZSBub3cgY2FwdHVyZWQgYXMgbGl0ZXJhbHMgKCJsaXQiKQogKiA8L2Jsb2NrcXVvdGU+CiAqIEByZXF1aXJlcyBjb25zb2xlCiAqLwoKLy8gSlNMaW50IGRlY2xhcmF0aW9ucwovKmdsb2JhbCBjb25zb2xlLCBkb2N1bWVudCwgbmF2aWdhdG9yLCBzZXRUaW1lb3V0LCB3aW5kb3cgKi8KCi8qKgogKiBTcGxpdCB7QGNvZGUgcHJldHR5UHJpbnR9IGludG8gbXVsdGlwbGUgdGltZW91dHMgc28gYXMgbm90IHRvIGludGVyZmVyZSB3aXRoCiAqIFVJIGV2ZW50cy4KICogSWYgc2V0IHRvIHtAY29kZSBmYWxzZX0sIHtAY29kZSBwcmV0dHlQcmludCgpfSBpcyBzeW5jaHJvbm91cy4KICovCndpbmRvd1snUFJfU0hPVUxEX1VTRV9DT05USU5VQVRJT04nXSA9IHRydWU7CgovKiogdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGJldHdlZW4gdGFiIGNvbHVtbnMgKi8Kd2luZG93WydQUl9UQUJfV0lEVEgnXSA9IDg7CgovKiogQ29udGFpbnMgZnVuY3Rpb25zIGZvciBjcmVhdGluZyBhbmQgcmVnaXN0ZXJpbmcgbmV3IGxhbmd1YWdlIGhhbmRsZXJzLgogICogQHR5cGUge09iamVjdH0KICAqLwp3aW5kb3dbJ1BSJ10KCi8qKiBQcmV0dHkgcHJpbnQgYSBjaHVuayBvZiBjb2RlLgogICoKICAqIEBwYXJhbSB7c3RyaW5nfSBzb3VyY2VDb2RlSHRtbCBjb2RlIGFzIGh0bWwKICAqIEByZXR1cm4ge3N0cmluZ30gY29kZSBhcyBodG1sLCBidXQgcHJldHRpZXIKICAqLwogID0gd2luZG93WydwcmV0dHlQcmludE9uZSddCi8qKiBGaW5kIGFsbCB0aGUge0Bjb2RlIDxwcmU+fSBhbmQge0Bjb2RlIDxjb2RlPn0gdGFncyBpbiB0aGUgRE9NIHdpdGgKICAqIHtAY29kZSBjbGFzcz1wcmV0dHlwcmludH0gYW5kIHByZXR0aWZ5IHRoZW0uCiAgKiBAcGFyYW0ge0Z1bmN0aW9uP30gb3B0X3doZW5Eb25lIGlmIHNwZWNpZmllZCwgY2FsbGVkIHdoZW4gdGhlIGxhc3QgZW50cnkKICAqICAgICBoYXMgYmVlbiBmaW5pc2hlZC4KICAqLwogID0gd2luZG93WydwcmV0dHlQcmludCddID0gdm9pZCAwOwoKCihmdW5jdGlvbiAoKSB7CiAgLy8gS2V5d29yZCBsaXN0cyBmb3IgdmFyaW91cyBsYW5ndWFnZXMuCiAgdmFyIEZMT1dfQ09OVFJPTF9LRVlXT1JEUyA9CiAgICAgICJicmVhayBjb250aW51ZSBkbyBlbHNlIGZvciBpZiByZXR1cm4gd2hpbGUgIjsKICB2YXIgQ19LRVlXT1JEUyA9IEZMT1dfQ09OVFJPTF9LRVlXT1JEUyArICJhdXRvIGNhc2UgY2hhciBjb25zdCBkZWZhdWx0ICIgKwogICAgICAiZG91YmxlIGVudW0gZXh0ZXJuIGZsb2F0IGdvdG8gaW50IGxvbmcgcmVnaXN0ZXIgc2hvcnQgc2lnbmVkIHNpemVvZiAiICsKICAgICAgInN0YXRpYyBzdHJ1Y3Qgc3dpdGNoIHR5cGVkZWYgdW5pb24gdW5zaWduZWQgdm9pZCB2b2xhdGlsZSAiOwogIHZhciBDT01NT05fS0VZV09SRFMgPSBDX0tFWVdPUkRTICsgImNhdGNoIGNsYXNzIGRlbGV0ZSBmYWxzZSBpbXBvcnQgIiArCiAgICAgICJuZXcgb3BlcmF0b3IgcHJpdmF0ZSBwcm90ZWN0ZWQgcHVibGljIHRoaXMgdGhyb3cgdHJ1ZSB0cnkgdHlwZW9mICI7CiAgdmFyIENQUF9LRVlXT1JEUyA9IENPTU1PTl9LRVlXT1JEUyArICJhbGlnbm9mIGFsaWduX3VuaW9uIGFzbSBheGlvbSBib29sICIgKwogICAgICAiY29uY2VwdCBjb25jZXB0X21hcCBjb25zdF9jYXN0IGNvbnN0ZXhwciBkZWNsdHlwZSAiICsKICAgICAgImR5bmFtaWNfY2FzdCBleHBsaWNpdCBleHBvcnQgZnJpZW5kIGlubGluZSBsYXRlX2NoZWNrICIgKwogICAgICAibXV0YWJsZSBuYW1lc3BhY2UgbnVsbHB0ciByZWludGVycHJldF9jYXN0IHN0YXRpY19hc3NlcnQgc3RhdGljX2Nhc3QgIiArCiAgICAgICJ0ZW1wbGF0ZSB0eXBlaWQgdHlwZW5hbWUgdXNpbmcgdmlydHVhbCB3Y2hhcl90IHdoZXJlICI7CiAgdmFyIEpBVkFfS0VZV09SRFMgPSBDT01NT05fS0VZV09SRFMgKwogICAgICAiYWJzdHJhY3QgYm9vbGVhbiBieXRlIGV4dGVuZHMgZmluYWwgZmluYWxseSBpbXBsZW1lbnRzIGltcG9ydCAiICsKICAgICAgImluc3RhbmNlb2YgbnVsbCBuYXRpdmUgcGFja2FnZSBzdHJpY3RmcCBzdXBlciBzeW5jaHJvbml6ZWQgdGhyb3dzICIgKwogICAgICAidHJhbnNpZW50ICI7CiAgdmFyIENTSEFSUF9LRVlXT1JEUyA9IEpBVkFfS0VZV09SRFMgKwogICAgICAiYXMgYmFzZSBieSBjaGVja2VkIGRlY2ltYWwgZGVsZWdhdGUgZGVzY2VuZGluZyBkeW5hbWljIGV2ZW50ICIgKwogICAgICAiZml4ZWQgZm9yZWFjaCBmcm9tIGdyb3VwIGltcGxpY2l0IGluIGludGVyZmFjZSBpbnRlcm5hbCBpbnRvIGlzIGxvY2sgIiArCiAgICAgICJvYmplY3Qgb3V0IG92ZXJyaWRlIG9yZGVyYnkgcGFyYW1zIHBhcnRpYWwgcmVhZG9ubHkgcmVmIHNieXRlIHNlYWxlZCAiICsKICAgICAgInN0YWNrYWxsb2Mgc3RyaW5nIHNlbGVjdCB1aW50IHVsb25nIHVuY2hlY2tlZCB1bnNhZmUgdXNob3J0IHZhciAiOwogIHZhciBDT0ZGRUVfS0VZV09SRFMgPSAiYWxsIGFuZCBieSBjYXRjaCBjbGFzcyBlbHNlIGV4dGVuZHMgZmFsc2UgZmluYWxseSAiICsKICAgICAgImZvciBpZiBpbiBpcyBpc250IGxvb3AgbmV3IG5vIG5vdCBudWxsIG9mIG9mZiBvbiBvciByZXR1cm4gc3VwZXIgdGhlbiAiICsKICAgICAgInRydWUgdHJ5IHVubGVzcyB1bnRpbCB3aGVuIHdoaWxlIHllcyAiOwogIHZhciBKU0NSSVBUX0tFWVdPUkRTID0gQ09NTU9OX0tFWVdPUkRTICsKICAgICAgImRlYnVnZ2VyIGV2YWwgZXhwb3J0IGZ1bmN0aW9uIGdldCBudWxsIHNldCB1bmRlZmluZWQgdmFyIHdpdGggIiArCiAgICAgICJJbmZpbml0eSBOYU4gIjsKICB2YXIgUEVSTF9LRVlXT1JEUyA9ICJjYWxsZXIgZGVsZXRlIGRpZSBkbyBkdW1wIGVsc2lmIGV2YWwgZXhpdCBmb3JlYWNoIGZvciAiICsKICAgICAgImdvdG8gaWYgaW1wb3J0IGxhc3QgbG9jYWwgbXkgbmV4dCBubyBvdXIgcHJpbnQgcGFja2FnZSByZWRvIHJlcXVpcmUgIiArCiAgICAgICJzdWIgdW5kZWYgdW5sZXNzIHVudGlsIHVzZSB3YW50YXJyYXkgd2hpbGUgQkVHSU4gRU5EICI7CiAgdmFyIFBZVEhPTl9LRVlXT1JEUyA9IEZMT1dfQ09OVFJPTF9LRVlXT1JEUyArICJhbmQgYXMgYXNzZXJ0IGNsYXNzIGRlZiBkZWwgIiArCiAgICAgICJlbGlmIGV4Y2VwdCBleGVjIGZpbmFsbHkgZnJvbSBnbG9iYWwgaW1wb3J0IGluIGlzIGxhbWJkYSAiICsKICAgICAgIm5vbmxvY2FsIG5vdCBvciBwYXNzIHByaW50IHJhaXNlIHRyeSB3aXRoIHlpZWxkICIgKwogICAgICAiRmFsc2UgVHJ1ZSBOb25lICI7CiAgdmFyIFJVQllfS0VZV09SRFMgPSBGTE9XX0NPTlRST0xfS0VZV09SRFMgKyAiYWxpYXMgYW5kIGJlZ2luIGNhc2UgY2xhc3MgZGVmIiArCiAgICAgICIgZGVmaW5lZCBlbHNpZiBlbmQgZW5zdXJlIGZhbHNlIGluIG1vZHVsZSBuZXh0IG5pbCBub3Qgb3IgcmVkbyByZXNjdWUgIiArCiAgICAgICJyZXRyeSBzZWxmIHN1cGVyIHRoZW4gdHJ1ZSB1bmRlZiB1bmxlc3MgdW50aWwgd2hlbiB5aWVsZCBCRUdJTiBFTkQgIjsKICB2YXIgU0hfS0VZV09SRFMgPSBGTE9XX0NPTlRST0xfS0VZV09SRFMgKyAiY2FzZSBkb25lIGVsaWYgZXNhYyBldmFsIGZpICIgKwogICAgICAiZnVuY3Rpb24gaW4gbG9jYWwgc2V0IHRoZW4gdW50aWwgIjsKICB2YXIgQUxMX0tFWVdPUkRTID0gKAogICAgICBDUFBfS0VZV09SRFMgKyBDU0hBUlBfS0VZV09SRFMgKyBKU0NSSVBUX0tFWVdPUkRTICsgUEVSTF9LRVlXT1JEUyArCiAgICAgIFBZVEhPTl9LRVlXT1JEUyArIFJVQllfS0VZV09SRFMgKyBTSF9LRVlXT1JEUyk7CgogIC8vIHRva2VuIHN0eWxlIG5hbWVzLiAgY29ycmVzcG9uZCB0byBjc3MgY2xhc3NlcwogIC8qKiB0b2tlbiBzdHlsZSBmb3IgYSBzdHJpbmcgbGl0ZXJhbCAqLwogIHZhciBQUl9TVFJJTkcgPSAnc3RyJzsKICAvKiogdG9rZW4gc3R5bGUgZm9yIGEga2V5d29yZCAqLwogIHZhciBQUl9LRVlXT1JEID0gJ2t3ZCc7CiAgLyoqIHRva2VuIHN0eWxlIGZvciBhIGNvbW1lbnQgKi8KICB2YXIgUFJfQ09NTUVOVCA9ICdjb20nOwogIC8qKiB0b2tlbiBzdHlsZSBmb3IgYSB0eXBlICovCiAgdmFyIFBSX1RZUEUgPSAndHlwJzsKICAvKiogdG9rZW4gc3R5bGUgZm9yIGEgbGl0ZXJhbCB2YWx1ZS4gIGUuZy4gMSwgbnVsbCwgdHJ1ZS4gKi8KICB2YXIgUFJfTElURVJBTCA9ICdsaXQnOwogIC8qKiB0b2tlbiBzdHlsZSBmb3IgYSBwdW5jdHVhdGlvbiBzdHJpbmcuICovCiAgdmFyIFBSX1BVTkNUVUFUSU9OID0gJ3B1bic7CiAgLyoqIHRva2VuIHN0eWxlIGZvciBhIHB1bmN0dWF0aW9uIHN0cmluZy4gKi8KICB2YXIgUFJfUExBSU4gPSAncGxuJzsKCiAgLyoqIHRva2VuIHN0eWxlIGZvciBhbiBzZ21sIHRhZy4gKi8KICB2YXIgUFJfVEFHID0gJ3RhZyc7CiAgLyoqIHRva2VuIHN0eWxlIGZvciBhIG1hcmt1cCBkZWNsYXJhdGlvbiBzdWNoIGFzIGEgRE9DVFlQRS4gKi8KICB2YXIgUFJfREVDTEFSQVRJT04gPSAnZGVjJzsKICAvKiogdG9rZW4gc3R5bGUgZm9yIGVtYmVkZGVkIHNvdXJjZS4gKi8KICB2YXIgUFJfU09VUkNFID0gJ3NyYyc7CiAgLyoqIHRva2VuIHN0eWxlIGZvciBhbiBzZ21sIGF0dHJpYnV0ZSBuYW1lLiAqLwogIHZhciBQUl9BVFRSSUJfTkFNRSA9ICdhdG4nOwogIC8qKiB0b2tlbiBzdHlsZSBmb3IgYW4gc2dtbCBhdHRyaWJ1dGUgdmFsdWUuICovCiAgdmFyIFBSX0FUVFJJQl9WQUxVRSA9ICdhdHYnOwoKICAvKioKICAgKiBBIGNsYXNzIHRoYXQgaW5kaWNhdGVzIGEgc2VjdGlvbiBvZiBtYXJrdXAgdGhhdCBpcyBub3QgY29kZSwgZS5nLiB0byBhbGxvdwogICAqIGVtYmVkZGluZyBvZiBsaW5lIG51bWJlcnMgd2l0aGluIGNvZGUgbGlzdGluZ3MuCiAgICovCiAgdmFyIFBSX05PQ09ERSA9ICdub2NvZGUnOwoKICAvKiogQSBzZXQgb2YgdG9rZW5zIHRoYXQgY2FuIHByZWNlZGUgYSByZWd1bGFyIGV4cHJlc3Npb24gbGl0ZXJhbCBpbgogICAgKiBqYXZhc2NyaXB0LgogICAgKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL2pzL2xhbmd1YWdlL2pzMjAvcmF0aW9uYWxlL3N5bnRheC5odG1sIGhhcyB0aGUgZnVsbAogICAgKiBsaXN0LCBidXQgSSd2ZSByZW1vdmVkIG9uZXMgdGhhdCBtaWdodCBiZSBwcm9ibGVtYXRpYyB3aGVuIHNlZW4gaW4KICAgICogbGFuZ3VhZ2VzIHRoYXQgZG9uJ3Qgc3VwcG9ydCByZWd1bGFyIGV4cHJlc3Npb24gbGl0ZXJhbHMuCiAgICAqCiAgICAqIDxwPlNwZWNpZmljYWxseSwgSSd2ZSByZW1vdmVkIGFueSBrZXl3b3JkcyB0aGF0IGNhbid0IHByZWNlZGUgYSByZWdleHAKICAgICogbGl0ZXJhbCBpbiBhIHN5bnRhY3RpY2FsbHkgbGVnYWwgamF2YXNjcmlwdCBwcm9ncmFtLCBhbmQgSSd2ZSByZW1vdmVkIHRoZQogICAgKiAiaW4iIGtleXdvcmQgc2luY2UgaXQncyBub3QgYSBrZXl3b3JkIGluIG1hbnkgbGFuZ3VhZ2VzLCBhbmQgbWlnaHQgYmUgdXNlZAogICAgKiBhcyBhIGNvdW50IG9mIGluY2hlcy4KICAgICoKICAgICogPHA+VGhlIGxpbmsgYSBhYm92ZSBkb2VzIG5vdCBhY2N1cmF0ZWx5IGRlc2NyaWJlIEVjbWFTY3JpcHQgcnVsZXMgc2luY2UKICAgICogaXQgZmFpbHMgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiAoYT0rKy9iL2kpIGFuZCAoYSsrL2IvaSkgYnV0IGl0IHdvcmtzCiAgICAqIHZlcnkgd2VsbCBpbiBwcmFjdGljZS4KICAgICoKICAgICogQHByaXZhdGUKICAgICovCiAgdmFyIFJFR0VYUF9QUkVDRURFUl9QQVRURVJOID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgcHJlY2VkZXJzID0gWwogICAgICAgICAgIiEiLCAiIT0iLCAiIT09IiwgIiMiLCAiJSIsICIlPSIsICImIiwgIiYmIiwgIiYmPSIsCiAgICAgICAgICAiJj0iLCAiKCIsICIqIiwgIio9IiwgLyogIisiLCAqLyAiKz0iLCAiLCIsIC8qICItIiwgKi8gIi09IiwKICAgICAgICAgICItPiIsIC8qIi4iLCAiLi4iLCAiLi4uIiwgaGFuZGxlZCBiZWxvdyAqLyAiLyIsICIvPSIsICI6IiwgIjo6IiwgIjsiLAogICAgICAgICAgIjwiLCAiPDwiLCAiPDw9IiwgIjw9IiwgIj0iLCAiPT0iLCAiPT09IiwgIj4iLAogICAgICAgICAgIj49IiwgIj4+IiwgIj4+PSIsICI+Pj4iLCAiPj4+PSIsICI/IiwgIkAiLCAiWyIsCiAgICAgICAgICAiXiIsICJePSIsICJeXiIsICJeXj0iLCAieyIsICJ8IiwgInw9IiwgInx8IiwKICAgICAgICAgICJ8fD0iLCAifiIgLyogaGFuZGxlcyA9fiBhbmQgIX4gKi8sCiAgICAgICAgICAiYnJlYWsiLCAiY2FzZSIsICJjb250aW51ZSIsICJkZWxldGUiLAogICAgICAgICAgImRvIiwgImVsc2UiLCAiZmluYWxseSIsICJpbnN0YW5jZW9mIiwKICAgICAgICAgICJyZXR1cm4iLCAidGhyb3ciLCAidHJ5IiwgInR5cGVvZiIKICAgICAgICAgIF07CiAgICAgIHZhciBwYXR0ZXJuID0gJyg/Ol5efFsrLV0nOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByZWNlZGVycy5sZW5ndGg7ICsraSkgewogICAgICAgIHBhdHRlcm4gKz0gJ3wnICsgcHJlY2VkZXJzW2ldLnJlcGxhY2UoLyhbXj08PjomYS16XSkvZywgJ1xcJDEnKTsKICAgICAgfQogICAgICBwYXR0ZXJuICs9ICcpXFxzKic7ICAvLyBtYXRjaGVzIGF0IGVuZCwgYW5kIG1hdGNoZXMgZW1wdHkgc3RyaW5nCiAgICAgIHJldHVybiBwYXR0ZXJuOwogICAgICAvLyBDQVZFQVQ6IHRoaXMgZG9lcyBub3QgcHJvcGVybHkgaGFuZGxlIHRoZSBjYXNlIHdoZXJlIGEgcmVndWxhcgogICAgICAvLyBleHByZXNzaW9uIGltbWVkaWF0ZWx5IGZvbGxvd3MgYW5vdGhlciBzaW5jZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBtYXkKICAgICAgLy8gaGF2ZSBmbGFncyBmb3IgY2FzZS1zZW5zaXRpdml0eSBhbmQgdGhlIGxpa2UuICBIYXZpbmcgcmVnZXhwIHRva2VucwogICAgICAvLyBhZGphY2VudCBpcyBub3QgdmFsaWQgaW4gYW55IGxhbmd1YWdlIEknbSBhd2FyZSBvZiwgc28gSSdtIHB1bnRpbmcuCiAgICAgIC8vIFRPRE86IG1heWJlIHN0eWxlIHNwZWNpYWwgY2hhcmFjdGVycyBpbnNpZGUgYSByZWdleHAgYXMgcHVuY3R1YXRpb24uCiAgICB9KCk7CgogIAogIC8qKgogICAqIEdpdmVuIGEgZ3JvdXAgb2Yge0BsaW5rIFJlZ0V4cH1zLCByZXR1cm5zIGEge0Bjb2RlIFJlZ0V4cH0gdGhhdCBnbG9iYWxseQogICAqIG1hdGNoZXMgdGhlIHVuaW9uIG9mIHRoZSBzZXRzIG9mIHN0cmluZ3MgbWF0Y2hlZCBieSB0aGUgaW5wdXQgUmVnRXhwLgogICAqIFNpbmNlIGl0IG1hdGNoZXMgZ2xvYmFsbHksIGlmIHRoZSBpbnB1dCBzdHJpbmdzIGhhdmUgYSBzdGFydC1vZi1pbnB1dAogICAqIGFuY2hvciAoL14uLi4vKSwgaXQgaXMgaWdub3JlZCBmb3IgdGhlIHB1cnBvc2VzIG9mIHVuaW9uaW5nLgogICAqIEBwYXJhbSB7QXJyYXkuPFJlZ0V4cD59IHJlZ2V4cyBub24gbXVsdGlsaW5lLCBub24tZ2xvYmFsIHJlZ2V4cy4KICAgKiBAcmV0dXJuIHtSZWdFeHB9IGEgZ2xvYmFsIHJlZ2V4LgogICAqLwogIGZ1bmN0aW9uIGNvbWJpbmVQcmVmaXhQYXR0ZXJucyhyZWdleHMpIHsKICAgIHZhciBjYXB0dXJlZEdyb3VwSW5kZXggPSAwOwogIAogICAgdmFyIG5lZWRUb0ZvbGRDYXNlID0gZmFsc2U7CiAgICB2YXIgaWdub3JlQ2FzZSA9IGZhbHNlOwogICAgZm9yICh2YXIgaSA9IDAsIG4gPSByZWdleHMubGVuZ3RoOyBpIDwgbjsgKytpKSB7CiAgICAgIHZhciByZWdleCA9IHJlZ2V4c1tpXTsKICAgICAgaWYgKHJlZ2V4Lmlnbm9yZUNhc2UpIHsKICAgICAgICBpZ25vcmVDYXNlID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmICgvW2Etel0vaS50ZXN0KHJlZ2V4LnNvdXJjZS5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAvXFx1WzAtOWEtZl17NH18XFx4WzAtOWEtZl17Mn18XFxbXnV4XS9naSwgJycpKSkgewogICAgICAgIG5lZWRUb0ZvbGRDYXNlID0gdHJ1ZTsKICAgICAgICBpZ25vcmVDYXNlID0gZmFsc2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAKICAgIGZ1bmN0aW9uIGRlY29kZUVzY2FwZShjaGFyc2V0UGFydCkgewogICAgICBpZiAoY2hhcnNldFBhcnQuY2hhckF0KDApICE9PSAnXFwnKSB7IHJldHVybiBjaGFyc2V0UGFydC5jaGFyQ29kZUF0KDApOyB9CiAgICAgIHN3aXRjaCAoY2hhcnNldFBhcnQuY2hhckF0KDEpKSB7CiAgICAgICAgY2FzZSAnYic6IHJldHVybiA4OwogICAgICAgIGNhc2UgJ3QnOiByZXR1cm4gOTsKICAgICAgICBjYXNlICduJzogcmV0dXJuIDB4YTsKICAgICAgICBjYXNlICd2JzogcmV0dXJuIDB4YjsKICAgICAgICBjYXNlICdmJzogcmV0dXJuIDB4YzsKICAgICAgICBjYXNlICdyJzogcmV0dXJuIDB4ZDsKICAgICAgICBjYXNlICd1JzogY2FzZSAneCc6CiAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoY2hhcnNldFBhcnQuc3Vic3RyaW5nKDIpLCAxNikKICAgICAgICAgICAgICB8fCBjaGFyc2V0UGFydC5jaGFyQ29kZUF0KDEpOwogICAgICAgIGNhc2UgJzAnOiBjYXNlICcxJzogY2FzZSAnMic6IGNhc2UgJzMnOiBjYXNlICc0JzoKICAgICAgICBjYXNlICc1JzogY2FzZSAnNic6IGNhc2UgJzcnOgogICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGNoYXJzZXRQYXJ0LnN1YnN0cmluZygxKSwgOCk7CiAgICAgICAgZGVmYXVsdDogcmV0dXJuIGNoYXJzZXRQYXJ0LmNoYXJDb2RlQXQoMSk7CiAgICAgIH0KICAgIH0KICAKICAgIGZ1bmN0aW9uIGVuY29kZUVzY2FwZShjaGFyQ29kZSkgewogICAgICBpZiAoY2hhckNvZGUgPCAweDIwKSB7CiAgICAgICAgcmV0dXJuIChjaGFyQ29kZSA8IDB4MTAgPyAnXFx4MCcgOiAnXFx4JykgKyBjaGFyQ29kZS50b1N0cmluZygxNik7CiAgICAgIH0KICAgICAgdmFyIGNoID0gU3RyaW5nLmZyb21DaGFyQ29kZShjaGFyQ29kZSk7CiAgICAgIGlmIChjaCA9PT0gJ1xcJyB8fCBjaCA9PT0gJy0nIHx8IGNoID09PSAnWycgfHwgY2ggPT09ICddJykgewogICAgICAgIGNoID0gJ1xcJyArIGNoOwogICAgICB9CiAgICAgIHJldHVybiBjaDsKICAgIH0KICAKICAgIGZ1bmN0aW9uIGNhc2VGb2xkQ2hhcnNldChjaGFyU2V0KSB7CiAgICAgIHZhciBjaGFyc2V0UGFydHMgPSBjaGFyU2V0LnN1YnN0cmluZygxLCBjaGFyU2V0Lmxlbmd0aCAtIDEpLm1hdGNoKAogICAgICAgICAgbmV3IFJlZ0V4cCgKICAgICAgICAgICAgICAnXFxcXHVbMC05QS1GYS1mXXs0fScKICAgICAgICAgICAgICArICd8XFxcXHhbMC05QS1GYS1mXXsyfScKICAgICAgICAgICAgICArICd8XFxcXFswLTNdWzAtN117MCwyfScKICAgICAgICAgICAgICArICd8XFxcXFswLTddezEsMn0nCiAgICAgICAgICAgICAgKyAnfFxcXFxbXFxzXFxTXScKICAgICAgICAgICAgICArICd8LScKICAgICAgICAgICAgICArICd8W14tXFxcXF0nLAogICAgICAgICAgICAgICdnJykpOwogICAgICB2YXIgZ3JvdXBzID0gW107CiAgICAgIHZhciByYW5nZXMgPSBbXTsKICAgICAgdmFyIGludmVyc2UgPSBjaGFyc2V0UGFydHNbMF0gPT09ICdeJzsKICAgICAgZm9yICh2YXIgaSA9IGludmVyc2UgPyAxIDogMCwgbiA9IGNoYXJzZXRQYXJ0cy5sZW5ndGg7IGkgPCBuOyArK2kpIHsKICAgICAgICB2YXIgcCA9IGNoYXJzZXRQYXJ0c1tpXTsKICAgICAgICBzd2l0Y2ggKHApIHsKICAgICAgICAgIGNhc2UgJ1xcQic6IGNhc2UgJ1xcYic6CiAgICAgICAgICBjYXNlICdcXEQnOiBjYXNlICdcXGQnOgogICAgICAgICAgY2FzZSAnXFxTJzogY2FzZSAnXFxzJzoKICAgICAgICAgIGNhc2UgJ1xcVyc6IGNhc2UgJ1xcdyc6CiAgICAgICAgICAgIGdyb3Vwcy5wdXNoKHApOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgdmFyIHN0YXJ0ID0gZGVjb2RlRXNjYXBlKHApOwogICAgICAgIHZhciBlbmQ7CiAgICAgICAgaWYgKGkgKyAyIDwgbiAmJiAnLScgPT09IGNoYXJzZXRQYXJ0c1tpICsgMV0pIHsKICAgICAgICAgIGVuZCA9IGRlY29kZUVzY2FwZShjaGFyc2V0UGFydHNbaSArIDJdKTsKICAgICAgICAgIGkgKz0gMjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZW5kID0gc3RhcnQ7CiAgICAgICAgfQogICAgICAgIHJhbmdlcy5wdXNoKFtzdGFydCwgZW5kXSk7CiAgICAgICAgLy8gSWYgdGhlIHJhbmdlIG1pZ2h0IGludGVyc2VjdCBsZXR0ZXJzLCB0aGVuIGV4cGFuZCBpdC4KICAgICAgICBpZiAoIShlbmQgPCA2NSB8fCBzdGFydCA+IDEyMikpIHsKICAgICAgICAgIGlmICghKGVuZCA8IDY1IHx8IHN0YXJ0ID4gOTApKSB7CiAgICAgICAgICAgIHJhbmdlcy5wdXNoKFtNYXRoLm1heCg2NSwgc3RhcnQpIHwgMzIsIE1hdGgubWluKGVuZCwgOTApIHwgMzJdKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghKGVuZCA8IDk3IHx8IHN0YXJ0ID4gMTIyKSkgewogICAgICAgICAgICByYW5nZXMucHVzaChbTWF0aC5tYXgoOTcsIHN0YXJ0KSAmIH4zMiwgTWF0aC5taW4oZW5kLCAxMjIpICYgfjMyXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgCiAgICAgIC8vIFtbMSwgMTBdLCBbMywgNF0sIFs4LCAxMl0sIFsxNCwgMTRdLCBbMTYsIDE2XSwgWzE3LCAxN11dCiAgICAgIC8vIC0+IFtbMSwgMTJdLCBbMTQsIDE0XSwgWzE2LCAxN11dCiAgICAgIHJhbmdlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiAoYVswXSAtIGJbMF0pIHx8IChiWzFdICAtIGFbMV0pOyB9KTsKICAgICAgdmFyIGNvbnNvbGlkYXRlZFJhbmdlcyA9IFtdOwogICAgICB2YXIgbGFzdFJhbmdlID0gW05hTiwgTmFOXTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyArK2kpIHsKICAgICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV07CiAgICAgICAgaWYgKHJhbmdlWzBdIDw9IGxhc3RSYW5nZVsxXSArIDEpIHsKICAgICAgICAgIGxhc3RSYW5nZVsxXSA9IE1hdGgubWF4KGxhc3RSYW5nZVsxXSwgcmFuZ2VbMV0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xpZGF0ZWRSYW5nZXMucHVzaChsYXN0UmFuZ2UgPSByYW5nZSk7CiAgICAgICAgfQogICAgICB9CiAgCiAgICAgIHZhciBvdXQgPSBbJ1snXTsKICAgICAgaWYgKGludmVyc2UpIHsgb3V0LnB1c2goJ14nKTsgfQogICAgICBvdXQucHVzaC5hcHBseShvdXQsIGdyb3Vwcyk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uc29saWRhdGVkUmFuZ2VzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgdmFyIHJhbmdlID0gY29uc29saWRhdGVkUmFuZ2VzW2ldOwogICAgICAgIG91dC5wdXNoKGVuY29kZUVzY2FwZShyYW5nZVswXSkpOwogICAgICAgIGlmIChyYW5nZVsxXSA+IHJhbmdlWzBdKSB7CiAgICAgICAgICBpZiAocmFuZ2VbMV0gKyAxID4gcmFuZ2VbMF0pIHsgb3V0LnB1c2goJy0nKTsgfQogICAgICAgICAgb3V0LnB1c2goZW5jb2RlRXNjYXBlKHJhbmdlWzFdKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIG91dC5wdXNoKCddJyk7CiAgICAgIHJldHVybiBvdXQuam9pbignJyk7CiAgICB9CiAgCiAgICBmdW5jdGlvbiBhbGxvd0FueXdoZXJlRm9sZENhc2VBbmRSZW51bWJlckdyb3VwcyhyZWdleCkgewogICAgICAvLyBTcGxpdCBpbnRvIGNoYXJhY3RlciBzZXRzLCBlc2NhcGUgc2VxdWVuY2VzLCBwdW5jdHVhdGlvbiBzdHJpbmdzCiAgICAgIC8vIGxpa2UgKCcoJywgJyg/OicsICcpJywgJ14nKSwgYW5kIHJ1bnMgb2YgY2hhcmFjdGVycyB0aGF0IGRvIG5vdAogICAgICAvLyBpbmNsdWRlIGFueSBvZiB0aGUgYWJvdmUuCiAgICAgIHZhciBwYXJ0cyA9IHJlZ2V4LnNvdXJjZS5tYXRjaCgKICAgICAgICAgIG5ldyBSZWdFeHAoCiAgICAgICAgICAgICAgJyg/OicKICAgICAgICAgICAgICArICdcXFsoPzpbXlxceDVDXFx4NURdfFxcXFxbXFxzXFxTXSkqXFxdJyAgLy8gYSBjaGFyYWN0ZXIgc2V0CiAgICAgICAgICAgICAgKyAnfFxcXFx1W0EtRmEtZjAtOV17NH0nICAvLyBhIHVuaWNvZGUgZXNjYXBlCiAgICAgICAgICAgICAgKyAnfFxcXFx4W0EtRmEtZjAtOV17Mn0nICAvLyBhIGhleCBlc2NhcGUKICAgICAgICAgICAgICArICd8XFxcXFswLTldKycgIC8vIGEgYmFjay1yZWZlcmVuY2Ugb3Igb2N0YWwgZXNjYXBlCiAgICAgICAgICAgICAgKyAnfFxcXFxbXnV4MC05XScgIC8vIG90aGVyIGVzY2FwZSBzZXF1ZW5jZQogICAgICAgICAgICAgICsgJ3xcXChcXD9bOiE9XScgIC8vIHN0YXJ0IG9mIGEgbm9uLWNhcHR1cmluZyBncm91cAogICAgICAgICAgICAgICsgJ3xbXFwoXFwpXFxeXScgIC8vIHN0YXJ0L2VtZCBvZiBhIGdyb3VwLCBvciBsaW5lIHN0YXJ0CiAgICAgICAgICAgICAgKyAnfFteXFx4NUJcXHg1Q1xcKFxcKVxcXl0rJyAgLy8gcnVuIG9mIG90aGVyIGNoYXJhY3RlcnMKICAgICAgICAgICAgICArICcpJywKICAgICAgICAgICAgICAnZycpKTsKICAgICAgdmFyIG4gPSBwYXJ0cy5sZW5ndGg7CiAgCiAgICAgIC8vIE1hcHMgY2FwdHVyZWQgZ3JvdXAgbnVtYmVycyB0byB0aGUgbnVtYmVyIHRoZXkgd2lsbCBvY2N1cHkgaW4KICAgICAgLy8gdGhlIG91dHB1dCBvciB0byAtMSBpZiB0aGF0IGhhcyBub3QgYmVlbiBkZXRlcm1pbmVkLCBvciB0bwogICAgICAvLyB1bmRlZmluZWQgaWYgdGhleSBuZWVkIG5vdCBiZSBjYXB0dXJpbmcgaW4gdGhlIG91dHB1dC4KICAgICAgdmFyIGNhcHR1cmVkR3JvdXBzID0gW107CiAgCiAgICAgIC8vIFdhbGsgb3ZlciBhbmQgaWRlbnRpZnkgYmFjayByZWZlcmVuY2VzIHRvIGJ1aWxkIHRoZSBjYXB0dXJlZEdyb3VwcwogICAgICAvLyBtYXBwaW5nLgogICAgICBmb3IgKHZhciBpID0gMCwgZ3JvdXBJbmRleCA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICB2YXIgcCA9IHBhcnRzW2ldOwogICAgICAgIGlmIChwID09PSAnKCcpIHsKICAgICAgICAgIC8vIGdyb3VwcyBhcmUgMS1pbmRleGVkLCBzbyBtYXggZ3JvdXAgaW5kZXggaXMgY291bnQgb2YgJygnCiAgICAgICAgICArK2dyb3VwSW5kZXg7CiAgICAgICAgfSBlbHNlIGlmICgnXFwnID09PSBwLmNoYXJBdCgwKSkgewogICAgICAgICAgdmFyIGRlY2ltYWxWYWx1ZSA9ICtwLnN1YnN0cmluZygxKTsKICAgICAgICAgIGlmIChkZWNpbWFsVmFsdWUgJiYgZGVjaW1hbFZhbHVlIDw9IGdyb3VwSW5kZXgpIHsKICAgICAgICAgICAgY2FwdHVyZWRHcm91cHNbZGVjaW1hbFZhbHVlXSA9IC0xOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogIAogICAgICAvLyBSZW51bWJlciBncm91cHMgYW5kIHJlZHVjZSBjYXB0dXJpbmcgZ3JvdXBzIHRvIG5vbi1jYXB0dXJpbmcgZ3JvdXBzCiAgICAgIC8vIHdoZXJlIHBvc3NpYmxlLgogICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNhcHR1cmVkR3JvdXBzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgaWYgKC0xID09PSBjYXB0dXJlZEdyb3Vwc1tpXSkgewogICAgICAgICAgY2FwdHVyZWRHcm91cHNbaV0gPSArK2NhcHR1cmVkR3JvdXBJbmRleDsKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yICh2YXIgaSA9IDAsIGdyb3VwSW5kZXggPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgICAgdmFyIHAgPSBwYXJ0c1tpXTsKICAgICAgICBpZiAocCA9PT0gJygnKSB7CiAgICAgICAgICArK2dyb3VwSW5kZXg7CiAgICAgICAgICBpZiAoY2FwdHVyZWRHcm91cHNbZ3JvdXBJbmRleF0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBwYXJ0c1tpXSA9ICcoPzonOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoJ1xcJyA9PT0gcC5jaGFyQXQoMCkpIHsKICAgICAgICAgIHZhciBkZWNpbWFsVmFsdWUgPSArcC5zdWJzdHJpbmcoMSk7CiAgICAgICAgICBpZiAoZGVjaW1hbFZhbHVlICYmIGRlY2ltYWxWYWx1ZSA8PSBncm91cEluZGV4KSB7CiAgICAgICAgICAgIHBhcnRzW2ldID0gJ1xcJyArIGNhcHR1cmVkR3JvdXBzW2dyb3VwSW5kZXhdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogIAogICAgICAvLyBSZW1vdmUgYW55IHByZWZpeCBhbmNob3JzIHNvIHRoYXQgdGhlIG91dHB1dCB3aWxsIG1hdGNoIGFueXdoZXJlLgogICAgICAvLyBeXiByZWFsbHkgZG9lcyBtZWFuIGFuIGFuY2hvcmVkIG1hdGNoIHRob3VnaC4KICAgICAgZm9yICh2YXIgaSA9IDAsIGdyb3VwSW5kZXggPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgICAgaWYgKCdeJyA9PT0gcGFydHNbaV0gJiYgJ14nICE9PSBwYXJ0c1tpICsgMV0pIHsgcGFydHNbaV0gPSAnJzsgfQogICAgICB9CiAgCiAgICAgIC8vIEV4cGFuZCBsZXR0ZXJzIHRvIGdyb3VwcyB0byBoYW5kbGUgbWl4aW5nIG9mIGNhc2Utc2Vuc2l0aXZlIGFuZAogICAgICAvLyBjYXNlLWluc2Vuc2l0aXZlIHBhdHRlcm5zIGlmIG5lY2Vzc2FyeS4KICAgICAgaWYgKHJlZ2V4Lmlnbm9yZUNhc2UgJiYgbmVlZFRvRm9sZENhc2UpIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47ICsraSkgewogICAgICAgICAgdmFyIHAgPSBwYXJ0c1tpXTsKICAgICAgICAgIHZhciBjaDAgPSBwLmNoYXJBdCgwKTsKICAgICAgICAgIGlmIChwLmxlbmd0aCA+PSAyICYmIGNoMCA9PT0gJ1snKSB7CiAgICAgICAgICAgIHBhcnRzW2ldID0gY2FzZUZvbGRDaGFyc2V0KHApOwogICAgICAgICAgfSBlbHNlIGlmIChjaDAgIT09ICdcXCcpIHsKICAgICAgICAgICAgLy8gVE9ETzogaGFuZGxlIGxldHRlcnMgaW4gbnVtZXJpYyBlc2NhcGVzLgogICAgICAgICAgICBwYXJ0c1tpXSA9IHAucmVwbGFjZSgKICAgICAgICAgICAgICAgIC9bYS16QS1aXS9nLAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKGNoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBjYyA9IGNoLmNoYXJDb2RlQXQoMCk7CiAgICAgICAgICAgICAgICAgIHJldHVybiAnWycgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGNjICYgfjMyLCBjYyB8IDMyKSArICddJzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogIAogICAgICByZXR1cm4gcGFydHMuam9pbignJyk7CiAgICB9CiAgCiAgICB2YXIgcmV3cml0dGVuID0gW107CiAgICBmb3IgKHZhciBpID0gMCwgbiA9IHJlZ2V4cy5sZW5ndGg7IGkgPCBuOyArK2kpIHsKICAgICAgdmFyIHJlZ2V4ID0gcmVnZXhzW2ldOwogICAgICBpZiAocmVnZXguZ2xvYmFsIHx8IHJlZ2V4Lm11bHRpbGluZSkgeyB0aHJvdyBuZXcgRXJyb3IoJycgKyByZWdleCk7IH0KICAgICAgcmV3cml0dGVuLnB1c2goCiAgICAgICAgICAnKD86JyArIGFsbG93QW55d2hlcmVGb2xkQ2FzZUFuZFJlbnVtYmVyR3JvdXBzKHJlZ2V4KSArICcpJyk7CiAgICB9CiAgCiAgICByZXR1cm4gbmV3IFJlZ0V4cChyZXdyaXR0ZW4uam9pbignfCcpLCBpZ25vcmVDYXNlID8gJ2dpJyA6ICdnJyk7CiAgfQoKCiAgLyoqCiAgICogU3BsaXQgbWFya3VwIGludG8gYSBzdHJpbmcgb2Ygc291cmNlIGNvZGUgYW5kIGFuIGFycmF5IG1hcHBpbmcgcmFuZ2VzIGluCiAgICogdGhhdCBzdHJpbmcgdG8gdGhlIHRleHQgbm9kZXMgaW4gd2hpY2ggdGhleSBhcHBlYXIuCiAgICoKICAgKiA8cD4KICAgKiBUaGUgSFRNTCBET00gc3RydWN0dXJlOjwvcD4KICAgKiA8cHJlPgogICAqIChFbGVtZW50ICAgInAiCiAgICogICAoRWxlbWVudCAiYiIKICAgKiAgICAgKFRleHQgICJwcmludCAiKSkgICAgICAgOyAjMQogICAqICAgKFRleHQgICAgIidIZWxsbyAnIikgICAgICA7ICMyCiAgICogICAoRWxlbWVudCAiYnIiKSAgICAgICAgICAgIDsgIzMKICAgKiAgIChUZXh0ICAgICIgICsgJ1dvcmxkJzsiKSkgOyAjNAogICAqIDwvcHJlPgogICAqIDxwPgogICAqIGNvcnJlc3BvbmRzIHRvIHRoZSBIVE1MCiAgICoge0Bjb2RlIDxwPjxiPnByaW50IDwvYj4nSGVsbG8gJzxicj4gICsgJ1dvcmxkJzs8L3A+fS48L3A+CiAgICoKICAgKiA8cD4KICAgKiBJdCB3aWxsIHByb2R1Y2UgdGhlIG91dHB1dDo8L3A+CiAgICogPHByZT4KICAgKiB7CiAgICogICBzb3VyY2U6ICJwcmludCAnSGVsbG8gJ1xuICArICdXb3JsZCc7IiwKICAgKiAgIC8vICAgICAgICAgICAgICAgICAxICAgICAgICAgMgogICAqICAgLy8gICAgICAgMDEyMzQ1Njc4OTAxMjM0IDU2Nzg5MDEyMzQ1NjcKICAgKiAgIHNwYW5zOiBbMCwgIzEsIDYsICMyLCAxNCwgIzMsIDE1LCAjNF0KICAgKiB9CiAgICogPC9wcmU+CiAgICogPHA+CiAgICogd2hlcmUgIzEgaXMgYSByZWZlcmVuY2UgdG8gdGhlIHtAY29kZSAicHJpbnQgIn0gdGV4dCBub2RlIGFib3ZlLCBhbmQgc28KICAgKiBvbiBmb3IgdGhlIG90aGVyIHRleHQgbm9kZXMuCiAgICogPC9wPgogICAqCiAgICogPHA+CiAgICogVGhlIHtAY29kZX0gc3BhbnMgYXJyYXkgaXMgYW4gYXJyYXkgb2YgcGFpcnMuICBFdmVuIGVsZW1lbnRzIGFyZSB0aGUgc3RhcnQKICAgKiBpbmRpY2VzIG9mIHN1YnN0cmluZ3MsIGFuZCBvZGQgZWxlbWVudHMgYXJlIHRoZSB0ZXh0IG5vZGVzIChvciBCUiBlbGVtZW50cykKICAgKiB0aGF0IGNvbnRhaW4gdGhlIHRleHQgZm9yIHRob3NlIHN1YnN0cmluZ3MuCiAgICogU3Vic3RyaW5ncyBjb250aW51ZSB1bnRpbCB0aGUgbmV4dCBpbmRleCBvciB0aGUgZW5kIG9mIHRoZSBzb3VyY2UuCiAgICogPC9wPgogICAqCiAgICogQHBhcmFtIHtOb2RlfSBub2RlIGFuIEhUTUwgRE9NIHN1YnRyZWUgY29udGFpbmluZyBzb3VyY2UtY29kZS4KICAgKiBAcmV0dXJuIHtPYmplY3R9IHNvdXJjZSBjb2RlIGFuZCB0aGUgdGV4dCBub2RlcyBpbiB3aGljaCB0aGV5IG9jY3VyLgogICAqLwogIGZ1bmN0aW9uIGV4dHJhY3RTb3VyY2VTcGFucyhub2RlKSB7CiAgICB2YXIgbm9jb2RlID0gLyg/Ol58XHMpbm9jb2RlKD86XHN8JCkvOwogIAogICAgdmFyIGNodW5rcyA9IFtdOwogICAgdmFyIGxlbmd0aCA9IDA7CiAgICB2YXIgc3BhbnMgPSBbXTsKICAgIHZhciBrID0gMDsKICAKICAgIHZhciB3aGl0ZXNwYWNlOwogICAgaWYgKG5vZGUuY3VycmVudFN0eWxlKSB7CiAgICAgIHdoaXRlc3BhY2UgPSBub2RlLmN1cnJlbnRTdHlsZS53aGl0ZVNwYWNlOwogICAgfSBlbHNlIGlmICh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSkgewogICAgICB3aGl0ZXNwYWNlID0gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBudWxsKQogICAgICAgICAgLmdldFByb3BlcnR5VmFsdWUoJ3doaXRlLXNwYWNlJyk7CiAgICB9CiAgICB2YXIgaXNQcmVmb3JtYXR0ZWQgPSB3aGl0ZXNwYWNlICYmICdwcmUnID09PSB3aGl0ZXNwYWNlLnN1YnN0cmluZygwLCAzKTsKICAKICAgIGZ1bmN0aW9uIHdhbGsobm9kZSkgewogICAgICBzd2l0Y2ggKG5vZGUubm9kZVR5cGUpIHsKICAgICAgICBjYXNlIDE6ICAvLyBFbGVtZW50CiAgICAgICAgICBpZiAobm9jb2RlLnRlc3Qobm9kZS5jbGFzc05hbWUpKSB7IHJldHVybjsgfQogICAgICAgICAgZm9yICh2YXIgY2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7IGNoaWxkOyBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nKSB7CiAgICAgICAgICAgIHdhbGsoY2hpbGQpOwogICAgICAgICAgfQogICAgICAgICAgdmFyIG5vZGVOYW1lID0gbm9kZS5ub2RlTmFtZTsKICAgICAgICAgIGlmICgnQlInID09PSBub2RlTmFtZSB8fCAnTEknID09PSBub2RlTmFtZSkgewogICAgICAgICAgICBjaHVua3Nba10gPSAnXG4nOwogICAgICAgICAgICBzcGFuc1trIDw8IDFdID0gbGVuZ3RoKys7CiAgICAgICAgICAgIHNwYW5zWyhrKysgPDwgMSkgfCAxXSA9IG5vZGU7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDM6IGNhc2UgNDogIC8vIFRleHQKICAgICAgICAgIHZhciB0ZXh0ID0gbm9kZS5ub2RlVmFsdWU7CiAgICAgICAgICBpZiAodGV4dC5sZW5ndGgpIHsKICAgICAgICAgICAgaWYgKCFpc1ByZWZvcm1hdHRlZCkgewogICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1sgXHRcclxuXSsvZywgJyAnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cclxuPy9nLCAnXG4nKTsgIC8vIE5vcm1hbGl6ZSBuZXdsaW5lcy4KICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBUT0RPOiBoYW5kbGUgdGFicyBoZXJlPwogICAgICAgICAgICBjaHVua3Nba10gPSB0ZXh0OwogICAgICAgICAgICBzcGFuc1trIDw8IDFdID0gbGVuZ3RoOwogICAgICAgICAgICBsZW5ndGggKz0gdGV4dC5sZW5ndGg7CiAgICAgICAgICAgIHNwYW5zWyhrKysgPDwgMSkgfCAxXSA9IG5vZGU7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIAogICAgd2Fsayhub2RlKTsKICAKICAgIHJldHVybiB7CiAgICAgIHNvdXJjZTogY2h1bmtzLmpvaW4oJycpLnJlcGxhY2UoL1xuJC8sICcnKSwKICAgICAgc3BhbnM6IHNwYW5zCiAgICB9OwogIH0KCgogIC8qKgogICAqIEFwcGx5IHRoZSBnaXZlbiBsYW5ndWFnZSBoYW5kbGVyIHRvIHNvdXJjZUNvZGUgYW5kIGFkZCB0aGUgcmVzdWx0aW5nCiAgICogZGVjb3JhdGlvbnMgdG8gb3V0LgogICAqIEBwYXJhbSB7bnVtYmVyfSBiYXNlUG9zIHRoZSBpbmRleCBvZiBzb3VyY2VDb2RlIHdpdGhpbiB0aGUgY2h1bmsgb2Ygc291cmNlCiAgICogICAgd2hvc2UgZGVjb3JhdGlvbnMgYXJlIGFscmVhZHkgcHJlc2VudCBvbiBvdXQuCiAgICovCiAgZnVuY3Rpb24gYXBwZW5kRGVjb3JhdGlvbnMoYmFzZVBvcywgc291cmNlQ29kZSwgbGFuZ0hhbmRsZXIsIG91dCkgewogICAgaWYgKCFzb3VyY2VDb2RlKSB7IHJldHVybjsgfQogICAgdmFyIGpvYiA9IHsKICAgICAgc291cmNlOiBzb3VyY2VDb2RlLAogICAgICBiYXNlUG9zOiBiYXNlUG9zCiAgICB9OwogICAgbGFuZ0hhbmRsZXIoam9iKTsKICAgIG91dC5wdXNoLmFwcGx5KG91dCwgam9iLmRlY29yYXRpb25zKTsKICB9CgogIC8qKiBHaXZlbiB0cmlwbGVzIG9mIFtzdHlsZSwgcGF0dGVybiwgY29udGV4dF0gcmV0dXJucyBhIGxleGluZyBmdW5jdGlvbiwKICAgICogVGhlIGxleGluZyBmdW5jdGlvbiBpbnRlcnByZXRzIHRoZSBwYXR0ZXJucyB0byBmaW5kIHRva2VuIGJvdW5kYXJpZXMgYW5kCiAgICAqIHJldHVybnMgYSBkZWNvcmF0aW9uIGxpc3Qgb2YgdGhlIGZvcm0KICAgICogW2luZGV4XzAsIHN0eWxlXzAsIGluZGV4XzEsIHN0eWxlXzEsIC4uLiwgaW5kZXhfbiwgc3R5bGVfbl0KICAgICogd2hlcmUgaW5kZXhfbiBpcyBhbiBpbmRleCBpbnRvIHRoZSBzb3VyY2VDb2RlLCBhbmQgc3R5bGVfbiBpcyBhIHN0eWxlCiAgICAqIGNvbnN0YW50IGxpa2UgUFJfUExBSU4uICBpbmRleF9uLTEgPD0gaW5kZXhfbiwgYW5kIHN0eWxlX24tMSBhcHBsaWVzIHRvCiAgICAqIGFsbCBjaGFyYWN0ZXJzIGluIHNvdXJjZUNvZGVbaW5kZXhfbi0xOmluZGV4X25dLgogICAgKgogICAgKiBUaGUgc3R5bGVQYXR0ZXJucyBpcyBhIGxpc3Qgd2hvc2UgZWxlbWVudHMgaGF2ZSB0aGUgZm9ybQogICAgKiBbc3R5bGUgOiBzdHJpbmcsIHBhdHRlcm4gOiBSZWdFeHAsIERFUFJFQ0FURUQsIHNob3J0Y3V0IDogc3RyaW5nXS4KICAgICoKICAgICogU3R5bGUgaXMgYSBzdHlsZSBjb25zdGFudCBsaWtlIFBSX1BMQUlOLCBvciBjYW4gYmUgYSBzdHJpbmcgb2YgdGhlCiAgICAqIGZvcm0gJ2xhbmctRk9PJywgd2hlcmUgRk9PIGlzIGEgbGFuZ3VhZ2UgZXh0ZW5zaW9uIGRlc2NyaWJpbmcgdGhlCiAgICAqIGxhbmd1YWdlIG9mIHRoZSBwb3J0aW9uIG9mIHRoZSB0b2tlbiBpbiAkMSBhZnRlciBwYXR0ZXJuIGV4ZWN1dGVzLgogICAgKiBFLmcuLCBpZiBzdHlsZSBpcyAnbGFuZy1saXNwJywgYW5kIGdyb3VwIDEgY29udGFpbnMgdGhlIHRleHQKICAgICogJyhoZWxsbyAod29ybGQpKScsIHRoZW4gdGhhdCBwb3J0aW9uIG9mIHRoZSB0b2tlbiB3aWxsIGJlIHBhc3NlZCB0byB0aGUKICAgICogcmVnaXN0ZXJlZCBsaXNwIGhhbmRsZXIgZm9yIGZvcm1hdHRpbmcuCiAgICAqIFRoZSB0ZXh0IGJlZm9yZSBhbmQgYWZ0ZXIgZ3JvdXAgMSB3aWxsIGJlIHJlc3R5bGVkIHVzaW5nIHRoaXMgZGVjb3JhdG9yCiAgICAqIHNvIGRlY29yYXRvcnMgc2hvdWxkIHRha2UgY2FyZSB0aGF0IHRoaXMgZG9lc24ndCByZXN1bHQgaW4gaW5maW5pdGUKICAgICogcmVjdXJzaW9uLiAgRm9yIGV4YW1wbGUsIHRoZSBIVE1MIGxleGVyIHJ1bGUgZm9yIFNDUklQVCBlbGVtZW50cyBsb29rcwogICAgKiBzb21ldGhpbmcgbGlrZSBbJ2xhbmctanMnLCAvPFtzXWNyaXB0PiguKz8pPFwvc2NyaXB0Pi9dLiAgVGhpcyBtYXkgbWF0Y2gKICAgICogJzxzY3JpcHQ+Zm9vKCk8XC9zY3JpcHQ+Jywgd2hpY2ggd291bGQgY2F1c2UgdGhlIGN1cnJlbnQgZGVjb3JhdG9yIHRvCiAgICAqIGJlIGNhbGxlZCB3aXRoICc8c2NyaXB0Picgd2hpY2ggd291bGQgbm90IG1hdGNoIHRoZSBzYW1lIHJ1bGUgc2luY2UKICAgICogZ3JvdXAgMSBtdXN0IG5vdCBiZSBlbXB0eSwgc28gaXQgd291bGQgYmUgaW5zdGVhZCBzdHlsZWQgYXMgUFJfVEFHIGJ5CiAgICAqIHRoZSBnZW5lcmljIHRhZyBydWxlLiAgVGhlIGhhbmRsZXIgcmVnaXN0ZXJlZCBmb3IgdGhlICdqcycgZXh0ZW5zaW9uIHdvdWxkCiAgICAqIHRoZW4gYmUgY2FsbGVkIHdpdGggJ2ZvbygpJywgYW5kIGZpbmFsbHksIHRoZSBjdXJyZW50IGRlY29yYXRvciB3b3VsZAogICAgKiBiZSBjYWxsZWQgd2l0aCAnPFwvc2NyaXB0Picgd2hpY2ggd291bGQgbm90IG1hdGNoIHRoZSBvcmlnaW5hbCBydWxlIGFuZAogICAgKiBzbyB0aGUgZ2VuZXJpYyB0YWcgcnVsZSB3b3VsZCBpZGVudGlmeSBpdCBhcyBhIHRhZy4KICAgICoKICAgICogUGF0dGVybiBtdXN0IG9ubHkgbWF0Y2ggcHJlZml4ZXMsIGFuZCBpZiBpdCBtYXRjaGVzIGEgcHJlZml4LCB0aGVuIHRoYXQKICAgICogbWF0Y2ggaXMgY29uc2lkZXJlZCBhIHRva2VuIHdpdGggdGhlIHNhbWUgc3R5bGUuCiAgICAqCiAgICAqIENvbnRleHQgaXMgYXBwbGllZCB0byB0aGUgbGFzdCBub24td2hpdGVzcGFjZSwgbm9uLWNvbW1lbnQgdG9rZW4KICAgICogcmVjb2duaXplZC4KICAgICoKICAgICogU2hvcnRjdXQgaXMgYW4gb3B0aW9uYWwgc3RyaW5nIG9mIGNoYXJhY3RlcnMsIGFueSBvZiB3aGljaCwgaWYgdGhlIGZpcnN0CiAgICAqIGNoYXJhY3RlciwgZ3VyYW50ZWUgdGhhdCB0aGlzIHBhdHRlcm4gYW5kIG9ubHkgdGhpcyBwYXR0ZXJuIG1hdGNoZXMuCiAgICAqCiAgICAqIEBwYXJhbSB7QXJyYXl9IHNob3J0Y3V0U3R5bGVQYXR0ZXJucyBwYXR0ZXJucyB0aGF0IGFsd2F5cyBzdGFydCB3aXRoCiAgICAqICAgYSBrbm93biBjaGFyYWN0ZXIuICBNdXN0IGhhdmUgYSBzaG9ydGN1dCBzdHJpbmcuCiAgICAqIEBwYXJhbSB7QXJyYXl9IGZhbGx0aHJvdWdoU3R5bGVQYXR0ZXJucyBwYXR0ZXJucyB0aGF0IHdpbGwgYmUgdHJpZWQgaW4KICAgICogICBvcmRlciBpZiB0aGUgc2hvcnRjdXQgb25lcyBmYWlsLiAgTWF5IGhhdmUgc2hvcnRjdXRzLgogICAgKgogICAgKiBAcmV0dXJuIHtmdW5jdGlvbiAoT2JqZWN0KX0gYQogICAgKiAgIGZ1bmN0aW9uIHRoYXQgdGFrZXMgc291cmNlIGNvZGUgYW5kIHJldHVybnMgYSBsaXN0IG9mIGRlY29yYXRpb25zLgogICAgKi8KICBmdW5jdGlvbiBjcmVhdGVTaW1wbGVMZXhlcihzaG9ydGN1dFN0eWxlUGF0dGVybnMsIGZhbGx0aHJvdWdoU3R5bGVQYXR0ZXJucykgewogICAgdmFyIHNob3J0Y3V0cyA9IHt9OwogICAgdmFyIHRva2VuaXplcjsKICAgIChmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBhbGxQYXR0ZXJucyA9IHNob3J0Y3V0U3R5bGVQYXR0ZXJucy5jb25jYXQoZmFsbHRocm91Z2hTdHlsZVBhdHRlcm5zKTsKICAgICAgdmFyIGFsbFJlZ2V4cyA9IFtdOwogICAgICB2YXIgcmVnZXhLZXlzID0ge307CiAgICAgIGZvciAodmFyIGkgPSAwLCBuID0gYWxsUGF0dGVybnMubGVuZ3RoOyBpIDwgbjsgKytpKSB7CiAgICAgICAgdmFyIHBhdHRlcm5QYXJ0cyA9IGFsbFBhdHRlcm5zW2ldOwogICAgICAgIHZhciBzaG9ydGN1dENoYXJzID0gcGF0dGVyblBhcnRzWzNdOwogICAgICAgIGlmIChzaG9ydGN1dENoYXJzKSB7CiAgICAgICAgICBmb3IgKHZhciBjID0gc2hvcnRjdXRDaGFycy5sZW5ndGg7IC0tYyA+PSAwOykgewogICAgICAgICAgICBzaG9ydGN1dHNbc2hvcnRjdXRDaGFycy5jaGFyQXQoYyldID0gcGF0dGVyblBhcnRzOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2YXIgcmVnZXggPSBwYXR0ZXJuUGFydHNbMV07CiAgICAgICAgdmFyIGsgPSAnJyArIHJlZ2V4OwogICAgICAgIGlmICghcmVnZXhLZXlzLmhhc093blByb3BlcnR5KGspKSB7CiAgICAgICAgICBhbGxSZWdleHMucHVzaChyZWdleCk7CiAgICAgICAgICByZWdleEtleXNba10gPSBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgICBhbGxSZWdleHMucHVzaCgvW1wwLVx1ZmZmZl0vKTsKICAgICAgdG9rZW5pemVyID0gY29tYmluZVByZWZpeFBhdHRlcm5zKGFsbFJlZ2V4cyk7CiAgICB9KSgpOwoKICAgIHZhciBuUGF0dGVybnMgPSBmYWxsdGhyb3VnaFN0eWxlUGF0dGVybnMubGVuZ3RoOwogICAgdmFyIG5vdFdzID0gL1xTLzsKCiAgICAvKioKICAgICAqIExleGVzIGpvYi5zb3VyY2UgYW5kIHByb2R1Y2VzIGFuIG91dHB1dCBhcnJheSBqb2IuZGVjb3JhdGlvbnMgb2Ygc3R5bGUKICAgICAqIGNsYXNzZXMgcHJlY2VkZWQgYnkgdGhlIHBvc2l0aW9uIGF0IHdoaWNoIHRoZXkgc3RhcnQgaW4gam9iLnNvdXJjZSBpbgogICAgICogb3JkZXIuCiAgICAgKgogICAgICogQHBhcmFtIHtPYmplY3R9IGpvYiBhbiBvYmplY3QgbGlrZSB7QGNvZGUKICAgICAqICAgIHNvdXJjZToge3N0cmluZ30gc291cmNlVGV4dCBwbGFpbiB0ZXh0LAogICAgICogICAgYmFzZVBvczoge2ludH0gcG9zaXRpb24gb2Ygam9iLnNvdXJjZSBpbiB0aGUgbGFyZ2VyIGNodW5rIG9mCiAgICAgKiAgICAgICAgc291cmNlQ29kZS4KICAgICAqIH0KICAgICAqLwogICAgdmFyIGRlY29yYXRlID0gZnVuY3Rpb24gKGpvYikgewogICAgICB2YXIgc291cmNlQ29kZSA9IGpvYi5zb3VyY2UsIGJhc2VQb3MgPSBqb2IuYmFzZVBvczsKICAgICAgLyoqIEV2ZW4gZW50cmllcyBhcmUgcG9zaXRpb25zIGluIHNvdXJjZSBpbiBhc2NlbmRpbmcgb3JkZXIuICBPZGQgZW50aWVzCiAgICAgICAgKiBhcmUgc3R5bGUgbWFya2VycyAoZS5nLiwgUFJfQ09NTUVOVCkgdGhhdCBydW4gZnJvbSB0aGF0IHBvc2l0aW9uIHVudGlsCiAgICAgICAgKiB0aGUgZW5kLgogICAgICAgICogQHR5cGUge0FycmF5LjxudW1iZXJ8c3RyaW5nPn0KICAgICAgICAqLwogICAgICB2YXIgZGVjb3JhdGlvbnMgPSBbYmFzZVBvcywgUFJfUExBSU5dOwogICAgICB2YXIgcG9zID0gMDsgIC8vIGluZGV4IGludG8gc291cmNlQ29kZQogICAgICB2YXIgdG9rZW5zID0gc291cmNlQ29kZS5tYXRjaCh0b2tlbml6ZXIpIHx8IFtdOwogICAgICB2YXIgc3R5bGVDYWNoZSA9IHt9OwoKICAgICAgZm9yICh2YXIgdGkgPSAwLCBuVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsgdGkgPCBuVG9rZW5zOyArK3RpKSB7CiAgICAgICAgdmFyIHRva2VuID0gdG9rZW5zW3RpXTsKICAgICAgICB2YXIgc3R5bGUgPSBzdHlsZUNhY2hlW3Rva2VuXTsKICAgICAgICB2YXIgbWF0Y2ggPSB2b2lkIDA7CgogICAgICAgIHZhciBpc0VtYmVkZGVkOwogICAgICAgIGlmICh0eXBlb2Ygc3R5bGUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICBpc0VtYmVkZGVkID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBwYXR0ZXJuUGFydHMgPSBzaG9ydGN1dHNbdG9rZW4uY2hhckF0KDApXTsKICAgICAgICAgIGlmIChwYXR0ZXJuUGFydHMpIHsKICAgICAgICAgICAgbWF0Y2ggPSB0b2tlbi5tYXRjaChwYXR0ZXJuUGFydHNbMV0pOwogICAgICAgICAgICBzdHlsZSA9IHBhdHRlcm5QYXJ0c1swXTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgblBhdHRlcm5zOyArK2kpIHsKICAgICAgICAgICAgICBwYXR0ZXJuUGFydHMgPSBmYWxsdGhyb3VnaFN0eWxlUGF0dGVybnNbaV07CiAgICAgICAgICAgICAgbWF0Y2ggPSB0b2tlbi5tYXRjaChwYXR0ZXJuUGFydHNbMV0pOwogICAgICAgICAgICAgIGlmIChtYXRjaCkgewogICAgICAgICAgICAgICAgc3R5bGUgPSBwYXR0ZXJuUGFydHNbMF07CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICghbWF0Y2gpIHsgIC8vIG1ha2Ugc3VyZSB0aGF0IHdlIG1ha2UgcHJvZ3Jlc3MKICAgICAgICAgICAgICBzdHlsZSA9IFBSX1BMQUlOOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaXNFbWJlZGRlZCA9IHN0eWxlLmxlbmd0aCA+PSA1ICYmICdsYW5nLScgPT09IHN0eWxlLnN1YnN0cmluZygwLCA1KTsKICAgICAgICAgIGlmIChpc0VtYmVkZGVkICYmICEobWF0Y2ggJiYgdHlwZW9mIG1hdGNoWzFdID09PSAnc3RyaW5nJykpIHsKICAgICAgICAgICAgaXNFbWJlZGRlZCA9IGZhbHNlOwogICAgICAgICAgICBzdHlsZSA9IFBSX1NPVVJDRTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWlzRW1iZWRkZWQpIHsgc3R5bGVDYWNoZVt0b2tlbl0gPSBzdHlsZTsgfQogICAgICAgIH0KCiAgICAgICAgdmFyIHRva2VuU3RhcnQgPSBwb3M7CiAgICAgICAgcG9zICs9IHRva2VuLmxlbmd0aDsKCiAgICAgICAgaWYgKCFpc0VtYmVkZGVkKSB7CiAgICAgICAgICBkZWNvcmF0aW9ucy5wdXNoKGJhc2VQb3MgKyB0b2tlblN0YXJ0LCBzdHlsZSk7CiAgICAgICAgfSBlbHNlIHsgIC8vIFRyZWF0IGdyb3VwIDEgYXMgYW4gZW1iZWRkZWQgYmxvY2sgb2Ygc291cmNlIGNvZGUuCiAgICAgICAgICB2YXIgZW1iZWRkZWRTb3VyY2UgPSBtYXRjaFsxXTsKICAgICAgICAgIHZhciBlbWJlZGRlZFNvdXJjZVN0YXJ0ID0gdG9rZW4uaW5kZXhPZihlbWJlZGRlZFNvdXJjZSk7CiAgICAgICAgICB2YXIgZW1iZWRkZWRTb3VyY2VFbmQgPSBlbWJlZGRlZFNvdXJjZVN0YXJ0ICsgZW1iZWRkZWRTb3VyY2UubGVuZ3RoOwogICAgICAgICAgaWYgKG1hdGNoWzJdKSB7CiAgICAgICAgICAgIC8vIElmIGVtYmVkZGVkU291cmNlIGNhbiBiZSBibGFuaywgdGhlbiBpdCB3b3VsZCBtYXRjaCBhdCB0aGUKICAgICAgICAgICAgLy8gYmVnaW5uaW5nIHdoaWNoIHdvdWxkIGNhdXNlIHVzIHRvIGluZmluaXRlbHkgcmVjdXJzZSBvbiB0aGUKICAgICAgICAgICAgLy8gZW50aXJlIHRva2VuLCBzbyB3ZSBjYXRjaCB0aGUgcmlnaHQgY29udGV4dCBpbiBtYXRjaFsyXS4KICAgICAgICAgICAgZW1iZWRkZWRTb3VyY2VFbmQgPSB0b2tlbi5sZW5ndGggLSBtYXRjaFsyXS5sZW5ndGg7CiAgICAgICAgICAgIGVtYmVkZGVkU291cmNlU3RhcnQgPSBlbWJlZGRlZFNvdXJjZUVuZCAtIGVtYmVkZGVkU291cmNlLmxlbmd0aDsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBsYW5nID0gc3R5bGUuc3Vic3RyaW5nKDUpOwogICAgICAgICAgLy8gRGVjb3JhdGUgdGhlIGxlZnQgb2YgdGhlIGVtYmVkZGVkIHNvdXJjZQogICAgICAgICAgYXBwZW5kRGVjb3JhdGlvbnMoCiAgICAgICAgICAgICAgYmFzZVBvcyArIHRva2VuU3RhcnQsCiAgICAgICAgICAgICAgdG9rZW4uc3Vic3RyaW5nKDAsIGVtYmVkZGVkU291cmNlU3RhcnQpLAogICAgICAgICAgICAgIGRlY29yYXRlLCBkZWNvcmF0aW9ucyk7CiAgICAgICAgICAvLyBEZWNvcmF0ZSB0aGUgZW1iZWRkZWQgc291cmNlCiAgICAgICAgICBhcHBlbmREZWNvcmF0aW9ucygKICAgICAgICAgICAgICBiYXNlUG9zICsgdG9rZW5TdGFydCArIGVtYmVkZGVkU291cmNlU3RhcnQsCiAgICAgICAgICAgICAgZW1iZWRkZWRTb3VyY2UsCiAgICAgICAgICAgICAgbGFuZ0hhbmRsZXJGb3JFeHRlbnNpb24obGFuZywgZW1iZWRkZWRTb3VyY2UpLAogICAgICAgICAgICAgIGRlY29yYXRpb25zKTsKICAgICAgICAgIC8vIERlY29yYXRlIHRoZSByaWdodCBvZiB0aGUgZW1iZWRkZWQgc2VjdGlvbgogICAgICAgICAgYXBwZW5kRGVjb3JhdGlvbnMoCiAgICAgICAgICAgICAgYmFzZVBvcyArIHRva2VuU3RhcnQgKyBlbWJlZGRlZFNvdXJjZUVuZCwKICAgICAgICAgICAgICB0b2tlbi5zdWJzdHJpbmcoZW1iZWRkZWRTb3VyY2VFbmQpLAogICAgICAgICAgICAgIGRlY29yYXRlLCBkZWNvcmF0aW9ucyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGpvYi5kZWNvcmF0aW9ucyA9IGRlY29yYXRpb25zOwogICAgfTsKICAgIHJldHVybiBkZWNvcmF0ZTsKICB9CgogIC8qKiByZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBwcm9kdWNlcyBhIGxpc3Qgb2YgZGVjb3JhdGlvbnMgZnJvbSBzb3VyY2UgdGV4dC4KICAgICoKICAgICogVGhpcyBjb2RlIHRyZWF0cyAiLCAnLCBhbmQgYCBhcyBzdHJpbmcgZGVsaW1pdGVycywgYW5kIFwgYXMgYSBzdHJpbmcKICAgICogZXNjYXBlLiAgSXQgZG9lcyBub3QgcmVjb2duaXplIHBlcmwncyBxcSgpIHN0eWxlIHN0cmluZ3MuCiAgICAqIEl0IGhhcyBubyBzcGVjaWFsIGhhbmRsaW5nIGZvciBkb3VibGUgZGVsaW1pdGVyIGVzY2FwZXMgYXMgaW4gYmFzaWMsIG9yCiAgICAqIHRoZSB0cmlwbGVkIGRlbGltaXRlcnMgdXNlZCBpbiBweXRob24sIGJ1dCBzaG91bGQgd29yayBvbiB0aG9zZSByZWdhcmRsZXNzCiAgICAqIGFsdGhvdWdoIGluIHRob3NlIGNhc2VzIGEgc2luZ2xlIHN0cmluZyBsaXRlcmFsIG1heSBiZSBicm9rZW4gdXAgaW50bwogICAgKiBtdWx0aXBsZSBhZGphY2VudCBzdHJpbmcgbGl0ZXJhbHMuCiAgICAqCiAgICAqIEl0IHJlY29nbml6ZXMgQywgQysrLCBhbmQgc2hlbGwgc3R5bGUgY29tbWVudHMuCiAgICAqCiAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIGEgc2V0IG9mIG9wdGlvbmFsIHBhcmFtZXRlcnMuCiAgICAqIEByZXR1cm4ge2Z1bmN0aW9uIChPYmplY3QpfSBhIGZ1bmN0aW9uIHRoYXQgZXhhbWluZXMgdGhlIHNvdXJjZSBjb2RlCiAgICAqICAgICBpbiB0aGUgaW5wdXQgam9iIGFuZCBidWlsZHMgdGhlIGRlY29yYXRpb24gbGlzdC4KICAgICovCiAgZnVuY3Rpb24gc291cmNlRGVjb3JhdG9yKG9wdGlvbnMpIHsKICAgIHZhciBzaG9ydGN1dFN0eWxlUGF0dGVybnMgPSBbXSwgZmFsbHRocm91Z2hTdHlsZVBhdHRlcm5zID0gW107CiAgICBpZiAob3B0aW9uc1sndHJpcGxlUXVvdGVkU3RyaW5ncyddKSB7CiAgICAgIC8vICcnJ211bHRpLWxpbmUtc3RyaW5nJycnLCAnc2luZ2xlLWxpbmUtc3RyaW5nJywgYW5kIGRvdWJsZS1xdW90ZWQKICAgICAgc2hvcnRjdXRTdHlsZVBhdHRlcm5zLnB1c2goCiAgICAgICAgICBbUFJfU1RSSU5HLCAgL14oPzpcJ1wnXCcoPzpbXlwnXFxdfFxcW1xzXFNdfFwnezEsMn0oPz1bXlwnXSkpKig/OlwnXCdcJ3wkKXxcIlwiXCIoPzpbXlwiXFxdfFxcW1xzXFNdfFwiezEsMn0oPz1bXlwiXSkpKig/OlwiXCJcInwkKXxcJyg/OlteXFxcJ118XFxbXHNcU10pKig/OlwnfCQpfFwiKD86W15cXFwiXXxcXFtcc1xTXSkqKD86XCJ8JCkpLywKICAgICAgICAgICBudWxsLCAnXCciJ10pOwogICAgfSBlbHNlIGlmIChvcHRpb25zWydtdWx0aUxpbmVTdHJpbmdzJ10pIHsKICAgICAgLy8gJ211bHRpLWxpbmUtc3RyaW5nJywgIm11bHRpLWxpbmUtc3RyaW5nIgogICAgICBzaG9ydGN1dFN0eWxlUGF0dGVybnMucHVzaCgKICAgICAgICAgIFtQUl9TVFJJTkcsICAvXig/OlwnKD86W15cXFwnXXxcXFtcc1xTXSkqKD86XCd8JCl8XCIoPzpbXlxcXCJdfFxcW1xzXFNdKSooPzpcInwkKXxcYCg/OlteXFxcYF18XFxbXHNcU10pKig/OlxgfCQpKS8sCiAgICAgICAgICAgbnVsbCwgJ1wnImAnXSk7CiAgICB9IGVsc2UgewogICAgICAvLyAnc2luZ2xlLWxpbmUtc3RyaW5nJywgInNpbmdsZS1saW5lLXN0cmluZyIKICAgICAgc2hvcnRjdXRTdHlsZVBhdHRlcm5zLnB1c2goCiAgICAgICAgICBbUFJfU1RSSU5HLAogICAgICAgICAgIC9eKD86XCcoPzpbXlxcXCdcclxuXXxcXC4pKig/OlwnfCQpfFwiKD86W15cXFwiXHJcbl18XFwuKSooPzpcInwkKSkvLAogICAgICAgICAgIG51bGwsICciXCcnXSk7CiAgICB9CiAgICBpZiAob3B0aW9uc1sndmVyYmF0aW1TdHJpbmdzJ10pIHsKICAgICAgLy8gdmVyYmF0aW0tc3RyaW5nLWxpdGVyYWwgcHJvZHVjdGlvbiBmcm9tIHRoZSBDIyBncmFtbWFyLiAgU2VlIGlzc3VlIDkzLgogICAgICBmYWxsdGhyb3VnaFN0eWxlUGF0dGVybnMucHVzaCgKICAgICAgICAgIFtQUl9TVFJJTkcsIC9eQFwiKD86W15cIl18XCJcIikqKD86XCJ8JCkvLCBudWxsXSk7CiAgICB9CiAgICB2YXIgaGMgPSBvcHRpb25zWydoYXNoQ29tbWVudHMnXTsKICAgIGlmIChoYykgewogICAgICBpZiAob3B0aW9uc1snY1N0eWxlQ29tbWVudHMnXSkgewogICAgICAgIGlmIChoYyA+IDEpIHsgIC8vIG11bHRpbGluZSBoYXNoIGNvbW1lbnRzCiAgICAgICAgICBzaG9ydGN1dFN0eWxlUGF0dGVybnMucHVzaCgKICAgICAgICAgICAgICBbUFJfQ09NTUVOVCwgL14jKD86IyMoPzpbXiNdfCMoPyEjIykpKig/OiMjI3wkKXwuKikvLCBudWxsLCAnIyddKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gU3RvcCBDIHByZXByb2Nlc3NvciBkZWNsYXJhdGlvbnMgYXQgYW4gdW5jbG9zZWQgb3BlbiBjb21tZW50CiAgICAgICAgICBzaG9ydGN1dFN0eWxlUGF0dGVybnMucHVzaCgKICAgICAgICAgICAgICBbUFJfQ09NTUVOVCwgL14jKD86KD86ZGVmaW5lfGVsaWZ8ZWxzZXxlbmRpZnxlcnJvcnxpZmRlZnxpbmNsdWRlfGlmbmRlZnxsaW5lfHByYWdtYXx1bmRlZnx3YXJuaW5nKVxifFteXHJcbl0qKS8sCiAgICAgICAgICAgICAgIG51bGwsICcjJ10pOwogICAgICAgIH0KICAgICAgICBmYWxsdGhyb3VnaFN0eWxlUGF0dGVybnMucHVzaCgKICAgICAgICAgICAgW1BSX1NUUklORywKICAgICAgICAgICAgIC9ePCg/Oig/Oig/OlwuXC5cLykqfFwvPykoPzpbXHctXSsoPzpcL1tcdy1dKykrKT9bXHctXStcLmh8W2Etel1cdyopPi8sCiAgICAgICAgICAgICBudWxsXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2hvcnRjdXRTdHlsZVBhdHRlcm5zLnB1c2goW1BSX0NPTU1FTlQsIC9eI1teXHJcbl0qLywgbnVsbCwgJyMnXSk7CiAgICAgIH0KICAgIH0KICAgIGlmIChvcHRpb25zWydjU3R5bGVDb21tZW50cyddKSB7CiAgICAgIGZhbGx0aHJvdWdoU3R5bGVQYXR0ZXJucy5wdXNoKFtQUl9DT01NRU5ULCAvXlwvXC9bXlxyXG5dKi8sIG51bGxdKTsKICAgICAgZmFsbHRocm91Z2hTdHlsZVBhdHRlcm5zLnB1c2goCiAgICAgICAgICBbUFJfQ09NTUVOVCwgL15cL1wqW1xzXFNdKj8oPzpcKlwvfCQpLywgbnVsbF0pOwogICAgfQogICAgaWYgKG9wdGlvbnNbJ3JlZ2V4TGl0ZXJhbHMnXSkgewogICAgICB2YXIgUkVHRVhfTElURVJBTCA9ICgKICAgICAgICAgIC8vIEEgcmVndWxhciBleHByZXNzaW9uIGxpdGVyYWwgc3RhcnRzIHdpdGggYSBzbGFzaCB0aGF0IGlzCiAgICAgICAgICAvLyBub3QgZm9sbG93ZWQgYnkgKiBvciAvIHNvIHRoYXQgaXQgaXMgbm90IGNvbmZ1c2VkIHdpdGgKICAgICAgICAgIC8vIGNvbW1lbnRzLgogICAgICAgICAgJy8oPz1bXi8qXSknCiAgICAgICAgICAvLyBhbmQgdGhlbiBjb250YWlucyBhbnkgbnVtYmVyIG9mIHJhdyBjaGFyYWN0ZXJzLAogICAgICAgICAgKyAnKD86W14vXFx4NUJcXHg1Q10nCiAgICAgICAgICAvLyBlc2NhcGUgc2VxdWVuY2VzIChceDVDKSwKICAgICAgICAgICsgICAgJ3xcXHg1Q1tcXHNcXFNdJwogICAgICAgICAgLy8gb3Igbm9uLW5lc3RpbmcgY2hhcmFjdGVyIHNldHMgKFx4NUJceDVEKTsKICAgICAgICAgICsgICAgJ3xcXHg1Qig/OlteXFx4NUNcXHg1RF18XFx4NUNbXFxzXFxTXSkqKD86XFx4NUR8JCkpKycKICAgICAgICAgIC8vIGZpbmFsbHkgY2xvc2VkIGJ5IGEgLy4KICAgICAgICAgICsgJy8nKTsKICAgICAgZmFsbHRocm91Z2hTdHlsZVBhdHRlcm5zLnB1c2goCiAgICAgICAgICBbJ2xhbmctcmVnZXgnLAogICAgICAgICAgIG5ldyBSZWdFeHAoJ14nICsgUkVHRVhQX1BSRUNFREVSX1BBVFRFUk4gKyAnKCcgKyBSRUdFWF9MSVRFUkFMICsgJyknKQogICAgICAgICAgIF0pOwogICAgfQoKICAgIHZhciBrZXl3b3JkcyA9IG9wdGlvbnNbJ2tleXdvcmRzJ10ucmVwbGFjZSgvXlxzK3xccyskL2csICcnKTsKICAgIGlmIChrZXl3b3Jkcy5sZW5ndGgpIHsKICAgICAgZmFsbHRocm91Z2hTdHlsZVBhdHRlcm5zLnB1c2goCiAgICAgICAgICBbUFJfS0VZV09SRCwKICAgICAgICAgICBuZXcgUmVnRXhwKCdeKD86JyArIGtleXdvcmRzLnJlcGxhY2UoL1xzKy9nLCAnfCcpICsgJylcXGInKSwgbnVsbF0pOwogICAgfQoKICAgIHNob3J0Y3V0U3R5bGVQYXR0ZXJucy5wdXNoKFtQUl9QTEFJTiwgICAgICAgL15ccysvLCBudWxsLCAnIFxyXG5cdFx4QTAnXSk7CiAgICBmYWxsdGhyb3VnaFN0eWxlUGF0dGVybnMucHVzaCgKICAgICAgICAvLyBUT0RPKG1pa2VzYW11ZWwpOiByZWNvZ25pemUgbm9uLWxhdGluIGxldHRlcnMgYW5kIG51bWVyYWxzIGluIGlkZW50cwogICAgICAgIFtQUl9MSVRFUkFMLCAgICAgL15AW2Etel8kXVthLXpfJEAwLTldKi9pLCBudWxsXSwKICAgICAgICBbUFJfVFlQRSwgICAgICAgIC9eQD9bQS1aXStbYS16XVtBLVphLXpfJEAwLTldKi8sIG51bGxdLAogICAgICAgIFtQUl9QTEFJTiwgICAgICAgL15bYS16XyRdW2Etel8kQDAtOV0qL2ksIG51bGxdLAogICAgICAgIFtQUl9MSVRFUkFMLAogICAgICAgICBuZXcgUmVnRXhwKAogICAgICAgICAgICAgJ14oPzonCiAgICAgICAgICAgICAvLyBBIGhleCBudW1iZXIKICAgICAgICAgICAgICsgJzB4W2EtZjAtOV0rJwogICAgICAgICAgICAgLy8gb3IgYW4gb2N0YWwgb3IgZGVjaW1hbCBudW1iZXIsCiAgICAgICAgICAgICArICd8KD86XFxkKD86X1xcZCspKlxcZCooPzpcXC5cXGQqKT98XFwuXFxkXFwrKScKICAgICAgICAgICAgIC8vIHBvc3NpYmx5IGluIHNjaWVudGlmaWMgbm90YXRpb24KICAgICAgICAgICAgICsgJyg/OmVbK1xcLV0/XFxkKyk/JwogICAgICAgICAgICAgKyAnKScKICAgICAgICAgICAgIC8vIHdpdGggYW4gb3B0aW9uYWwgbW9kaWZpZXIgbGlrZSBVTCBmb3IgdW5zaWduZWQgbG9uZwogICAgICAgICAgICAgKyAnW2Etel0qJywgJ2knKSwKICAgICAgICAgbnVsbCwgJzAxMjM0NTY3ODknXSwKICAgICAgICAvLyBEb24ndCB0cmVhdCBlc2NhcGVkIHF1b3RlcyBpbiBiYXNoIGFzIHN0YXJ0aW5nIHN0cmluZ3MuICBTZWUgaXNzdWUgMTQ0LgogICAgICAgIFtQUl9QTEFJTiwgICAgICAgL15cXFtcc1xTXT8vLCBudWxsXSwKICAgICAgICBbUFJfUFVOQ1RVQVRJT04sIC9eLlteXHNcd1wuJEBcJ1wiXGBcL1wjXFxdKi8sIG51bGxdKTsKCiAgICByZXR1cm4gY3JlYXRlU2ltcGxlTGV4ZXIoc2hvcnRjdXRTdHlsZVBhdHRlcm5zLCBmYWxsdGhyb3VnaFN0eWxlUGF0dGVybnMpOwogIH0KCiAgdmFyIGRlY29yYXRlU291cmNlID0gc291cmNlRGVjb3JhdG9yKHsKICAgICAgICAna2V5d29yZHMnOiBBTExfS0VZV09SRFMsCiAgICAgICAgJ2hhc2hDb21tZW50cyc6IHRydWUsCiAgICAgICAgJ2NTdHlsZUNvbW1lbnRzJzogdHJ1ZSwKICAgICAgICAnbXVsdGlMaW5lU3RyaW5ncyc6IHRydWUsCiAgICAgICAgJ3JlZ2V4TGl0ZXJhbHMnOiB0cnVlCiAgICAgIH0pOwoKICAvKioKICAgKiBHaXZlbiBhIERPTSBzdWJ0cmVlLCB3cmFwcyBpdCBpbiBhIGxpc3QsIGFuZCBwdXRzIGVhY2ggbGluZSBpbnRvIGl0cyBvd24KICAgKiBsaXN0IGl0ZW0uCiAgICoKICAgKiBAcGFyYW0ge05vZGV9IG5vZGUgbW9kaWZpZWQgaW4gcGxhY2UuICBJdHMgY29udGVudCBpcyBwdWxsZWQgaW50byBhbgogICAqICAgICBIVE1MT0xpc3RFbGVtZW50LCBhbmQgZWFjaCBsaW5lIGlzIG1vdmVkIGludG8gYSBzZXBhcmF0ZSBsaXN0IGl0ZW0uCiAgICogICAgIFRoaXMgcmVxdWlyZXMgY2xvbmluZyBlbGVtZW50cywgc28gdGhlIGlucHV0IG1pZ2h0IG5vdCBoYXZlIHVuaXF1ZQogICAqICAgICBJRHMgYWZ0ZXIgbnVtYmVyaW5nLgogICAqLwogIGZ1bmN0aW9uIG51bWJlckxpbmVzKG5vZGUsIG9wdF9zdGFydExpbmVOdW0pIHsKICAgIHZhciBub2NvZGUgPSAvKD86Xnxccylub2NvZGUoPzpcc3wkKS87CiAgICB2YXIgbGluZUJyZWFrID0gL1xyXG4/fFxuLzsKICAKICAgIHZhciBkb2N1bWVudCA9IG5vZGUub3duZXJEb2N1bWVudDsKICAKICAgIHZhciB3aGl0ZXNwYWNlOwogICAgaWYgKG5vZGUuY3VycmVudFN0eWxlKSB7CiAgICAgIHdoaXRlc3BhY2UgPSBub2RlLmN1cnJlbnRTdHlsZS53aGl0ZVNwYWNlOwogICAgfSBlbHNlIGlmICh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSkgewogICAgICB3aGl0ZXNwYWNlID0gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBudWxsKQogICAgICAgICAgLmdldFByb3BlcnR5VmFsdWUoJ3doaXRlLXNwYWNlJyk7CiAgICB9CiAgICAvLyBJZiBpdCdzIHByZWZvcm1hdHRlZCwgdGhlbiB3ZSBuZWVkIHRvIHNwbGl0IGxpbmVzIG9uIGxpbmUgYnJlYWtzCiAgICAvLyBpbiBhZGRpdGlvbiB0byA8QlI+cy4KICAgIHZhciBpc1ByZWZvcm1hdHRlZCA9IHdoaXRlc3BhY2UgJiYgJ3ByZScgPT09IHdoaXRlc3BhY2Uuc3Vic3RyaW5nKDAsIDMpOwogIAogICAgdmFyIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnTEknKTsKICAgIHdoaWxlIChub2RlLmZpcnN0Q2hpbGQpIHsKICAgICAgbGkuYXBwZW5kQ2hpbGQobm9kZS5maXJzdENoaWxkKTsKICAgIH0KICAgIC8vIEFuIGFycmF5IG9mIGxpbmVzLiAgV2Ugc3BsaXQgYmVsb3csIHNvIHRoaXMgaXMgaW5pdGlhbGl6ZWQgdG8gb25lCiAgICAvLyB1bi1zcGxpdCBsaW5lLgogICAgdmFyIGxpc3RJdGVtcyA9IFtsaV07CiAgCiAgICBmdW5jdGlvbiB3YWxrKG5vZGUpIHsKICAgICAgc3dpdGNoIChub2RlLm5vZGVUeXBlKSB7CiAgICAgICAgY2FzZSAxOiAgLy8gRWxlbWVudAogICAgICAgICAgaWYgKG5vY29kZS50ZXN0KG5vZGUuY2xhc3NOYW1lKSkgeyBicmVhazsgfQogICAgICAgICAgaWYgKCdCUicgPT09IG5vZGUubm9kZU5hbWUpIHsKICAgICAgICAgICAgYnJlYWtBZnRlcihub2RlKTsKICAgICAgICAgICAgLy8gRGlzY2FyZCB0aGUgPEJSPiBzaW5jZSBpdCBpcyBub3cgZmx1c2ggYWdhaW5zdCBhIDwvTEk+LgogICAgICAgICAgICBpZiAobm9kZS5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKHZhciBjaGlsZCA9IG5vZGUuZmlyc3RDaGlsZDsgY2hpbGQ7IGNoaWxkID0gY2hpbGQubmV4dFNpYmxpbmcpIHsKICAgICAgICAgICAgICB3YWxrKGNoaWxkKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzOiBjYXNlIDQ6ICAvLyBUZXh0CiAgICAgICAgICBpZiAoaXNQcmVmb3JtYXR0ZWQpIHsKICAgICAgICAgICAgdmFyIHRleHQgPSBub2RlLm5vZGVWYWx1ZTsKICAgICAgICAgICAgdmFyIG1hdGNoID0gdGV4dC5tYXRjaChsaW5lQnJlYWspOwogICAgICAgICAgICBpZiAobWF0Y2gpIHsKICAgICAgICAgICAgICB2YXIgZmlyc3RMaW5lID0gdGV4dC5zdWJzdHJpbmcoMCwgbWF0Y2guaW5kZXgpOwogICAgICAgICAgICAgIG5vZGUubm9kZVZhbHVlID0gZmlyc3RMaW5lOwogICAgICAgICAgICAgIHZhciB0YWlsID0gdGV4dC5zdWJzdHJpbmcobWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgpOwogICAgICAgICAgICAgIGlmICh0YWlsKSB7CiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZSgKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0YWlsKSwgbm9kZS5uZXh0U2libGluZyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGJyZWFrQWZ0ZXIobm9kZSk7CiAgICAgICAgICAgICAgaWYgKCFmaXJzdExpbmUpIHsKICAgICAgICAgICAgICAgIC8vIERvbid0IGxlYXZlIGJsYW5rIHRleHQgbm9kZXMgaW4gdGhlIERPTS4KICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgCiAgICAvLyBTcGxpdCBhIGxpbmUgYWZ0ZXIgdGhlIGdpdmVuIG5vZGUuCiAgICBmdW5jdGlvbiBicmVha0FmdGVyKGxpbmVFbmROb2RlKSB7CiAgICAgIC8vIElmIHRoZXJlJ3Mgbm90aGluZyB0byB0aGUgcmlnaHQsIHRoZW4gd2UgY2FuIHNraXAgZW5kaW5nIHRoZSBsaW5lCiAgICAgIC8vIGhlcmUsIGFuZCBtb3ZlIHJvb3Qtd2FyZHMgc2luY2Ugc3BsaXR0aW5nIGp1c3QgYmVmb3JlIGFuIGVuZC10YWcKICAgICAgLy8gd291bGQgcmVxdWlyZSB1cyB0byBjcmVhdGUgYSBidW5jaCBvZiBlbXB0eSBjb3BpZXMuCiAgICAgIHdoaWxlICghbGluZUVuZE5vZGUubmV4dFNpYmxpbmcpIHsKICAgICAgICBsaW5lRW5kTm9kZSA9IGxpbmVFbmROb2RlLnBhcmVudE5vZGU7CiAgICAgICAgaWYgKCFsaW5lRW5kTm9kZSkgeyByZXR1cm47IH0KICAgICAgfQogIAogICAgICBmdW5jdGlvbiBicmVha0xlZnRPZihsaW1pdCwgY29weSkgewogICAgICAgIC8vIENsb25lIHNoYWxsb3dseSBpZiB0aGlzIG5vZGUgbmVlZHMgdG8gYmUgb24gYm90aCBzaWRlcyBvZiB0aGUgYnJlYWsuCiAgICAgICAgdmFyIHJpZ2h0U2lkZSA9IGNvcHkgPyBsaW1pdC5jbG9uZU5vZGUoZmFsc2UpIDogbGltaXQ7CiAgICAgICAgdmFyIHBhcmVudCA9IGxpbWl0LnBhcmVudE5vZGU7CiAgICAgICAgaWYgKHBhcmVudCkgewogICAgICAgICAgLy8gV2UgY2xvbmUgdGhlIHBhcmVudCBjaGFpbi4KICAgICAgICAgIC8vIFRoaXMgaGVscHMgdXMgcmVzdXJyZWN0IGltcG9ydGFudCBzdHlsaW5nIGVsZW1lbnRzIHRoYXQgY3Jvc3MgbGluZXMuCiAgICAgICAgICAvLyBFLmcuIGluIDxpPkZvbzxicj5CYXI8L2k+CiAgICAgICAgICAvLyBzaG91bGQgYmUgcmV3cml0dGVuIHRvIDxsaT48aT5Gb288L2k+PC9saT48bGk+PGk+QmFyPC9pPjwvbGk+LgogICAgICAgICAgdmFyIHBhcmVudENsb25lID0gYnJlYWtMZWZ0T2YocGFyZW50LCAxKTsKICAgICAgICAgIC8vIE1vdmUgdGhlIGNsb25lIGFuZCBldmVyeXRoaW5nIHRvIHRoZSByaWdodCBvZiB0aGUgb3JpZ2luYWwKICAgICAgICAgIC8vIG9udG8gdGhlIGNsb25lZCBwYXJlbnQuCiAgICAgICAgICB2YXIgbmV4dCA9IGxpbWl0Lm5leHRTaWJsaW5nOwogICAgICAgICAgcGFyZW50Q2xvbmUuYXBwZW5kQ2hpbGQocmlnaHRTaWRlKTsKICAgICAgICAgIGZvciAodmFyIHNpYmxpbmcgPSBuZXh0OyBzaWJsaW5nOyBzaWJsaW5nID0gbmV4dCkgewogICAgICAgICAgICBuZXh0ID0gc2libGluZy5uZXh0U2libGluZzsKICAgICAgICAgICAgcGFyZW50Q2xvbmUuYXBwZW5kQ2hpbGQoc2libGluZyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiByaWdodFNpZGU7CiAgICAgIH0KICAKICAgICAgdmFyIGNvcGllZExpc3RJdGVtID0gYnJlYWtMZWZ0T2YobGluZUVuZE5vZGUubmV4dFNpYmxpbmcsIDApOwogIAogICAgICAvLyBXYWxrIHRoZSBwYXJlbnQgY2hhaW4gdW50aWwgd2UgcmVhY2ggYW4gdW5hdHRhY2hlZCBMSS4KICAgICAgZm9yICh2YXIgcGFyZW50OwogICAgICAgICAgIC8vIENoZWNrIG5vZGVUeXBlIHNpbmNlIElFIGludmVudHMgZG9jdW1lbnQgZnJhZ21lbnRzLgogICAgICAgICAgIChwYXJlbnQgPSBjb3BpZWRMaXN0SXRlbS5wYXJlbnROb2RlKSAmJiBwYXJlbnQubm9kZVR5cGUgPT09IDE7KSB7CiAgICAgICAgY29waWVkTGlzdEl0ZW0gPSBwYXJlbnQ7CiAgICAgIH0KICAgICAgLy8gUHV0IGl0IG9uIHRoZSBsaXN0IG9mIGxpbmVzIGZvciBsYXRlciBwcm9jZXNzaW5nLgogICAgICBsaXN0SXRlbXMucHVzaChjb3BpZWRMaXN0SXRlbSk7CiAgICB9CiAgCiAgICAvLyBTcGxpdCBsaW5lcyB3aGlsZSB0aGVyZSBhcmUgbGluZXMgbGVmdCB0byBzcGxpdC4KICAgIGZvciAodmFyIGkgPSAwOyAgLy8gTnVtYmVyIG9mIGxpbmVzIHRoYXQgaGF2ZSBiZWVuIHNwbGl0IHNvIGZhci4KICAgICAgICAgaSA8IGxpc3RJdGVtcy5sZW5ndGg7ICAvLyBsZW5ndGggdXBkYXRlZCBieSBicmVha0FmdGVyIGNhbGxzLgogICAgICAgICArK2kpIHsKICAgICAgd2FsayhsaXN0SXRlbXNbaV0pOwogICAgfQogIAogICAgLy8gTWFrZSBzdXJlIG51bWVyaWMgaW5kaWNlcyBzaG93IGNvcnJlY3RseS4KICAgIGlmIChvcHRfc3RhcnRMaW5lTnVtID09PSAob3B0X3N0YXJ0TGluZU51bXwwKSkgewogICAgICBsaXN0SXRlbXNbMF0uc2V0QXR0cmlidXRlKCd2YWx1ZScsIG9wdF9zdGFydExpbmVOdW0pOwogICAgfQogIAogICAgdmFyIG9sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnT0wnKTsKICAgIG9sLmNsYXNzTmFtZSA9ICdsaW5lbnVtcyc7CiAgICB2YXIgb2Zmc2V0ID0gTWF0aC5tYXgoMCwgKChvcHRfc3RhcnRMaW5lTnVtIC0gMSAvKiB6ZXJvIGluZGV4ICovKSkgfCAwKSB8fCAwOwogICAgZm9yICh2YXIgaSA9IDAsIG4gPSBsaXN0SXRlbXMubGVuZ3RoOyBpIDwgbjsgKytpKSB7CiAgICAgIGxpID0gbGlzdEl0ZW1zW2ldOwogICAgICAvLyBTdGljayBhIGNsYXNzIG9uIHRoZSBMSXMgc28gdGhhdCBzdHlsZXNoZWV0cyBjYW4KICAgICAgLy8gY29sb3Igb2RkL2V2ZW4gcm93cywgb3IgYW55IG90aGVyIHJvdyBwYXR0ZXJuIHRoYXQKICAgICAgLy8gaXMgY28tcHJpbWUgd2l0aCAxMC4KICAgICAgbGkuY2xhc3NOYW1lID0gJ0wnICsgKChpICsgb2Zmc2V0KSAlIDEwKTsKICAgICAgaWYgKCFsaS5maXJzdENoaWxkKSB7CiAgICAgICAgbGkuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ1x4QTAnKSk7CiAgICAgIH0KICAgICAgb2wuYXBwZW5kQ2hpbGQobGkpOwogICAgfQogIAogICAgbm9kZS5hcHBlbmRDaGlsZChvbCk7CiAgfQoKICAvKioKICAgKiBCcmVha3Mge0Bjb2RlIGpvYi5zb3VyY2V9IGFyb3VuZCBzdHlsZSBib3VuZGFyaWVzIGluIHtAY29kZSBqb2IuZGVjb3JhdGlvbnN9CiAgICogYW5kIG1vZGlmaWVzIHtAY29kZSBqb2Iuc291cmNlTm9kZX0gaW4gcGxhY2UuCiAgICogQHBhcmFtIHtPYmplY3R9IGpvYiBsaWtlIDxwcmU+ewogICAqICAgIHNvdXJjZToge3N0cmluZ30gc291cmNlIGFzIHBsYWluIHRleHQsCiAgICogICAgc3BhbnM6IHtBcnJheS48bnVtYmVyfE5vZGU+fSBhbHRlcm5hdGluZyBzcGFuIHN0YXJ0IGluZGljZXMgaW50byBzb3VyY2UKICAgKiAgICAgICBhbmQgdGhlIHRleHQgbm9kZSBvciBlbGVtZW50IChlLmcuIHtAY29kZSA8QlI+fSkgY29ycmVzcG9uZGluZyB0byB0aGF0CiAgICogICAgICAgc3Bhbi4KICAgKiAgICBkZWNvcmF0aW9uczoge0FycmF5LjxudW1iZXJ8c3RyaW5nfSBhbiBhcnJheSBvZiBzdHlsZSBjbGFzc2VzIHByZWNlZGVkCiAgICogICAgICAgYnkgdGhlIHBvc2l0aW9uIGF0IHdoaWNoIHRoZXkgc3RhcnQgaW4gam9iLnNvdXJjZSBpbiBvcmRlcgogICAqIH08L3ByZT4KICAgKiBAcHJpdmF0ZQogICAqLwogIGZ1bmN0aW9uIHJlY29tYmluZVRhZ3NBbmREZWNvcmF0aW9ucyhqb2IpIHsKICAgIHZhciBpc0lFID0gL1xiTVNJRVxiLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgdmFyIG5ld2xpbmVSZSA9IC9cbi9nOwogIAogICAgdmFyIHNvdXJjZSA9IGpvYi5zb3VyY2U7CiAgICB2YXIgc291cmNlTGVuZ3RoID0gc291cmNlLmxlbmd0aDsKICAgIC8vIEluZGV4IGludG8gc291cmNlIGFmdGVyIHRoZSBsYXN0IGNvZGUtdW5pdCByZWNvbWJpbmVkLgogICAgdmFyIHNvdXJjZUluZGV4ID0gMDsKICAKICAgIHZhciBzcGFucyA9IGpvYi5zcGFuczsKICAgIHZhciBuU3BhbnMgPSBzcGFucy5sZW5ndGg7CiAgICAvLyBJbmRleCBpbnRvIHNwYW5zIGFmdGVyIHRoZSBsYXN0IHNwYW4gd2hpY2ggZW5kcyBhdCBvciBiZWZvcmUgc291cmNlSW5kZXguCiAgICB2YXIgc3BhbkluZGV4ID0gMDsKICAKICAgIHZhciBkZWNvcmF0aW9ucyA9IGpvYi5kZWNvcmF0aW9uczsKICAgIHZhciBuRGVjb3JhdGlvbnMgPSBkZWNvcmF0aW9ucy5sZW5ndGg7CiAgICAvLyBJbmRleCBpbnRvIGRlY29yYXRpb25zIGFmdGVyIHRoZSBsYXN0IGRlY29yYXRpb24gd2hpY2ggZW5kcyBhdCBvciBiZWZvcmUgc291cmNlSW5kZXguCiAgICB2YXIgZGVjb3JhdGlvbkluZGV4ID0gMDsKICAKICAgIC8vIFNpbXBsaWZ5IGRlY29yYXRpb25zLgogICAgdmFyIGRlY1BvcyA9IDA7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5EZWNvcmF0aW9uczspIHsKICAgICAgLy8gU2tpcCBvdmVyIGFueSB6ZXJvLWxlbmd0aCBkZWNvcmF0aW9ucy4KICAgICAgdmFyIHN0YXJ0UG9zID0gZGVjb3JhdGlvbnNbaV07CiAgICAgIHZhciBzdGFydCA9IGk7CiAgICAgIHdoaWxlIChzdGFydCArIDIgPCBuRGVjb3JhdGlvbnMgJiYgZGVjb3JhdGlvbnNbc3RhcnQgKyAyXSA9PT0gc3RhcnRQb3MpIHsKICAgICAgICBzdGFydCArPSAyOwogICAgICB9CiAgICAgIC8vIENvbmZsYXRlIGFsbCBhZGphY2VudCBkZWNvcmF0aW9ucyB0aGF0IHVzZSB0aGUgc2FtZSBzdHlsZS4KICAgICAgdmFyIHN0YXJ0RGVjID0gZGVjb3JhdGlvbnNbc3RhcnQgKyAxXTsKICAgICAgdmFyIGVuZCA9IHN0YXJ0ICsgMjsKICAgICAgd2hpbGUgKGVuZCArIDIgPD0gbkRlY29yYXRpb25zCiAgICAgICAgICAgICAmJiAoZGVjb3JhdGlvbnNbZW5kICsgMV0gPT09IHN0YXJ0RGVjCiAgICAgICAgICAgICAgICAgfHwgZGVjb3JhdGlvbnNbZW5kXSA9PT0gZGVjb3JhdGlvbnNbZW5kICsgMl0pKSB7CiAgICAgICAgZW5kICs9IDI7CiAgICAgIH0KICAgICAgZGVjb3JhdGlvbnNbZGVjUG9zKytdID0gc3RhcnRQb3M7CiAgICAgIGRlY29yYXRpb25zW2RlY1BvcysrXSA9IHN0YXJ0RGVjOwogICAgICBpID0gZW5kOwogICAgfQogIAogICAgLy8gU3RyaXAgYW55IHplcm8tbGVuZ3RoIGRlY29yYXRpb24gYXQgdGhlIGVuZC4KICAgIGlmIChkZWNQb3MgJiYgZGVjb3JhdGlvbnNbZGVjUG9zIC0gMl0gPT09IHNvdXJjZUxlbmd0aCkgeyBkZWNQb3MgLT0gMjsgfQogICAgbkRlY29yYXRpb25zID0gZGVjb3JhdGlvbnMubGVuZ3RoID0gZGVjUG9zOwogIAogICAgdmFyIGRlY29yYXRpb24gPSBudWxsOwogICAgd2hpbGUgKHNwYW5JbmRleCA8IG5TcGFucykgewogICAgICB2YXIgc3BhblN0YXJ0ID0gc3BhbnNbc3BhbkluZGV4XTsKICAgICAgdmFyIHNwYW5FbmQgPSBzcGFuc1tzcGFuSW5kZXggKyAyXSB8fCBzb3VyY2VMZW5ndGg7CiAgCiAgICAgIHZhciBkZWNTdGFydCA9IGRlY29yYXRpb25zW2RlY29yYXRpb25JbmRleF07CiAgICAgIHZhciBkZWNFbmQgPSBkZWNvcmF0aW9uc1tkZWNvcmF0aW9uSW5kZXggKyAyXSB8fCBzb3VyY2VMZW5ndGg7CiAgCiAgICAgIHZhciBlbmQgPSBNYXRoLm1pbihzcGFuRW5kLCBkZWNFbmQpOwogIAogICAgICB2YXIgdGV4dE5vZGUgPSBzcGFuc1tzcGFuSW5kZXggKyAxXTsKICAgICAgaWYgKHRleHROb2RlLm5vZGVUeXBlICE9PSAxKSB7ICAvLyBEb24ndCBtdWNrIHdpdGggPEJSPnMgb3IgPExJPnMKICAgICAgICB2YXIgc3R5bGVkVGV4dCA9IHNvdXJjZS5zdWJzdHJpbmcoc291cmNlSW5kZXgsIGVuZCk7CiAgICAgICAgLy8gVGhpcyBtYXkgc2VlbSBiaXphcnJlLCBhbmQgaXQgaXMuICBFbWl0dGluZyBMRiBvbiBJRSBjYXVzZXMgdGhlCiAgICAgICAgLy8gY29kZSB0byBkaXNwbGF5IHdpdGggc3BhY2VzIGluc3RlYWQgb2YgbGluZSBicmVha3MuCiAgICAgICAgLy8gRW1pdHRpbmcgV2luZG93cyBzdGFuZGFyZCBpc3N1ZSBsaW5lYnJlYWtzIChDUkxGKSBjYXVzZXMgYSBibGFuawogICAgICAgIC8vIHNwYWNlIHRvIGFwcGVhciBhdCB0aGUgYmVnaW5uaW5nIG9mIGV2ZXJ5IGxpbmUgYnV0IHRoZSBmaXJzdC4KICAgICAgICAvLyBFbWl0dGluZyBhbiBvbGQgTWFjIE9TIDkgbGluZSBzZXBhcmF0b3IgbWFrZXMgZXZlcnl0aGluZyBzcGlmZnkuCiAgICAgICAgaWYgKGlzSUUpIHsgc3R5bGVkVGV4dCA9IHN0eWxlZFRleHQucmVwbGFjZShuZXdsaW5lUmUsICdccicpOyB9CiAgICAgICAgdGV4dE5vZGUubm9kZVZhbHVlID0gc3R5bGVkVGV4dDsKICAgICAgICB2YXIgZG9jdW1lbnQgPSB0ZXh0Tm9kZS5vd25lckRvY3VtZW50OwogICAgICAgIHZhciBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnU1BBTicpOwogICAgICAgIHNwYW4uY2xhc3NOYW1lID0gZGVjb3JhdGlvbnNbZGVjb3JhdGlvbkluZGV4ICsgMV07CiAgICAgICAgdmFyIHBhcmVudE5vZGUgPSB0ZXh0Tm9kZS5wYXJlbnROb2RlOwogICAgICAgIHBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHNwYW4sIHRleHROb2RlKTsKICAgICAgICBzcGFuLmFwcGVuZENoaWxkKHRleHROb2RlKTsKICAgICAgICBpZiAoc291cmNlSW5kZXggPCBzcGFuRW5kKSB7ICAvLyBTcGxpdCBvZmYgYSB0ZXh0IG5vZGUuCiAgICAgICAgICBzcGFuc1tzcGFuSW5kZXggKyAxXSA9IHRleHROb2RlCiAgICAgICAgICAgICAgLy8gVE9ETzogUG9zc2libHkgb3B0aW1pemUgYnkgdXNpbmcgJycgaWYgdGhlcmUncyBubyBmbGlja2VyLgogICAgICAgICAgICAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoc291cmNlLnN1YnN0cmluZyhlbmQsIHNwYW5FbmQpKTsKICAgICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRleHROb2RlLCBzcGFuLm5leHRTaWJsaW5nKTsKICAgICAgICB9CiAgICAgIH0KICAKICAgICAgc291cmNlSW5kZXggPSBlbmQ7CiAgCiAgICAgIGlmIChzb3VyY2VJbmRleCA+PSBzcGFuRW5kKSB7CiAgICAgICAgc3BhbkluZGV4ICs9IDI7CiAgICAgIH0KICAgICAgaWYgKHNvdXJjZUluZGV4ID49IGRlY0VuZCkgewogICAgICAgIGRlY29yYXRpb25JbmRleCArPSAyOwogICAgICB9CiAgICB9CiAgfQoKCiAgLyoqIE1hcHMgbGFuZ3VhZ2Utc3BlY2lmaWMgZmlsZSBleHRlbnNpb25zIHRvIGhhbmRsZXJzLiAqLwogIHZhciBsYW5nSGFuZGxlclJlZ2lzdHJ5ID0ge307CiAgLyoqIFJlZ2lzdGVyIGEgbGFuZ3VhZ2UgaGFuZGxlciBmb3IgdGhlIGdpdmVuIGZpbGUgZXh0ZW5zaW9ucy4KICAgICogQHBhcmFtIHtmdW5jdGlvbiAoT2JqZWN0KX0gaGFuZGxlciBhIGZ1bmN0aW9uIGZyb20gc291cmNlIGNvZGUgdG8gYSBsaXN0CiAgICAqICAgICAgb2YgZGVjb3JhdGlvbnMuICBUYWtlcyBhIHNpbmdsZSBhcmd1bWVudCBqb2Igd2hpY2ggZGVzY3JpYmVzIHRoZQogICAgKiAgICAgIHN0YXRlIG9mIHRoZSBjb21wdXRhdGlvbi4gICBUaGUgc2luZ2xlIHBhcmFtZXRlciBoYXMgdGhlIGZvcm0KICAgICogICAgICB7QGNvZGUgewogICAgKiAgICAgICAgc291cmNlOiB7c3RyaW5nfSBhcyBwbGFpbiB0ZXh0LgogICAgKiAgICAgICAgZGVjb3JhdGlvbnM6IHtBcnJheS48bnVtYmVyfHN0cmluZz59IGFuIGFycmF5IG9mIHN0eWxlIGNsYXNzZXMKICAgICogICAgICAgICAgICAgICAgICAgICBwcmVjZWRlZCBieSB0aGUgcG9zaXRpb24gYXQgd2hpY2ggdGhleSBzdGFydCBpbgogICAgKiAgICAgICAgICAgICAgICAgICAgIGpvYi5zb3VyY2UgaW4gb3JkZXIuCiAgICAqICAgICAgICAgICAgICAgICAgICAgVGhlIGxhbmd1YWdlIGhhbmRsZXIgc2hvdWxkIGFzc2lnbmVkIHRoaXMgZmllbGQuCiAgICAqICAgICAgICBiYXNlUG9zOiB7aW50fSB0aGUgcG9zaXRpb24gb2Ygc291cmNlIGluIHRoZSBsYXJnZXIgc291cmNlIGNodW5rLgogICAgKiAgICAgICAgICAgICAgICAgQWxsIHBvc2l0aW9ucyBpbiB0aGUgb3V0cHV0IGRlY29yYXRpb25zIGFycmF5IGFyZSByZWxhdGl2ZQogICAgKiAgICAgICAgICAgICAgICAgdG8gdGhlIGxhcmdlciBzb3VyY2UgY2h1bmsuCiAgICAqICAgICAgfSB9CiAgICAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IGZpbGVFeHRlbnNpb25zCiAgICAqLwogIGZ1bmN0aW9uIHJlZ2lzdGVyTGFuZ0hhbmRsZXIoaGFuZGxlciwgZmlsZUV4dGVuc2lvbnMpIHsKICAgIGZvciAodmFyIGkgPSBmaWxlRXh0ZW5zaW9ucy5sZW5ndGg7IC0taSA+PSAwOykgewogICAgICB2YXIgZXh0ID0gZmlsZUV4dGVuc2lvbnNbaV07CiAgICAgIGlmICghbGFuZ0hhbmRsZXJSZWdpc3RyeS5oYXNPd25Qcm9wZXJ0eShleHQpKSB7CiAgICAgICAgbGFuZ0hhbmRsZXJSZWdpc3RyeVtleHRdID0gaGFuZGxlcjsKICAgICAgfSBlbHNlIGlmICgnY29uc29sZScgaW4gd2luZG93KSB7CiAgICAgICAgY29uc29sZVsnd2FybiddKCdjYW5ub3Qgb3ZlcnJpZGUgbGFuZ3VhZ2UgaGFuZGxlciAlcycsIGV4dCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbGFuZ0hhbmRsZXJGb3JFeHRlbnNpb24oZXh0ZW5zaW9uLCBzb3VyY2UpIHsKICAgIGlmICghKGV4dGVuc2lvbiAmJiBsYW5nSGFuZGxlclJlZ2lzdHJ5Lmhhc093blByb3BlcnR5KGV4dGVuc2lvbikpKSB7CiAgICAgIC8vIFRyZWF0IGl0IGFzIG1hcmt1cCBpZiB0aGUgZmlyc3Qgbm9uIHdoaXRlc3BhY2UgY2hhcmFjdGVyIGlzIGEgPCBhbmQKICAgICAgLy8gdGhlIGxhc3Qgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVyIGlzIGEgPi4KICAgICAgZXh0ZW5zaW9uID0gL15ccyo8Ly50ZXN0KHNvdXJjZSkKICAgICAgICAgID8gJ2RlZmF1bHQtbWFya3VwJwogICAgICAgICAgOiAnZGVmYXVsdC1jb2RlJzsKICAgIH0KICAgIHJldHVybiBsYW5nSGFuZGxlclJlZ2lzdHJ5W2V4dGVuc2lvbl07CiAgfQogIHJlZ2lzdGVyTGFuZ0hhbmRsZXIoZGVjb3JhdGVTb3VyY2UsIFsnZGVmYXVsdC1jb2RlJ10pOwogIHJlZ2lzdGVyTGFuZ0hhbmRsZXIoCiAgICAgIGNyZWF0ZVNpbXBsZUxleGVyKAogICAgICAgICAgW10sCiAgICAgICAgICBbCiAgICAgICAgICAgW1BSX1BMQUlOLCAgICAgICAvXltePD9dKy9dLAogICAgICAgICAgIFtQUl9ERUNMQVJBVElPTiwgL148IVx3W14+XSooPzo+fCQpL10sCiAgICAgICAgICAgW1BSX0NPTU1FTlQsICAgICAvXjxcIS0tW1xzXFNdKj8oPzotXC0+fCQpL10sCiAgICAgICAgICAgLy8gVW5lc2NhcGVkIGNvbnRlbnQgaW4gYW4gdW5rbm93biBsYW5ndWFnZQogICAgICAgICAgIFsnbGFuZy0nLCAgICAgICAgL148XD8oW1xzXFNdKz8pKD86XD8+fCQpL10sCiAgICAgICAgICAgWydsYW5nLScsICAgICAgICAvXjwlKFtcc1xTXSs/KSg/OiU+fCQpL10sCiAgICAgICAgICAgW1BSX1BVTkNUVUFUSU9OLCAvXig/OjxbJT9dfFslP10+KS9dLAogICAgICAgICAgIFsnbGFuZy0nLCAgICAgICAgL148eG1wXGJbXj5dKj4oW1xzXFNdKz8pPFwveG1wXGJbXj5dKj4vaV0sCiAgICAgICAgICAgLy8gVW5lc2NhcGVkIGNvbnRlbnQgaW4gamF2YXNjcmlwdC4gIChPciBwb3NzaWJseSB2YnNjcmlwdCkuCiAgICAgICAgICAgWydsYW5nLWpzJywgICAgICAvXjxzY3JpcHRcYltePl0qPihbXHNcU10qPykoPFwvc2NyaXB0XGJbXj5dKj4pL2ldLAogICAgICAgICAgIC8vIENvbnRhaW5zIHVuZXNjYXBlZCBzdHlsZXNoZWV0IGNvbnRlbnQKICAgICAgICAgICBbJ2xhbmctY3NzJywgICAgIC9ePHN0eWxlXGJbXj5dKj4oW1xzXFNdKj8pKDxcL3N0eWxlXGJbXj5dKj4pL2ldLAogICAgICAgICAgIFsnbGFuZy1pbi50YWcnLCAgL14oPFwvP1thLXpdW148Pl0qPikvaV0KICAgICAgICAgIF0pLAogICAgICBbJ2RlZmF1bHQtbWFya3VwJywgJ2h0bScsICdodG1sJywgJ214bWwnLCAneGh0bWwnLCAneG1sJywgJ3hzbCddKTsKICByZWdpc3RlckxhbmdIYW5kbGVyKAogICAgICBjcmVhdGVTaW1wbGVMZXhlcigKICAgICAgICAgIFsKICAgICAgICAgICBbUFJfUExBSU4sICAgICAgICAvXltcc10rLywgbnVsbCwgJyBcdFxyXG4nXSwKICAgICAgICAgICBbUFJfQVRUUklCX1ZBTFVFLCAvXig/OlwiW15cIl0qXCI/fFwnW15cJ10qXCc/KS8sIG51bGwsICdcIlwnJ10KICAgICAgICAgICBdLAogICAgICAgICAgWwogICAgICAgICAgIFtQUl9UQUcsICAgICAgICAgIC9eXjxcLz9bYS16XSg/Oltcdy46LV0qXHcpP3xcLz8+JC9pXSwKICAgICAgICAgICBbUFJfQVRUUklCX05BTUUsICAvXig/IXN0eWxlW1xzPV18b24pW2Etel0oPzpbXHc6LV0qXHcpPy9pXSwKICAgICAgICAgICBbJ2xhbmctdXEudmFsJywgICAvXj1ccyooW14+XCdcIlxzXSooPzpbXj5cJ1wiXHNcL118XC8oPz1ccykpKS9dLAogICAgICAgICAgIFtQUl9QVU5DVFVBVElPTiwgIC9eWz08PlwvXSsvXSwKICAgICAgICAgICBbJ2xhbmctanMnLCAgICAgICAvXm9uXHcrXHMqPVxzKlwiKFteXCJdKylcIi9pXSwKICAgICAgICAgICBbJ2xhbmctanMnLCAgICAgICAvXm9uXHcrXHMqPVxzKlwnKFteXCddKylcJy9pXSwKICAgICAgICAgICBbJ2xhbmctanMnLCAgICAgICAvXm9uXHcrXHMqPVxzKihbXlwiXCc+XHNdKykvaV0sCiAgICAgICAgICAgWydsYW5nLWNzcycsICAgICAgL15zdHlsZVxzKj1ccypcIihbXlwiXSspXCIvaV0sCiAgICAgICAgICAgWydsYW5nLWNzcycsICAgICAgL15zdHlsZVxzKj1ccypcJyhbXlwnXSspXCcvaV0sCiAgICAgICAgICAgWydsYW5nLWNzcycsICAgICAgL15zdHlsZVxzKj1ccyooW15cIlwnPlxzXSspL2ldCiAgICAgICAgICAgXSksCiAgICAgIFsnaW4udGFnJ10pOwogIHJlZ2lzdGVyTGFuZ0hhbmRsZXIoCiAgICAgIGNyZWF0ZVNpbXBsZUxleGVyKFtdLCBbW1BSX0FUVFJJQl9WQUxVRSwgL15bXHNcU10rL11dKSwgWyd1cS52YWwnXSk7CiAgcmVnaXN0ZXJMYW5nSGFuZGxlcihzb3VyY2VEZWNvcmF0b3IoewogICAgICAgICAgJ2tleXdvcmRzJzogQ1BQX0tFWVdPUkRTLAogICAgICAgICAgJ2hhc2hDb21tZW50cyc6IHRydWUsCiAgICAgICAgICAnY1N0eWxlQ29tbWVudHMnOiB0cnVlCiAgICAgICAgfSksIFsnYycsICdjYycsICdjcHAnLCAnY3h4JywgJ2N5YycsICdtJ10pOwogIHJlZ2lzdGVyTGFuZ0hhbmRsZXIoc291cmNlRGVjb3JhdG9yKHsKICAgICAgICAgICdrZXl3b3Jkcyc6ICdudWxsIHRydWUgZmFsc2UnCiAgICAgICAgfSksIFsnanNvbiddKTsKICByZWdpc3RlckxhbmdIYW5kbGVyKHNvdXJjZURlY29yYXRvcih7CiAgICAgICAgICAna2V5d29yZHMnOiBDU0hBUlBfS0VZV09SRFMsCiAgICAgICAgICAnaGFzaENvbW1lbnRzJzogdHJ1ZSwKICAgICAgICAgICdjU3R5bGVDb21tZW50cyc6IHRydWUsCiAgICAgICAgICAndmVyYmF0aW1TdHJpbmdzJzogdHJ1ZQogICAgICAgIH0pLCBbJ2NzJ10pOwogIHJlZ2lzdGVyTGFuZ0hhbmRsZXIoc291cmNlRGVjb3JhdG9yKHsKICAgICAgICAgICdrZXl3b3Jkcyc6IEpBVkFfS0VZV09SRFMsCiAgICAgICAgICAnY1N0eWxlQ29tbWVudHMnOiB0cnVlCiAgICAgICAgfSksIFsnamF2YSddKTsKICByZWdpc3RlckxhbmdIYW5kbGVyKHNvdXJjZURlY29yYXRvcih7CiAgICAgICAgICAna2V5d29yZHMnOiBTSF9LRVlXT1JEUywKICAgICAgICAgICdoYXNoQ29tbWVudHMnOiB0cnVlLAogICAgICAgICAgJ211bHRpTGluZVN0cmluZ3MnOiB0cnVlCiAgICAgICAgfSksIFsnYnNoJywgJ2NzaCcsICdzaCddKTsKICByZWdpc3RlckxhbmdIYW5kbGVyKHNvdXJjZURlY29yYXRvcih7CiAgICAgICAgICAna2V5d29yZHMnOiBQWVRIT05fS0VZV09SRFMsCiAgICAgICAgICAnaGFzaENvbW1lbnRzJzogdHJ1ZSwKICAgICAgICAgICdtdWx0aUxpbmVTdHJpbmdzJzogdHJ1ZSwKICAgICAgICAgICd0cmlwbGVRdW90ZWRTdHJpbmdzJzogdHJ1ZQogICAgICAgIH0pLCBbJ2N2JywgJ3B5J10pOwogIHJlZ2lzdGVyTGFuZ0hhbmRsZXIoc291cmNlRGVjb3JhdG9yKHsKICAgICAgICAgICdrZXl3b3Jkcyc6IFBFUkxfS0VZV09SRFMsCiAgICAgICAgICAnaGFzaENvbW1lbnRzJzogdHJ1ZSwKICAgICAgICAgICdtdWx0aUxpbmVTdHJpbmdzJzogdHJ1ZSwKICAgICAgICAgICdyZWdleExpdGVyYWxzJzogdHJ1ZQogICAgICAgIH0pLCBbJ3BlcmwnLCAncGwnLCAncG0nXSk7CiAgcmVnaXN0ZXJMYW5nSGFuZGxlcihzb3VyY2VEZWNvcmF0b3IoewogICAgICAgICAgJ2tleXdvcmRzJzogUlVCWV9LRVlXT1JEUywKICAgICAgICAgICdoYXNoQ29tbWVudHMnOiB0cnVlLAogICAgICAgICAgJ211bHRpTGluZVN0cmluZ3MnOiB0cnVlLAogICAgICAgICAgJ3JlZ2V4TGl0ZXJhbHMnOiB0cnVlCiAgICAgICAgfSksIFsncmInXSk7CiAgcmVnaXN0ZXJMYW5nSGFuZGxlcihzb3VyY2VEZWNvcmF0b3IoewogICAgICAgICAgJ2tleXdvcmRzJzogSlNDUklQVF9LRVlXT1JEUywKICAgICAgICAgICdjU3R5bGVDb21tZW50cyc6IHRydWUsCiAgICAgICAgICAncmVnZXhMaXRlcmFscyc6IHRydWUKICAgICAgICB9KSwgWydqcyddKTsKICByZWdpc3RlckxhbmdIYW5kbGVyKHNvdXJjZURlY29yYXRvcih7CiAgICAgICAgICAna2V5d29yZHMnOiBDT0ZGRUVfS0VZV09SRFMsCiAgICAgICAgICAnaGFzaENvbW1lbnRzJzogMywgIC8vICMjIyBzdHlsZSBibG9jayBjb21tZW50cwogICAgICAgICAgJ2NTdHlsZUNvbW1lbnRzJzogdHJ1ZSwKICAgICAgICAgICdtdWx0aWxpbmVTdHJpbmdzJzogdHJ1ZSwKICAgICAgICAgICd0cmlwbGVRdW90ZWRTdHJpbmdzJzogdHJ1ZSwKICAgICAgICAgICdyZWdleExpdGVyYWxzJzogdHJ1ZQogICAgICAgIH0pLCBbJ2NvZmZlZSddKTsKICByZWdpc3RlckxhbmdIYW5kbGVyKGNyZWF0ZVNpbXBsZUxleGVyKFtdLCBbW1BSX1NUUklORywgL15bXHNcU10rL11dKSwgWydyZWdleCddKTsKCiAgZnVuY3Rpb24gYXBwbHlEZWNvcmF0b3Ioam9iKSB7CiAgICB2YXIgb3B0X2xhbmdFeHRlbnNpb24gPSBqb2IubGFuZ0V4dGVuc2lvbjsKCiAgICB0cnkgewogICAgICAvLyBFeHRyYWN0IHRhZ3MsIGFuZCBjb252ZXJ0IHRoZSBzb3VyY2UgY29kZSB0byBwbGFpbiB0ZXh0LgogICAgICB2YXIgc291cmNlQW5kU3BhbnMgPSBleHRyYWN0U291cmNlU3BhbnMoam9iLnNvdXJjZU5vZGUpOwogICAgICAvKiogUGxhaW4gdGV4dC4gQHR5cGUge3N0cmluZ30gKi8KICAgICAgdmFyIHNvdXJjZSA9IHNvdXJjZUFuZFNwYW5zLnNvdXJjZTsKICAgICAgam9iLnNvdXJjZSA9IHNvdXJjZTsKICAgICAgam9iLnNwYW5zID0gc291cmNlQW5kU3BhbnMuc3BhbnM7CiAgICAgIGpvYi5iYXNlUG9zID0gMDsKCiAgICAgIC8vIEFwcGx5IHRoZSBhcHByb3ByaWF0ZSBsYW5ndWFnZSBoYW5kbGVyCiAgICAgIGxhbmdIYW5kbGVyRm9yRXh0ZW5zaW9uKG9wdF9sYW5nRXh0ZW5zaW9uLCBzb3VyY2UpKGpvYik7CgogICAgICAvLyBJbnRlZ3JhdGUgdGhlIGRlY29yYXRpb25zIGFuZCB0YWdzIGJhY2sgaW50byB0aGUgc291cmNlIGNvZGUsCiAgICAgIC8vIG1vZGlmeWluZyB0aGUgc291cmNlTm9kZSBpbiBwbGFjZS4KICAgICAgcmVjb21iaW5lVGFnc0FuZERlY29yYXRpb25zKGpvYik7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGlmICgnY29uc29sZScgaW4gd2luZG93KSB7CiAgICAgICAgY29uc29sZVsnbG9nJ10oZSAmJiBlWydzdGFjayddID8gZVsnc3RhY2snXSA6IGUpOwogICAgICB9CiAgICB9CiAgfQoKICAvKioKICAgKiBAcGFyYW0gc291cmNlQ29kZUh0bWwge3N0cmluZ30gVGhlIEhUTUwgdG8gcHJldHR5IHByaW50LgogICAqIEBwYXJhbSBvcHRfbGFuZ0V4dGVuc2lvbiB7c3RyaW5nfSBUaGUgbGFuZ3VhZ2UgbmFtZSB0byB1c2UuCiAgICogICAgIFR5cGljYWxseSwgYSBmaWxlbmFtZSBleHRlbnNpb24gbGlrZSAnY3BwJyBvciAnamF2YScuCiAgICogQHBhcmFtIG9wdF9udW1iZXJMaW5lcyB7bnVtYmVyfGJvb2xlYW59IFRydWUgdG8gbnVtYmVyIGxpbmVzLAogICAqICAgICBvciB0aGUgMS1pbmRleGVkIG51bWJlciBvZiB0aGUgZmlyc3QgbGluZSBpbiBzb3VyY2VDb2RlSHRtbC4KICAgKi8KICBmdW5jdGlvbiBwcmV0dHlQcmludE9uZShzb3VyY2VDb2RlSHRtbCwgb3B0X2xhbmdFeHRlbnNpb24sIG9wdF9udW1iZXJMaW5lcykgewogICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1BSRScpOwogICAgLy8gVGhpcyBjb3VsZCBjYXVzZSBpbWFnZXMgdG8gbG9hZCBhbmQgb25sb2FkIGxpc3RlbmVycyB0byBmaXJlLgogICAgLy8gRS5nLiA8aW1nIG9uZXJyb3I9ImFsZXJ0KDEzMzcpIiBzcmM9Im5vc3VjaGltYWdlLnBuZyI+LgogICAgLy8gV2UgYXNzdW1lIHRoYXQgdGhlIGlubmVyIEhUTUwgaXMgZnJvbSBhIHRydXN0ZWQgc291cmNlLgogICAgY29udGFpbmVyLmlubmVySFRNTCA9IHNvdXJjZUNvZGVIdG1sOwogICAgaWYgKG9wdF9udW1iZXJMaW5lcykgewogICAgICBudW1iZXJMaW5lcyhjb250YWluZXIsIG9wdF9udW1iZXJMaW5lcyk7CiAgICB9CgogICAgdmFyIGpvYiA9IHsKICAgICAgbGFuZ0V4dGVuc2lvbjogb3B0X2xhbmdFeHRlbnNpb24sCiAgICAgIG51bWJlckxpbmVzOiBvcHRfbnVtYmVyTGluZXMsCiAgICAgIHNvdXJjZU5vZGU6IGNvbnRhaW5lcgogICAgfTsKICAgIGFwcGx5RGVjb3JhdG9yKGpvYik7CiAgICByZXR1cm4gY29udGFpbmVyLmlubmVySFRNTDsKICB9CgogIGZ1bmN0aW9uIHByZXR0eVByaW50KG9wdF93aGVuRG9uZSkgewogICAgZnVuY3Rpb24gYnlUYWdOYW1lKHRuKSB7IHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0bik7IH0KICAgIC8vIGZldGNoIGEgbGlzdCBvZiBub2RlcyB0byByZXdyaXRlCiAgICB2YXIgY29kZVNlZ21lbnRzID0gW2J5VGFnTmFtZSgncHJlJyksIGJ5VGFnTmFtZSgnY29kZScpLCBieVRhZ05hbWUoJ3htcCcpXTsKICAgIHZhciBlbGVtZW50cyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2RlU2VnbWVudHMubGVuZ3RoOyArK2kpIHsKICAgICAgZm9yICh2YXIgaiA9IDAsIG4gPSBjb2RlU2VnbWVudHNbaV0ubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgICAgZWxlbWVudHMucHVzaChjb2RlU2VnbWVudHNbaV1bal0pOwogICAgICB9CiAgICB9CiAgICBjb2RlU2VnbWVudHMgPSBudWxsOwoKICAgIHZhciBjbG9jayA9IERhdGU7CiAgICBpZiAoIWNsb2NrWydub3cnXSkgewogICAgICBjbG9jayA9IHsgJ25vdyc6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIChuZXcgRGF0ZSkuZ2V0VGltZSgpOyB9IH07CiAgICB9CgogICAgLy8gVGhlIGxvb3AgaXMgYnJva2VuIGludG8gYSBzZXJpZXMgb2YgY29udGludWF0aW9ucyB0byBtYWtlIHN1cmUgdGhhdCB3ZQogICAgLy8gZG9uJ3QgbWFrZSB0aGUgYnJvd3NlciB1bnJlc3BvbnNpdmUgd2hlbiByZXdyaXRpbmcgYSBsYXJnZSBwYWdlLgogICAgdmFyIGsgPSAwOwogICAgdmFyIHByZXR0eVByaW50aW5nSm9iOwoKICAgIGZ1bmN0aW9uIGRvV29yaygpIHsKICAgICAgdmFyIGVuZFRpbWUgPSAod2luZG93WydQUl9TSE9VTERfVVNFX0NPTlRJTlVBVElPTiddID8KICAgICAgICAgICAgICAgICAgICAgY2xvY2subm93KCkgKyAyNTAgLyogbXMgKi8gOgogICAgICAgICAgICAgICAgICAgICBJbmZpbml0eSk7CiAgICAgIGZvciAoOyBrIDwgZWxlbWVudHMubGVuZ3RoICYmIGNsb2NrLm5vdygpIDwgZW5kVGltZTsgaysrKSB7CiAgICAgICAgdmFyIGNzID0gZWxlbWVudHNba107CiAgICAgICAgaWYgKGNzLmNsYXNzTmFtZSAmJiBjcy5jbGFzc05hbWUuaW5kZXhPZigncHJldHR5cHJpbnQnKSA+PSAwKSB7CiAgICAgICAgICAvLyBJZiB0aGUgY2xhc3NlcyBpbmNsdWRlcyBhIGxhbmd1YWdlIGV4dGVuc2lvbnMsIHVzZSBpdC4KICAgICAgICAgIC8vIExhbmd1YWdlIGV4dGVuc2lvbnMgY2FuIGJlIHNwZWNpZmllZCBsaWtlCiAgICAgICAgICAvLyAgICAgPHByZSBjbGFzcz0icHJldHR5cHJpbnQgbGFuZy1jcHAiPgogICAgICAgICAgLy8gdGhlIGxhbmd1YWdlIGV4dGVuc2lvbiAiY3BwIiBpcyB1c2VkIHRvIGZpbmQgYSBsYW5ndWFnZSBoYW5kbGVyIGFzCiAgICAgICAgICAvLyBwYXNzZWQgdG8gUFIucmVnaXN0ZXJMYW5nSGFuZGxlci4KICAgICAgICAgIHZhciBsYW5nRXh0ZW5zaW9uID0gY3MuY2xhc3NOYW1lLm1hdGNoKC9cYmxhbmctKFx3KylcYi8pOwogICAgICAgICAgaWYgKGxhbmdFeHRlbnNpb24pIHsgbGFuZ0V4dGVuc2lvbiA9IGxhbmdFeHRlbnNpb25bMV07IH0KCiAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhpcyBpcyBub3QgbmVzdGVkIGluIGFuIGFscmVhZHkgcHJldHRpZmllZCBlbGVtZW50CiAgICAgICAgICB2YXIgbmVzdGVkID0gZmFsc2U7CiAgICAgICAgICBmb3IgKHZhciBwID0gY3MucGFyZW50Tm9kZTsgcDsgcCA9IHAucGFyZW50Tm9kZSkgewogICAgICAgICAgICBpZiAoKHAudGFnTmFtZSA9PT0gJ3ByZScgfHwgcC50YWdOYW1lID09PSAnY29kZScgfHwKICAgICAgICAgICAgICAgICBwLnRhZ05hbWUgPT09ICd4bXAnKSAmJgogICAgICAgICAgICAgICAgcC5jbGFzc05hbWUgJiYgcC5jbGFzc05hbWUuaW5kZXhPZigncHJldHR5cHJpbnQnKSA+PSAwKSB7CiAgICAgICAgICAgICAgbmVzdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKCFuZXN0ZWQpIHsKICAgICAgICAgICAgLy8gTG9vayBmb3IgYSBjbGFzcyBsaWtlIGxpbmVudW1zIG9yIGxpbmVudW1zOjxuPiB3aGVyZSA8bj4gaXMgdGhlCiAgICAgICAgICAgIC8vIDEtaW5kZXhlZCBudW1iZXIgb2YgdGhlIGZpcnN0IGxpbmUuCiAgICAgICAgICAgIHZhciBsaW5lTnVtcyA9IGNzLmNsYXNzTmFtZS5tYXRjaCgvXGJsaW5lbnVtc1xiKD86OihcZCspKT8vKTsKICAgICAgICAgICAgbGluZU51bXMgPSBsaW5lTnVtcwogICAgICAgICAgICAgICAgICA/IGxpbmVOdW1zWzFdICYmIGxpbmVOdW1zWzFdLmxlbmd0aCA/ICtsaW5lTnVtc1sxXSA6IHRydWUKICAgICAgICAgICAgICAgICAgOiBmYWxzZTsKICAgICAgICAgICAgaWYgKGxpbmVOdW1zKSB7IG51bWJlckxpbmVzKGNzLCBsaW5lTnVtcyk7IH0KCiAgICAgICAgICAgIC8vIGRvIHRoZSBwcmV0dHkgcHJpbnRpbmcKICAgICAgICAgICAgcHJldHR5UHJpbnRpbmdKb2IgPSB7CiAgICAgICAgICAgICAgbGFuZ0V4dGVuc2lvbjogbGFuZ0V4dGVuc2lvbiwKICAgICAgICAgICAgICBzb3VyY2VOb2RlOiBjcywKICAgICAgICAgICAgICBudW1iZXJMaW5lczogbGluZU51bXMKICAgICAgICAgICAgfTsKICAgICAgICAgICAgYXBwbHlEZWNvcmF0b3IocHJldHR5UHJpbnRpbmdKb2IpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoayA8IGVsZW1lbnRzLmxlbmd0aCkgewogICAgICAgIC8vIGZpbmlzaCB1cCBpbiBhIGNvbnRpbnVhdGlvbgogICAgICAgIHNldFRpbWVvdXQoZG9Xb3JrLCAyNTApOwogICAgICB9IGVsc2UgaWYgKG9wdF93aGVuRG9uZSkgewogICAgICAgIG9wdF93aGVuRG9uZSgpOwogICAgICB9CiAgICB9CgogICAgZG9Xb3JrKCk7CiAgfQoKICB3aW5kb3dbJ3ByZXR0eVByaW50T25lJ10gPSBwcmV0dHlQcmludE9uZTsKICB3aW5kb3dbJ3ByZXR0eVByaW50J10gPSBwcmV0dHlQcmludDsKICB3aW5kb3dbJ1BSJ10gPSB7CiAgICAgICAgJ2NyZWF0ZVNpbXBsZUxleGVyJzogY3JlYXRlU2ltcGxlTGV4ZXIsCiAgICAgICAgJ3JlZ2lzdGVyTGFuZ0hhbmRsZXInOiByZWdpc3RlckxhbmdIYW5kbGVyLAogICAgICAgICdzb3VyY2VEZWNvcmF0b3InOiBzb3VyY2VEZWNvcmF0b3IsCiAgICAgICAgJ1BSX0FUVFJJQl9OQU1FJzogUFJfQVRUUklCX05BTUUsCiAgICAgICAgJ1BSX0FUVFJJQl9WQUxVRSc6IFBSX0FUVFJJQl9WQUxVRSwKICAgICAgICAnUFJfQ09NTUVOVCc6IFBSX0NPTU1FTlQsCiAgICAgICAgJ1BSX0RFQ0xBUkFUSU9OJzogUFJfREVDTEFSQVRJT04sCiAgICAgICAgJ1BSX0tFWVdPUkQnOiBQUl9LRVlXT1JELAogICAgICAgICdQUl9MSVRFUkFMJzogUFJfTElURVJBTCwKICAgICAgICAnUFJfTk9DT0RFJzogUFJfTk9DT0RFLAogICAgICAgICdQUl9QTEFJTic6IFBSX1BMQUlOLAogICAgICAgICdQUl9QVU5DVFVBVElPTic6IFBSX1BVTkNUVUFUSU9OLAogICAgICAgICdQUl9TT1VSQ0UnOiBQUl9TT1VSQ0UsCiAgICAgICAgJ1BSX1NUUklORyc6IFBSX1NUUklORywKICAgICAgICAnUFJfVEFHJzogUFJfVEFHLAogICAgICAgICdQUl9UWVBFJzogUFJfVFlQRQogICAgICB9Owp9KSgpOwo=</content>
    <filesize>53996</filesize>
  </attachment>
  <attachment>
    <filename>print.css</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1564816944000</date>
    <version>1.1</version>
    <comment/>
    <content>CmJvZHkgewogICBoZWlnaHQ6IDEwMCU7Cn0KCi5zbGlkZXMgPiBhcnRpY2xlIHsKICAgZGlzcGxheTogYmxvY2s7CiAgIHBhZ2UtYnJlYWstYmVmb3JlOiBhbHdheXM7CiAgIG92ZXJmbG93OiBoaWRkZW47CiAgIHdpZHRoOiAxMDAlOwogICBoZWlnaHQ6IDEwMCU7CiAgIG1hcmdpbi1sZWZ0OiAwcHg7CiAgIG1hcmdpbi10b3A6IDBweDsKICB2aXNpYmlsaXR5OiB2aXNpYmxlOwogIC13ZWJraXQtdHJhbnNmb3JtOiBub25lOwogIHRyYW5zZm9ybTogbm9uZTsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgbGVmdDogMDsKICB0b3A6IDA7CiAgYm94LXNoYWRvdzogbm9uZTsKfQoKLnNsaWRlcyBhcnRpY2xlLmJpZ2xvZ28gewogIGJhY2tncm91bmQ6IHVybCgnbG9nby5wbmcnKSA3MTBweCA2MjVweCBuby1yZXBlYXQ7CiAtd2Via2l0LXByaW50LWNvbG9yLWFkanVzdDogZXhhY3Q7Cn0KCi5zbGlkZXMudGVtcGxhdGUtZGVmYXVsdCBhcnRpY2xlLmJpZ2xvZ28gewogIGJhY2tncm91bmQ6IHdoaXRlIHVybCgnbG9nb2JpZy5wbmcnKSA1MCUgNTAlIG5vLXJlcGVhdDsKIC13ZWJraXQtcHJpbnQtY29sb3ItYWRqdXN0OiBleGFjdDsKfQoKaDIgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB0b3A6IDQwMHB4OwogIGJvdHRvbTogYXV0bzsgIAp9Cgouc2xpZGVzID4gYXJ0aWNsZSB7Cn0KLnNsaWRlcyA+IGFydGljbGUuZmFyLW5leHQgfiBhcnRpY2xlIHsKICAtd2Via2l0LXRyYW5zZm9ybTogbm9uZTsKICB0cmFuc2Zvcm06IG5vbmU7Cn0KLnNsaWRlcyA+IGFydGljbGUuZmFyLXBhc3QgewogIHZpc2liaWxpdHk6IHZpc2libGU7CiAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7CiAgdHJhbnNmb3JtOiBub25lOwp9Ci5zbGlkZXMgPiBhcnRpY2xlLnBhc3QgewogIHZpc2liaWxpdHk6IHZpc2libGU7Cn0KLnNsaWRlcyA+IGFydGljbGUuY3VycmVudCB7CiAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAtd2Via2l0LXRyYW5zZm9ybTogbm9uZTsKICB0cmFuc2Zvcm06IG5vbmU7Cn0KLnNsaWRlcyA+IGFydGljbGUubmV4dCB7CiAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAtd2Via2l0LXRyYW5zZm9ybTogbm9uZTsKICB0cmFuc2Zvcm06IG5vbmU7Cn0KLnNsaWRlcyA+IGFydGljbGUuZmFyLW5leHQgewogIHZpc2liaWxpdHk6IHZpc2libGU7CiAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7CiAgdHJhbnNmb3JtOiBub25lOwp9Cgouc2xpZGVzLmxheW91dC13aWRlc2NyZWVuID4gYXJ0aWNsZS5mYXItcGFzdCwKLnNsaWRlcy5sYXlvdXQtZmF1eC13aWRlc2NyZWVuID4gYXJ0aWNsZS5mYXItcGFzdCB7CiAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7CiAgdHJhbnNmb3JtOiBub25lOwp9Ci5zbGlkZXMubGF5b3V0LXdpZGVzY3JlZW4gPiBhcnRpY2xlLnBhc3QsCi5zbGlkZXMubGF5b3V0LWZhdXgtd2lkZXNjcmVlbiA+IGFydGljbGUucGFzdCB7CiAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7CiAgdHJhbnNmb3JtOiBub25lOwp9Ci5zbGlkZXMubGF5b3V0LXdpZGVzY3JlZW4gPiBhcnRpY2xlLm5leHQsCi5zbGlkZXMubGF5b3V0LWZhdXgtd2lkZXNjcmVlbiA+IGFydGljbGUubmV4dCB7CiAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7CiAgdHJhbnNmb3JtOiBub25lOwp9Ci5zbGlkZXMubGF5b3V0LXdpZGVzY3JlZW4gPiBhcnRpY2xlLmZhci1uZXh0LAouc2xpZGVzLmxheW91dC1mYXV4LXdpZGVzY3JlZW4gPiBhcnRpY2xlLmZhci1uZXh0IHsKICAtd2Via2l0LXRyYW5zZm9ybTogbm9uZTsKICB0cmFuc2Zvcm06IG5vbmU7Cn0KCmFydGljbGU6bm90KC5ub2JhY2tncm91bmQpOm5vdCguZmlsbCk6bm90KC5iaWdsb2dvKTphZnRlciB7CiAgYm90dG9tOiAyMHB4OwogIGNvbnRlbnQ6IGNvdW50ZXIocG5vKSAiLyIgYXR0cih0cG4pOwogIGxlZnQ6IDIwcHg7CiAgcG9zaXRpb246IGFic29sdXRlOwp9Cg==</content>
    <filesize>1924</filesize>
  </attachment>
  <attachment>
    <filename>slides.js</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1564816944000</date>
    <version>1.1</version>
    <comment/>
    <content>LyoKICBHb29nbGUgSFRNTDUgc2xpZGVzIHRlbXBsYXRlCgogIEF1dGhvcnM6IEx1a2UgTWFow6kgKGNvZGUpCiAgICAgICAgICAgTWFyY2luIFdpY2hhcnkgKGNvZGUgYW5kIGRlc2lnbikKCiAgICAgICAgICAgRG9taW5pYyBNYXp6b25pIChicm93c2VyIGNvbXBhdGliaWxpdHkpCiAgICAgICAgICAgQ2hhcmxlcyBDaGVuIChDaHJvbWVWb3ggc3VwcG9ydCkKCiAgVVJMOiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvaHRtbDVzbGlkZXMvCiovCgp2YXIgU0xJREVfQ0xBU1NFUyA9IFsnZmFyLXBhc3QnLCAncGFzdCcsICdjdXJyZW50JywgJ25leHQnLCAnZmFyLW5leHQnXTsKCnZhciBQTV9UT1VDSF9TRU5TSVRJVklUWSA9IDE1OwoKdmFyIGN1clNsaWRlOwoKLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwovKiBjbGFzc0xpc3QgcG9seWZpbGwgYnkgRWxpIEdyZXkgCiAqIChodHRwOi8vcHVybC5lbGlncmV5LmNvbS9naXRodWIvY2xhc3NMaXN0LmpzL2Jsb2IvbWFzdGVyL2NsYXNzTGlzdC5qcykgKi8KCmlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICJ1bmRlZmluZWQiICYmICEoImNsYXNzTGlzdCIgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpKSkgewoKKGZ1bmN0aW9uICh2aWV3KSB7Cgp2YXIKICAgIGNsYXNzTGlzdFByb3AgPSAiY2xhc3NMaXN0IgogICwgcHJvdG9Qcm9wID0gInByb3RvdHlwZSIKICAsIGVsZW1DdHJQcm90byA9ICh2aWV3LkhUTUxFbGVtZW50IHx8IHZpZXcuRWxlbWVudClbcHJvdG9Qcm9wXQogICwgb2JqQ3RyID0gT2JqZWN0CiAgICBzdHJUcmltID0gU3RyaW5nW3Byb3RvUHJvcF0udHJpbSB8fCBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC9eXHMrfFxzKyQvZywgIiIpOwogIH0KICAsIGFyckluZGV4T2YgPSBBcnJheVtwcm90b1Byb3BdLmluZGV4T2YgfHwgZnVuY3Rpb24gKGl0ZW0pIHsKICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIGlmIChpIGluIHRoaXMgJiYgdGhpc1tpXSA9PT0gaXRlbSkgewogICAgICAgIHJldHVybiBpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gLTE7CiAgfQogIC8vIFZlbmRvcnM6IHBsZWFzZSBhbGxvdyBjb250ZW50IGNvZGUgdG8gaW5zdGFudGlhdGUgRE9NRXhjZXB0aW9ucwogICwgRE9NRXggPSBmdW5jdGlvbiAodHlwZSwgbWVzc2FnZSkgewogICAgdGhpcy5uYW1lID0gdHlwZTsKICAgIHRoaXMuY29kZSA9IERPTUV4Y2VwdGlvblt0eXBlXTsKICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7CiAgfQogICwgY2hlY2tUb2tlbkFuZEdldEluZGV4ID0gZnVuY3Rpb24gKGNsYXNzTGlzdCwgdG9rZW4pIHsKICAgIGlmICh0b2tlbiA9PT0gIiIpIHsKICAgICAgdGhyb3cgbmV3IERPTUV4KAogICAgICAgICAgIlNZTlRBWF9FUlIiCiAgICAgICAgLCAiQW4gaW52YWxpZCBvciBpbGxlZ2FsIHN0cmluZyB3YXMgc3BlY2lmaWVkIgogICAgICApOwogICAgfQogICAgaWYgKC9ccy8udGVzdCh0b2tlbikpIHsKICAgICAgdGhyb3cgbmV3IERPTUV4KAogICAgICAgICAgIklOVkFMSURfQ0hBUkFDVEVSX0VSUiIKICAgICAgICAsICJTdHJpbmcgY29udGFpbnMgYW4gaW52YWxpZCBjaGFyYWN0ZXIiCiAgICAgICk7CiAgICB9CiAgICByZXR1cm4gYXJySW5kZXhPZi5jYWxsKGNsYXNzTGlzdCwgdG9rZW4pOwogIH0KICAsIENsYXNzTGlzdCA9IGZ1bmN0aW9uIChlbGVtKSB7CiAgICB2YXIKICAgICAgICB0cmltbWVkQ2xhc3NlcyA9IHN0clRyaW0uY2FsbChlbGVtLmNsYXNzTmFtZSkKICAgICAgLCBjbGFzc2VzID0gdHJpbW1lZENsYXNzZXMgPyB0cmltbWVkQ2xhc3Nlcy5zcGxpdCgvXHMrLykgOiBbXQogICAgOwogICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNsYXNzZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgdGhpcy5wdXNoKGNsYXNzZXNbaV0pOwogICAgfQogICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lID0gZnVuY3Rpb24gKCkgewogICAgICBlbGVtLmNsYXNzTmFtZSA9IHRoaXMudG9TdHJpbmcoKTsKICAgIH07CiAgfQogICwgY2xhc3NMaXN0UHJvdG8gPSBDbGFzc0xpc3RbcHJvdG9Qcm9wXSA9IFtdCiAgLCBjbGFzc0xpc3RHZXR0ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gbmV3IENsYXNzTGlzdCh0aGlzKTsKICB9CjsKLy8gTW9zdCBET01FeGNlcHRpb24gaW1wbGVtZW50YXRpb25zIGRvbid0IGFsbG93IGNhbGxpbmcgRE9NRXhjZXB0aW9uJ3MgdG9TdHJpbmcoKQovLyBvbiBub24tRE9NRXhjZXB0aW9ucy4gRXJyb3IncyB0b1N0cmluZygpIGlzIHN1ZmZpY2llbnQgaGVyZS4KRE9NRXhbcHJvdG9Qcm9wXSA9IEVycm9yW3Byb3RvUHJvcF07CmNsYXNzTGlzdFByb3RvLml0ZW0gPSBmdW5jdGlvbiAoaSkgewogIHJldHVybiB0aGlzW2ldIHx8IG51bGw7Cn07CmNsYXNzTGlzdFByb3RvLmNvbnRhaW5zID0gZnVuY3Rpb24gKHRva2VuKSB7CiAgdG9rZW4gKz0gIiI7CiAgcmV0dXJuIGNoZWNrVG9rZW5BbmRHZXRJbmRleCh0aGlzLCB0b2tlbikgIT09IC0xOwp9OwpjbGFzc0xpc3RQcm90by5hZGQgPSBmdW5jdGlvbiAodG9rZW4pIHsKICB0b2tlbiArPSAiIjsKICBpZiAoY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKSA9PT0gLTEpIHsKICAgIHRoaXMucHVzaCh0b2tlbik7CiAgICB0aGlzLl91cGRhdGVDbGFzc05hbWUoKTsKICB9Cn07CmNsYXNzTGlzdFByb3RvLnJlbW92ZSA9IGZ1bmN0aW9uICh0b2tlbikgewogIHRva2VuICs9ICIiOwogIHZhciBpbmRleCA9IGNoZWNrVG9rZW5BbmRHZXRJbmRleCh0aGlzLCB0b2tlbik7CiAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgdGhpcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lKCk7CiAgfQp9OwpjbGFzc0xpc3RQcm90by50b2dnbGUgPSBmdW5jdGlvbiAodG9rZW4pIHsKICB0b2tlbiArPSAiIjsKICBpZiAoY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKSA9PT0gLTEpIHsKICAgIHRoaXMuYWRkKHRva2VuKTsKICB9IGVsc2UgewogICAgdGhpcy5yZW1vdmUodG9rZW4pOwogIH0KfTsKY2xhc3NMaXN0UHJvdG8udG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHRoaXMuam9pbigiICIpOwp9OwoKaWYgKG9iakN0ci5kZWZpbmVQcm9wZXJ0eSkgewogIHZhciBjbGFzc0xpc3RQcm9wRGVzYyA9IHsKICAgICAgZ2V0OiBjbGFzc0xpc3RHZXR0ZXIKICAgICwgZW51bWVyYWJsZTogdHJ1ZQogICAgLCBjb25maWd1cmFibGU6IHRydWUKICB9OwogIHRyeSB7CiAgICBvYmpDdHIuZGVmaW5lUHJvcGVydHkoZWxlbUN0clByb3RvLCBjbGFzc0xpc3RQcm9wLCBjbGFzc0xpc3RQcm9wRGVzYyk7CiAgfSBjYXRjaCAoZXgpIHsgLy8gSUUgOCBkb2Vzbid0IHN1cHBvcnQgZW51bWVyYWJsZTp0cnVlCiAgICBpZiAoZXgubnVtYmVyID09PSAtMHg3RkY1RUM1NCkgewogICAgICBjbGFzc0xpc3RQcm9wRGVzYy5lbnVtZXJhYmxlID0gZmFsc2U7CiAgICAgIG9iakN0ci5kZWZpbmVQcm9wZXJ0eShlbGVtQ3RyUHJvdG8sIGNsYXNzTGlzdFByb3AsIGNsYXNzTGlzdFByb3BEZXNjKTsKICAgIH0KICB9Cn0gZWxzZSBpZiAob2JqQ3RyW3Byb3RvUHJvcF0uX19kZWZpbmVHZXR0ZXJfXykgewogIGVsZW1DdHJQcm90by5fX2RlZmluZUdldHRlcl9fKGNsYXNzTGlzdFByb3AsIGNsYXNzTGlzdEdldHRlcik7Cn0KCn0oc2VsZikpOwoKfQovKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgovKiBTbGlkZSBtb3ZlbWVudCAqLwoKZnVuY3Rpb24gZ2V0U2xpZGVFbChubykgewogIGlmICgobm8gPCAwKSB8fCAobm8gPj0gc2xpZGVFbHMubGVuZ3RoKSkgeyAKICAgIHJldHVybiBudWxsOwogIH0gZWxzZSB7CiAgICByZXR1cm4gc2xpZGVFbHNbbm9dOwogIH0KfTsKCmZ1bmN0aW9uIHVwZGF0ZVNsaWRlQ2xhc3Moc2xpZGVObywgY2xhc3NOYW1lKSB7CiAgdmFyIGVsID0gZ2V0U2xpZGVFbChzbGlkZU5vKTsKICAKICBpZiAoIWVsKSB7CiAgICByZXR1cm47CiAgfQogIAogIGlmIChjbGFzc05hbWUpIHsKICAgIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTsKICB9CiAgICAKICBmb3IgKHZhciBpID0gMDsgaSA8IFNMSURFX0NMQVNTRVMubGVuZ3RoOyBpKyspIHsKICAgIGlmIChjbGFzc05hbWUgIT0gU0xJREVfQ0xBU1NFU1tpXSkgewogICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFNMSURFX0NMQVNTRVNbaV0pOwogICAgfQogIH0KfTsKCmZ1bmN0aW9uIHVwZGF0ZVNsaWRlcygpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWRlRWxzLmxlbmd0aDsgaSsrKSB7CiAgICBzd2l0Y2ggKGkpIHsKICAgICAgY2FzZSBjdXJTbGlkZSAtIDI6CiAgICAgICAgdXBkYXRlU2xpZGVDbGFzcyhpLCAnZmFyLXBhc3QnKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBjdXJTbGlkZSAtIDE6CiAgICAgICAgdXBkYXRlU2xpZGVDbGFzcyhpLCAncGFzdCcpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIGN1clNsaWRlOiAKICAgICAgICB1cGRhdGVTbGlkZUNsYXNzKGksICdjdXJyZW50Jyk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgY3VyU2xpZGUgKyAxOgogICAgICAgIHVwZGF0ZVNsaWRlQ2xhc3MoaSwgJ25leHQnKTsgICAgICAKICAgICAgICBicmVhazsKICAgICAgY2FzZSBjdXJTbGlkZSArIDI6CiAgICAgICAgdXBkYXRlU2xpZGVDbGFzcyhpLCAnZmFyLW5leHQnKTsgICAgICAKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB1cGRhdGVTbGlkZUNsYXNzKGkpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgdHJpZ2dlckxlYXZlRXZlbnQoY3VyU2xpZGUgLSAxKTsKICB0cmlnZ2VyRW50ZXJFdmVudChjdXJTbGlkZSk7CgogIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgLy8gSGlkZSBhZnRlciB0aGUgc2xpZGUKICAgIGRpc2FibGVTbGlkZUZyYW1lcyhjdXJTbGlkZSAtIDIpOwogIH0sIDMwMSk7CgogIGVuYWJsZVNsaWRlRnJhbWVzKGN1clNsaWRlIC0gMSk7CiAgZW5hYmxlU2xpZGVGcmFtZXMoY3VyU2xpZGUgKyAyKTsKICAKICBpZiAoaXNDaHJvbWVWb3hBY3RpdmUoKSkgewogICAgc3BlYWtBbmRTeW5jVG9Ob2RlKHNsaWRlRWxzW2N1clNsaWRlXSk7CiAgfSAgCgogIHVwZGF0ZUhhc2goKTsKfTsKCmZ1bmN0aW9uIGJ1aWxkTmV4dEl0ZW0oKSB7CiAgdmFyIHRvQnVpbGQgID0gc2xpZGVFbHNbY3VyU2xpZGVdLnF1ZXJ5U2VsZWN0b3JBbGwoJy50by1idWlsZCcpOwoKICBpZiAoIXRvQnVpbGQubGVuZ3RoKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB0b0J1aWxkWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ3RvLWJ1aWxkJyk7CgogIGlmIChpc0Nocm9tZVZveEFjdGl2ZSgpKSB7CiAgICBzcGVha0FuZFN5bmNUb05vZGUodG9CdWlsZFswXSk7CiAgfQoKICByZXR1cm4gdHJ1ZTsKfTsKCmZ1bmN0aW9uIHByZXZTbGlkZSgpIHsKICBpZiAoY3VyU2xpZGUgPiAwKSB7CiAgICBjdXJTbGlkZS0tOwoKICAgIHVwZGF0ZVNsaWRlcygpOwogIH0KfTsKCmZ1bmN0aW9uIG5leHRTbGlkZSgpIHsKICBpZiAoYnVpbGROZXh0SXRlbSgpKSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAoY3VyU2xpZGUgPCBzbGlkZUVscy5sZW5ndGggLSAxKSB7CiAgICBjdXJTbGlkZSsrOwoKICAgIHVwZGF0ZVNsaWRlcygpOwogIH0KfTsKCi8qIFNsaWRlIGV2ZW50cyAqLwoKZnVuY3Rpb24gdHJpZ2dlckVudGVyRXZlbnQobm8pIHsKICB2YXIgZWwgPSBnZXRTbGlkZUVsKG5vKTsKICBpZiAoIWVsKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgb25FbnRlciA9IGVsLmdldEF0dHJpYnV0ZSgnb25zbGlkZWVudGVyJyk7CiAgaWYgKG9uRW50ZXIpIHsKICAgIG5ldyBGdW5jdGlvbihvbkVudGVyKS5jYWxsKGVsKTsKICB9CgogIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTsKICBldnQuaW5pdEV2ZW50KCdzbGlkZWVudGVyJywgdHJ1ZSwgdHJ1ZSk7CiAgZXZ0LnNsaWRlTnVtYmVyID0gbm8gKyAxOyAvLyBNYWtlIGl0IHJlYWRhYmxlCgogIGVsLmRpc3BhdGNoRXZlbnQoZXZ0KTsKfTsKCmZ1bmN0aW9uIHRyaWdnZXJMZWF2ZUV2ZW50KG5vKSB7CiAgdmFyIGVsID0gZ2V0U2xpZGVFbChubyk7CiAgaWYgKCFlbCkgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIG9uTGVhdmUgPSBlbC5nZXRBdHRyaWJ1dGUoJ29uc2xpZGVsZWF2ZScpOwogIGlmIChvbkxlYXZlKSB7CiAgICBuZXcgRnVuY3Rpb24ob25MZWF2ZSkuY2FsbChlbCk7CiAgfQoKICB2YXIgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7CiAgZXZ0LmluaXRFdmVudCgnc2xpZGVsZWF2ZScsIHRydWUsIHRydWUpOwogIGV2dC5zbGlkZU51bWJlciA9IG5vICsgMTsgLy8gTWFrZSBpdCByZWFkYWJsZQogIAogIGVsLmRpc3BhdGNoRXZlbnQoZXZ0KTsKfTsKCi8qIFRvdWNoIGV2ZW50cyAqLwoKZnVuY3Rpb24gaGFuZGxlVG91Y2hTdGFydChldmVudCkgewogIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCA9PSAxKSB7CiAgICB0b3VjaERYID0gMDsKICAgIHRvdWNoRFkgPSAwOwoKICAgIHRvdWNoU3RhcnRYID0gZXZlbnQudG91Y2hlc1swXS5wYWdlWDsKICAgIHRvdWNoU3RhcnRZID0gZXZlbnQudG91Y2hlc1swXS5wYWdlWTsKCiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGhhbmRsZVRvdWNoTW92ZSwgdHJ1ZSk7CiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgaGFuZGxlVG91Y2hFbmQsIHRydWUpOwogIH0KfTsKCmZ1bmN0aW9uIGhhbmRsZVRvdWNoTW92ZShldmVudCkgewogIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCA+IDEpIHsKICAgIGNhbmNlbFRvdWNoKCk7CiAgfSBlbHNlIHsKICAgIHRvdWNoRFggPSBldmVudC50b3VjaGVzWzBdLnBhZ2VYIC0gdG91Y2hTdGFydFg7CiAgICB0b3VjaERZID0gZXZlbnQudG91Y2hlc1swXS5wYWdlWSAtIHRvdWNoU3RhcnRZOwogIH0KfTsKCmZ1bmN0aW9uIGhhbmRsZVRvdWNoRW5kKGV2ZW50KSB7CiAgdmFyIGR4ID0gTWF0aC5hYnModG91Y2hEWCk7CiAgdmFyIGR5ID0gTWF0aC5hYnModG91Y2hEWSk7CgogIGlmICgoZHggPiBQTV9UT1VDSF9TRU5TSVRJVklUWSkgJiYgKGR5IDwgKGR4ICogMiAvIDMpKSkgewogICAgaWYgKHRvdWNoRFggPiAwKSB7CiAgICAgIHByZXZTbGlkZSgpOwogICAgfSBlbHNlIHsKICAgICAgbmV4dFNsaWRlKCk7CiAgICB9CiAgfQogIAogIGNhbmNlbFRvdWNoKCk7Cn07CgpmdW5jdGlvbiBjYW5jZWxUb3VjaCgpIHsKICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGhhbmRsZVRvdWNoTW92ZSwgdHJ1ZSk7CiAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGhhbmRsZVRvdWNoRW5kLCB0cnVlKTsgIAp9OwoKLyogUHJlbG9hZGluZyBmcmFtZXMgKi8KCmZ1bmN0aW9uIGRpc2FibGVTbGlkZUZyYW1lcyhubykgewogIHZhciBlbCA9IGdldFNsaWRlRWwobm8pOwogIGlmICghZWwpIHsKICAgIHJldHVybjsKICB9CgogIHZhciBmcmFtZXMgPSBlbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaWZyYW1lJyk7CiAgZm9yICh2YXIgaSA9IDAsIGZyYW1lOyBmcmFtZSA9IGZyYW1lc1tpXTsgaSsrKSB7CiAgICBkaXNhYmxlRnJhbWUoZnJhbWUpOwogIH0KfTsKCmZ1bmN0aW9uIGVuYWJsZVNsaWRlRnJhbWVzKG5vKSB7CiAgdmFyIGVsID0gZ2V0U2xpZGVFbChubyk7CiAgaWYgKCFlbCkgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIGZyYW1lcyA9IGVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpZnJhbWUnKTsKICBmb3IgKHZhciBpID0gMCwgZnJhbWU7IGZyYW1lID0gZnJhbWVzW2ldOyBpKyspIHsKICAgIGVuYWJsZUZyYW1lKGZyYW1lKTsKICB9Cn07CgpmdW5jdGlvbiBkaXNhYmxlRnJhbWUoZnJhbWUpIHsKICBmcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnOwp9OwoKZnVuY3Rpb24gZW5hYmxlRnJhbWUoZnJhbWUpIHsKICB2YXIgc3JjID0gZnJhbWUuX3NyYzsKCiAgaWYgKGZyYW1lLnNyYyAhPSBzcmMgJiYgc3JjICE9ICdhYm91dDpibGFuaycpIHsKICAgIGZyYW1lLnNyYyA9IHNyYzsKICB9Cn07CgpmdW5jdGlvbiBzZXR1cEZyYW1lcygpIHsKICB2YXIgZnJhbWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaWZyYW1lJyk7CiAgZm9yICh2YXIgaSA9IDAsIGZyYW1lOyBmcmFtZSA9IGZyYW1lc1tpXTsgaSsrKSB7CiAgICBmcmFtZS5fc3JjID0gZnJhbWUuc3JjOwogICAgZGlzYWJsZUZyYW1lKGZyYW1lKTsKICB9CiAgCiAgZW5hYmxlU2xpZGVGcmFtZXMoY3VyU2xpZGUpOwogIGVuYWJsZVNsaWRlRnJhbWVzKGN1clNsaWRlICsgMSk7CiAgZW5hYmxlU2xpZGVGcmFtZXMoY3VyU2xpZGUgKyAyKTsgIAp9OwoKZnVuY3Rpb24gc2V0dXBJbnRlcmFjdGlvbigpIHsKICAvKiBDbGlja2luZyBhbmQgdGFwcGluZyAqLwogIAogIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIGVsLmNsYXNzTmFtZSA9ICdzbGlkZS1hcmVhJzsKICBlbC5pZCA9ICdwcmV2LXNsaWRlLWFyZWEnOyAgCiAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcmV2U2xpZGUsIGZhbHNlKTsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWN0aW9uLnNsaWRlcycpLmFwcGVuZENoaWxkKGVsKTsKCiAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgZWwuY2xhc3NOYW1lID0gJ3NsaWRlLWFyZWEnOwogIGVsLmlkID0gJ25leHQtc2xpZGUtYXJlYSc7ICAKICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG5leHRTbGlkZSwgZmFsc2UpOwogIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NlY3Rpb24uc2xpZGVzJykuYXBwZW5kQ2hpbGQoZWwpOyAgCiAgCiAgLyogU3dpcGluZyAqLwogIAogIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGhhbmRsZVRvdWNoU3RhcnQsIGZhbHNlKTsKfQoKLyogQ2hyb21lVm94IHN1cHBvcnQgKi8KCmZ1bmN0aW9uIGlzQ2hyb21lVm94QWN0aXZlKCkgewogIGlmICh0eXBlb2YoY3ZveCkgPT0gJ3VuZGVmaW5lZCcpIHsKICAgIHJldHVybiBmYWxzZTsKICB9IGVsc2UgewogICAgcmV0dXJuIHRydWU7CiAgfQp9OwoKZnVuY3Rpb24gc3BlYWtBbmRTeW5jVG9Ob2RlKG5vZGUpIHsKICBpZiAoIWlzQ2hyb21lVm94QWN0aXZlKCkpIHsKICAgIHJldHVybjsKICB9CiAgCiAgY3ZveC5DaHJvbWVWb3gubmF2aWdhdGlvbk1hbmFnZXIuc3dpdGNoVG9TdHJhdGVneSgKICAgICAgY3ZveC5DaHJvbWVWb3hOYXZpZ2F0aW9uTWFuYWdlci5TVFJBVEVHSUVTLkxJTkVBUkRPTSwgMCwgdHJ1ZSk7ICAKICBjdm94LkNocm9tZVZveC5uYXZpZ2F0aW9uTWFuYWdlci5zeW5jVG9Ob2RlKG5vZGUpOwogIGN2b3guQ2hyb21lVm94VXNlckNvbW1hbmRzLmZpbmlzaE5hdkNvbW1hbmQoJycpOwogIHZhciB0YXJnZXQgPSBub2RlOwogIHdoaWxlICh0YXJnZXQuZmlyc3RDaGlsZCkgewogICAgdGFyZ2V0ID0gdGFyZ2V0LmZpcnN0Q2hpbGQ7CiAgfQogIGN2b3guQ2hyb21lVm94Lm5hdmlnYXRpb25NYW5hZ2VyLnN5bmNUb05vZGUodGFyZ2V0KTsKfTsKCmZ1bmN0aW9uIHNwZWFrTmV4dEl0ZW0oKSB7CiAgaWYgKCFpc0Nocm9tZVZveEFjdGl2ZSgpKSB7CiAgICByZXR1cm47CiAgfQogIAogIGN2b3guQ2hyb21lVm94Lm5hdmlnYXRpb25NYW5hZ2VyLnN3aXRjaFRvU3RyYXRlZ3koCiAgICAgIGN2b3guQ2hyb21lVm94TmF2aWdhdGlvbk1hbmFnZXIuU1RSQVRFR0lFUy5MSU5FQVJET00sIDAsIHRydWUpOwogIGN2b3guQ2hyb21lVm94Lm5hdmlnYXRpb25NYW5hZ2VyLm5leHQodHJ1ZSk7CiAgaWYgKCFjdm94LkRvbVV0aWwuaXNEZXNjZW5kYW50T2ZOb2RlKAogICAgICBjdm94LkNocm9tZVZveC5uYXZpZ2F0aW9uTWFuYWdlci5nZXRDdXJyZW50Tm9kZSgpLCBzbGlkZUVsc1tjdXJTbGlkZV0pKXsKICAgIHZhciB0YXJnZXQgPSBzbGlkZUVsc1tjdXJTbGlkZV07CiAgICB3aGlsZSAodGFyZ2V0LmZpcnN0Q2hpbGQpIHsKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LmZpcnN0Q2hpbGQ7CiAgICB9CiAgICBjdm94LkNocm9tZVZveC5uYXZpZ2F0aW9uTWFuYWdlci5zeW5jVG9Ob2RlKHRhcmdldCk7CiAgICBjdm94LkNocm9tZVZveC5uYXZpZ2F0aW9uTWFuYWdlci5uZXh0KHRydWUpOwogIH0KICBjdm94LkNocm9tZVZveFVzZXJDb21tYW5kcy5maW5pc2hOYXZDb21tYW5kKCcnKTsKfTsKCmZ1bmN0aW9uIHNwZWFrUHJldkl0ZW0oKSB7CiAgaWYgKCFpc0Nocm9tZVZveEFjdGl2ZSgpKSB7CiAgICByZXR1cm47CiAgfQogIAogIGN2b3guQ2hyb21lVm94Lm5hdmlnYXRpb25NYW5hZ2VyLnN3aXRjaFRvU3RyYXRlZ3koCiAgICAgIGN2b3guQ2hyb21lVm94TmF2aWdhdGlvbk1hbmFnZXIuU1RSQVRFR0lFUy5MSU5FQVJET00sIDAsIHRydWUpOwogIGN2b3guQ2hyb21lVm94Lm5hdmlnYXRpb25NYW5hZ2VyLnByZXZpb3VzKHRydWUpOwogIGlmICghY3ZveC5Eb21VdGlsLmlzRGVzY2VuZGFudE9mTm9kZSgKICAgICAgY3ZveC5DaHJvbWVWb3gubmF2aWdhdGlvbk1hbmFnZXIuZ2V0Q3VycmVudE5vZGUoKSwgc2xpZGVFbHNbY3VyU2xpZGVdKSl7CiAgICB2YXIgdGFyZ2V0ID0gc2xpZGVFbHNbY3VyU2xpZGVdOwogICAgd2hpbGUgKHRhcmdldC5sYXN0Q2hpbGQpewogICAgICB0YXJnZXQgPSB0YXJnZXQubGFzdENoaWxkOwogICAgfQogICAgY3ZveC5DaHJvbWVWb3gubmF2aWdhdGlvbk1hbmFnZXIuc3luY1RvTm9kZSh0YXJnZXQpOwogICAgY3ZveC5DaHJvbWVWb3gubmF2aWdhdGlvbk1hbmFnZXIucHJldmlvdXModHJ1ZSk7CiAgfQogIGN2b3guQ2hyb21lVm94VXNlckNvbW1hbmRzLmZpbmlzaE5hdkNvbW1hbmQoJycpOwp9OwoKLyogSGFzaCBmdW5jdGlvbnMgKi8KCmZ1bmN0aW9uIGdldEN1clNsaWRlRnJvbUhhc2goKSB7CiAgdmFyIHNsaWRlTm8gPSBwYXJzZUludChsb2NhdGlvbi5oYXNoLnN1YnN0cigxKSk7CgogIGlmIChzbGlkZU5vKSB7CiAgICBjdXJTbGlkZSA9IHNsaWRlTm8gLSAxOwogIH0gZWxzZSB7CiAgICBjdXJTbGlkZSA9IDA7CiAgfQp9OwoKZnVuY3Rpb24gdXBkYXRlSGFzaCgpIHsKICBsb2NhdGlvbi5yZXBsYWNlKCcjJyArIChjdXJTbGlkZSArIDEpKTsKfTsKCi8qIEV2ZW50IGxpc3RlbmVycyAqLwoKZnVuY3Rpb24gaGFuZGxlQm9keUtleURvd24oZXZlbnQpIHsKICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHsKICAgIGNhc2UgMzk6IC8vIHJpZ2h0IGFycm93CiAgICBjYXNlIDEzOiAvLyBFbnRlcgogICAgY2FzZSAzMjogLy8gc3BhY2UKICAgIGNhc2UgMzQ6IC8vIFBnRG4KICAgICAgbmV4dFNsaWRlKCk7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzc6IC8vIGxlZnQgYXJyb3cKICAgIGNhc2UgODogLy8gQmFja3NwYWNlCiAgICBjYXNlIDMzOiAvLyBQZ1VwCiAgICAgIHByZXZTbGlkZSgpOwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBicmVhazsKCiAgICBjYXNlIDQwOiAvLyBkb3duIGFycm93CiAgICAgIGlmIChpc0Nocm9tZVZveEFjdGl2ZSgpKSB7CiAgICAgICAgc3BlYWtOZXh0SXRlbSgpOwogICAgICB9IGVsc2UgewogICAgICAgIG5leHRTbGlkZSgpOwogICAgICB9CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzg6IC8vIHVwIGFycm93CiAgICAgIGlmIChpc0Nocm9tZVZveEFjdGl2ZSgpKSB7CiAgICAgICAgc3BlYWtQcmV2SXRlbSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHByZXZTbGlkZSgpOwogICAgICB9CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGJyZWFrOwogIH0KfTsKCmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXJzKCkgewogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVCb2R5S2V5RG93biwgZmFsc2UpOyAgCn07CgovKiBJbml0aWFsaXphdGlvbiAqLwoKZnVuY3Rpb24gYWRkUHJldHRpZnkoKSB7CiAgdmFyIGVscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3ByZScpOwogIGZvciAodmFyIGkgPSAwLCBlbDsgZWwgPSBlbHNbaV07IGkrKykgewogICAgaWYgKCFlbC5jbGFzc0xpc3QuY29udGFpbnMoJ25vcHJldHR5cHJpbnQnKSkgewogICAgICBlbC5jbGFzc0xpc3QuYWRkKCdwcmV0dHlwcmludCcpOwogICAgfQogIH0KICAKICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKICBlbC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7CiAgZWwuc3JjID0gIiR4d2lraS5nZXRBdHRhY2htZW50VVJMKCdQcmVzZW50YXRpb24uUHJlc2VudGF0aW9uU2tpbicsICdwcmV0dGlmeS5qcycpIjsKICBlbC5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgIHByZXR0eVByaW50KCk7CiAgfQogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpOwp9OwoKZnVuY3Rpb24gYWRkRm9udFN0eWxlKCkgewogIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTsKICBlbC5yZWwgPSAnc3R5bGVzaGVldCc7CiAgZWwudHlwZSA9ICd0ZXh0L2Nzcyc7CiAgZWwuaHJlZiA9ICdodHRwOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT0nICsKICAgICAgICAgICAgJ09wZW4rU2FuczpyZWd1bGFyLHNlbWlib2xkLGl0YWxpYyxpdGFsaWNzZW1pYm9sZHxEcm9pZCtTYW5zK01vbm8nOwoKICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTsKfTsKCmZ1bmN0aW9uIGFkZEdlbmVyYWxTdHlsZSgpIHsKICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7CiAgZWwucmVsID0gJ3N0eWxlc2hlZXQnOwogIGVsLnR5cGUgPSAndGV4dC9jc3MnOwogIGVsLmhyZWYgPSAiJHh3aWtpLmdldEF0dGFjaG1lbnRVUkwoJ1ByZXNlbnRhdGlvbi5QcmVzZW50YXRpb25Ta2luJywgJ3N0eWxlcy5jc3MnKSI7CiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7CiAgCiAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpOwogIGVsLm5hbWUgPSAndmlld3BvcnQnOwogIGVsLmNvbnRlbnQgPSAnd2lkdGg9MTEwMCxoZWlnaHQ9NzUwJzsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkJykuYXBwZW5kQ2hpbGQoZWwpOwogIAogIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ21ldGEnKTsKICBlbC5uYW1lID0gJ2FwcGxlLW1vYmlsZS13ZWItYXBwLWNhcGFibGUnOwogIGVsLmNvbnRlbnQgPSAneWVzJzsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkJykuYXBwZW5kQ2hpbGQoZWwpOwp9OwoKZnVuY3Rpb24gbWFrZUJ1aWxkTGlzdHMoKSB7CiAgZm9yICh2YXIgaSA9IGN1clNsaWRlLCBzbGlkZTsgc2xpZGUgPSBzbGlkZUVsc1tpXTsgaSsrKSB7CiAgICB2YXIgaXRlbXMgPSBzbGlkZS5xdWVyeVNlbGVjdG9yQWxsKCcuYnVpbGQgPiAqJyk7CiAgICBmb3IgKHZhciBqID0gMCwgaXRlbTsgaXRlbSA9IGl0ZW1zW2pdOyBqKyspIHsKICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0KSB7CiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCd0by1idWlsZCcpOwogICAgICB9CiAgICB9CiAgfQp9OwoKZnVuY3Rpb24gaGFuZGxlRG9tTG9hZGVkKCkgewogIHNsaWRlRWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2VjdGlvbi5zbGlkZXMgPiBhcnRpY2xlJyk7CgogIC8vIEFkZCB0aGUgdG90YWwgc2xpZGUgY291bnQgYXMgYW4gYXR0cmlidXRlIHRvIGVhY2ggc2xpZGUsIHNvIHRoYXQgaXQgY2FuIGJlIGRpc3BsYXllZCB1c2luZyBDU1MuCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzbGlkZUVscy5sZW5ndGg7ICsraSkgewogICAgc2xpZGVFbHNbaV0uc2V0QXR0cmlidXRlKCd0cG4nLCBzbGlkZUVscy5sZW5ndGgpOwogIH0KCiAgc2V0dXBGcmFtZXMoKTsKCiAgYWRkRm9udFN0eWxlKCk7CiAgYWRkR2VuZXJhbFN0eWxlKCk7CiAgYWRkUHJldHRpZnkoKTsKICBhZGRFdmVudExpc3RlbmVycygpOwoKICB1cGRhdGVTbGlkZXMoKTsKCiAgc2V0dXBJbnRlcmFjdGlvbigpOwogIG1ha2VCdWlsZExpc3RzKCk7CgogIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbG9hZGVkJyk7Cn07CgpmdW5jdGlvbiBpbml0aWFsaXplKCkgewogIGdldEN1clNsaWRlRnJvbUhhc2goKTsKCiAgaWYgKHdpbmRvd1snX0RDTCddKSB7CiAgICBoYW5kbGVEb21Mb2FkZWQoKTsKICB9IGVsc2UgewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGhhbmRsZURvbUxvYWRlZCwgZmFsc2UpOwogIH0KfQoKLy8gSWYgP2RlYnVnIGV4aXN0cyB0aGVuIGxvYWQgdGhlIHNjcmlwdCByZWxhdGl2ZSBpbnN0ZWFkIG9mIGFic29sdXRlCmlmICghd2luZG93WydfREVCVUcnXSAmJiBkb2N1bWVudC5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJz9kZWJ1ZycpICE9PSAtMSkgewogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsKICAgIC8vIEF2b2lkIG1pc3NpbmcgdGhlIERvbUNvbnRlbnRMb2FkZWQgZXZlbnQKICAgIHdpbmRvd1snX0RDTCddID0gdHJ1ZQogIH0sIGZhbHNlKTsKCiAgd2luZG93WydfREVCVUcnXSA9IHRydWU7CiAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogIHNjcmlwdC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7CiAgc2NyaXB0LnNyYyA9ICcuLi9zbGlkZXMuanMnOwogIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOwogIHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2NyaXB0LCBzKTsKCiAgLy8gUmVtb3ZlIHRoaXMgc2NyaXB0CiAgcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHMpOwp9IGVsc2UgewogIGluaXRpYWxpemUoKTsKfQo=</content>
    <filesize>14966</filesize>
  </attachment>
  <attachment>
    <filename>styles.css</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1564816944000</date>
    <version>1.1</version>
    <comment/>
    <content>LyoKICBHb29nbGUgSFRNTDUgc2xpZGVzIHRlbXBsYXRlCgogIEF1dGhvcnM6IEx1a2UgTWFow6kgKGNvZGUpCiAgICAgICAgICAgTWFyY2luIFdpY2hhcnkgKGNvZGUgYW5kIGRlc2lnbikKCiAgICAgICAgICAgRG9taW5pYyBNYXp6b25pIChicm93c2VyIGNvbXBhdGliaWxpdHkpCiAgICAgICAgICAgQ2hhcmxlcyBDaGVuIChDaHJvbWVWb3ggc3VwcG9ydCkKCiAgVVJMOiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvaHRtbDVzbGlkZXMvCiovCgovKiBGcmFtZXdvcmsgKi8KCmh0bWwgewogIGhlaWdodDogMTAwJTsKfQoKYm9keSB7CiAgbWFyZ2luOiAwOwogIHBhZGRpbmc6IDA7CgogIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7CgogIGhlaWdodDogMTAwJTsKICBtaW4taGVpZ2h0OiA3NDBweDsKCiAgb3ZlcmZsb3cteDogaGlkZGVuOwogIG92ZXJmbG93LXk6IGF1dG87CgogIGJhY2tncm91bmQ6IC1vLXJhZGlhbC1ncmFkaWVudChyZ2IoMjQwLCAyNDAsIDI0MCksIHJnYigxOTAsIDE5MCwgMTkwKSk7CiAgYmFja2dyb3VuZDogLW1vei1yYWRpYWwtZ3JhZGllbnQocmdiKDI0MCwgMjQwLCAyNDApLCByZ2IoMTkwLCAxOTAsIDE5MCkpOwogIGJhY2tncm91bmQ6IC13ZWJraXQtcmFkaWFsLWdyYWRpZW50KHJnYigyNDAsIDI0MCwgMjQwKSwgcmdiKDE5MCwgMTkwLCAxOTApKTsKICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQocmdiKDI0MCwgMjQwLCAyNDApLCByZ2IoMTkwLCAxOTAsIDE5MCkpOwoKICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKfQoKLnNsaWRlcyB7CiAgd2lkdGg6IDEwMCU7CiAgaGVpZ2h0OiAxMDAlOwogIGxlZnQ6IDA7CiAgdG9wOiAwOwoKICBwb3NpdGlvbjogYWJzb2x1dGU7CgogIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUzZCgwLCAwLCAwKTsKfQoKLnNsaWRlcyA+IGFydGljbGUgewogIGRpc3BsYXk6IGJsb2NrOwoKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKCiAgd2lkdGg6IDkwMHB4OwogIGhlaWdodDogNzAwcHg7CgogIGxlZnQ6IDUwJTsKICB0b3A6IDUwJTsKCiAgbWFyZ2luLWxlZnQ6IC00NTBweDsKICBtYXJnaW4tdG9wOiAtMzUwcHg7CgogIHBhZGRpbmc6IDQwcHggNTBweDsKCiAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94OwogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CgogIGJvcmRlci1yYWRpdXM6IDEwcHg7CgogIGJhY2tncm91bmQtY29sb3I6IHdoaXRlOwoKICBib3gtc2hhZG93OiAwIDJweCA2cHggcmdiYSgwLCAwLCAwLCAuMSk7CiAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLCAwLCAwLCAuMyk7CgogIC1vLXRyYW5zaXRpb246IC1vLXRyYW5zZm9ybSAuM3MgZWFzZS1vdXQ7CiAgLW1vei10cmFuc2l0aW9uOiAtbW96LXRyYW5zZm9ybSAuM3MgZWFzZS1vdXQ7CiAgLXdlYmtpdC10cmFuc2l0aW9uOiAtd2Via2l0LXRyYW5zZm9ybSAuM3MgZWFzZS1vdXQ7CiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIC4zcyBlYXNlLW91dDsKfQouc2xpZGVzLmxheW91dC13aWRlc2NyZWVuID4gYXJ0aWNsZSB7CiAgbWFyZ2luLWxlZnQ6IC01NTBweDsKICB3aWR0aDogMTEwMHB4Owp9Ci5zbGlkZXMubGF5b3V0LWZhdXgtd2lkZXNjcmVlbiA+IGFydGljbGUgewogIG1hcmdpbi1sZWZ0OiAtNTUwcHg7CiAgd2lkdGg6IDExMDBweDsKCiAgcGFkZGluZzogNDBweCAxNjBweDsKfQoKLnNsaWRlcy50ZW1wbGF0ZS1kZWZhdWx0ID4gYXJ0aWNsZTpub3QoLm5vYmFja2dyb3VuZCk6bm90KC5iaWdsb2dvKSB7CiAgYmFja2dyb3VuZDogdXJsKCdsb2dvLnBuZycpIHJpZ2h0IDIwcHggYm90dG9tIDIwcHggbm8tcmVwZWF0IHdoaXRlOwp9CgovKiBDbGlja2FibGUvdGFwcGFibGUgYXJlYXMgKi8KCi5zbGlkZS1hcmVhIHsKICB6LWluZGV4OiAxMDAwOwoKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogMDsKICB0b3A6IDA7CiAgd2lkdGg6IDE1MHB4OwogIGhlaWdodDogNzAwcHg7CgogIGxlZnQ6IDUwJTsKICB0b3A6IDUwJTsKCiAgY3Vyc29yOiBwb2ludGVyOwogIG1hcmdpbi10b3A6IC0zNTBweDsKCiAgLW8tdGFwLWhpZ2hsaWdodC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgLW1vei10YXAtaGlnaGxpZ2h0LWNvbG9yOiB0cmFuc3BhcmVudDsKICAtd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50OwogIHRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50Owp9CiNwcmV2LXNsaWRlLWFyZWEgewogIG1hcmdpbi1sZWZ0OiAtNTUwcHg7Cn0KI25leHQtc2xpZGUtYXJlYSB7CiAgbWFyZ2luLWxlZnQ6IDQwMHB4Owp9Ci5zbGlkZXMubGF5b3V0LXdpZGVzY3JlZW4gI3ByZXYtc2xpZGUtYXJlYSwKLnNsaWRlcy5sYXlvdXQtZmF1eC13aWRlc2NyZWVuICNwcmV2LXNsaWRlLWFyZWEgewogIG1hcmdpbi1sZWZ0OiAtNjUwcHg7Cn0KLnNsaWRlcy5sYXlvdXQtd2lkZXNjcmVlbiAjbmV4dC1zbGlkZS1hcmVhLAouc2xpZGVzLmxheW91dC1mYXV4LXdpZGVzY3JlZW4gI25leHQtc2xpZGUtYXJlYSB7CiAgbWFyZ2luLWxlZnQ6IDUwMHB4Owp9CgovKiBTbGlkZSBzdHlsZXMgKi8KCi5zbGlkZXMudGVtcGxhdGUtZGVmYXVsdCBhcnRpY2xlLmJpZ2xvZ28gewogIGJhY2tncm91bmQ6IHVybCgnbG9nb2JpZy5wbmcnKSA1MCUgNTAlIG5vLXJlcGVhdCB3aGl0ZTsKfQoKLyogU2xpZGVzICovCgouc2xpZGVzID4gYXJ0aWNsZSB7CiAgdmlzaWJpbGl0eTogaGlkZGVuOwogIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTI1MDBweCk7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTI1MDBweCk7Cn0KLnNsaWRlcyA+IGFydGljbGUuZmFyLW5leHQgfiBhcnRpY2xlIHsKICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlKDI1MDBweCk7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMjUwMHB4KTsKfQouc2xpZGVzID4gYXJ0aWNsZS5mYXItcGFzdCB7CiAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlKC0yMDQwcHgpOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC0yMDQwcHgpOwp9Ci5zbGlkZXMgPiBhcnRpY2xlLnBhc3QgewogIHZpc2liaWxpdHk6IHZpc2libGU7CiAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZSgtMTAyMHB4KTsKICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtMTAyMHB4KTsKfQouc2xpZGVzID4gYXJ0aWNsZS5jdXJyZW50IHsKICB2aXNpYmlsaXR5OiB2aXNpYmxlOwogIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUoMCk7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMCk7Cn0KLnNsaWRlcyA+IGFydGljbGUubmV4dCB7CiAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlKDEwMjBweCk7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMTAyMHB4KTsKfQouc2xpZGVzID4gYXJ0aWNsZS5mYXItbmV4dCB7CiAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlKDIwNDBweCk7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMjA0MHB4KTsKfQoKLnNsaWRlcy5sYXlvdXQtd2lkZXNjcmVlbiA+IGFydGljbGUuZmFyLXBhc3QsCi5zbGlkZXMubGF5b3V0LWZhdXgtd2lkZXNjcmVlbiA+IGFydGljbGUuZmFyLXBhc3QgewogIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTIyNjBweCk7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTIyNjBweCk7Cn0KLnNsaWRlcy5sYXlvdXQtd2lkZXNjcmVlbiA+IGFydGljbGUucGFzdCwKLnNsaWRlcy5sYXlvdXQtZmF1eC13aWRlc2NyZWVuID4gYXJ0aWNsZS5wYXN0IHsKICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlKC0xMTMwcHgpOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC0xMTMwcHgpOwp9Ci5zbGlkZXMubGF5b3V0LXdpZGVzY3JlZW4gPiBhcnRpY2xlLm5leHQsCi5zbGlkZXMubGF5b3V0LWZhdXgtd2lkZXNjcmVlbiA+IGFydGljbGUubmV4dCB7CiAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZSgxMTMwcHgpOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlKDExMzBweCk7Cn0KLnNsaWRlcy5sYXlvdXQtd2lkZXNjcmVlbiA+IGFydGljbGUuZmFyLW5leHQsCi5zbGlkZXMubGF5b3V0LWZhdXgtd2lkZXNjcmVlbiA+IGFydGljbGUuZmFyLW5leHQgewogIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUoMjI2MHB4KTsKICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgyMjYwcHgpOwp9CgovKiBTdHlsZXMgZm9yIHNsaWRlcyAqLwoKLnNsaWRlcyA+IGFydGljbGUgewogIGZvbnQtZmFtaWx5OiAnT3BlbiBTYW5zJywgQXJpYWwsIHNhbnMtc2VyaWY7CgogIGNvbG9yOiByZ2IoMTAyLCAxMDIsIDEwMik7CiAgdGV4dC1zaGFkb3c6IDAgMXB4IDFweCByZ2JhKDAsIDAsIDAsIC4xKTsKCiAgZm9udC1zaXplOiAzMHB4OwogIGxpbmUtaGVpZ2h0OiAzNnB4OwoKICBsZXR0ZXItc3BhY2luZzogLTFweDsKfQoKYiB7CiAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKLmJsdWUgewogIGNvbG9yOiByZ2IoMCwgMTAyLCAyMDQpOwp9Ci55ZWxsb3cgewogIGNvbG9yOiByZ2IoMjU1LCAyMTEsIDI1KTsKfQouZ3JlZW4gewogIGNvbG9yOiByZ2IoMCwgMTM4LCA1Myk7Cn0KLnJlZCB7CiAgY29sb3I6IHJnYigyNTUsIDAsIDApOwp9Ci5ibGFjayB7CiAgY29sb3I6IGJsYWNrOwp9Ci53aGl0ZSB7CiAgY29sb3I6IHdoaXRlOwp9CgphIHsKICBjb2xvcjogcmdiKDAsIDEwMiwgMjA0KTsKfQphOnZpc2l0ZWQgewogIGNvbG9yOiByZ2JhKDAsIDEwMiwgMjA0LCAuNzUpOwp9CmE6aG92ZXIgewogIGNvbG9yOiBibGFjazsKfQoKcCB7CiAgbWFyZ2luOiAwOwogIHBhZGRpbmc6IDA7Cn0KcDpmaXJzdC1jaGlsZCB7CiAgbWFyZ2luLXRvcDogMDsKfQoKaDEgewogIGZvbnQtc2l6ZTogNjBweDsKICBsaW5lLWhlaWdodDogNjBweDsKCiAgcGFkZGluZzogMDsKICBtYXJnaW46IDA7CiAgbWFyZ2luLXRvcDogMjAwcHg7CiAgcGFkZGluZy1yaWdodDogNDBweDsKCiAgZm9udC13ZWlnaHQ6IDYwMDsKCiAgbGV0dGVyLXNwYWNpbmc6IC0zcHg7CgogIGNvbG9yOiByZ2IoNTEsIDUxLCA1MSk7Cn0KCmgyIHsKICBmb250LXNpemU6IDQ1cHg7CiAgbGluZS1oZWlnaHQ6IDQ1cHg7CgogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBib3R0b206IDE1MHB4OwoKICBwYWRkaW5nOiAwOwogIG1hcmdpbjogMDsKICBwYWRkaW5nLXJpZ2h0OiA0MHB4OwoKICBmb250LXdlaWdodDogNjAwOwoKICBsZXR0ZXItc3BhY2luZzogLTJweDsKCiAgY29sb3I6IHJnYig1MSwgNTEsIDUxKTsKfQoKaDMgewogIGZvbnQtc2l6ZTogMzBweDsKICBsaW5lLWhlaWdodDogMzZweDsKCiAgcGFkZGluZzogMDsKICBtYXJnaW46IDA7CiAgbWFyZ2luLWJvdHRvbTogMjBweDsKICBwYWRkaW5nLXJpZ2h0OiA0MHB4OwoKICBmb250LXdlaWdodDogNjAwOwoKICBsZXR0ZXItc3BhY2luZzogLTFweDsKCiAgY29sb3I6IHJnYig1MSwgNTEsIDUxKTsKfQoKYXJ0aWNsZS5maWxsIGgzIHsKICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIC43NSk7CiAgcGFkZGluZy10b3A6IC4yZW07CiAgcGFkZGluZy1ib3R0b206IC4zZW07CiAgbWFyZ2luLXRvcDogLS4yZW07CiAgbWFyZ2luLWxlZnQ6IC02MHB4OwogIHBhZGRpbmctbGVmdDogNjBweDsKICBtYXJnaW4tcmlnaHQ6IC02MHB4OwogIHBhZGRpbmctcmlnaHQ6IDYwcHg7Cn0KCnVsIHsKICBsaXN0LXN0eWxlOiBub25lOwogIG1hcmdpbjogMDsKICBwYWRkaW5nOiAwOwoKICBtYXJnaW4tdG9wOiA0MHB4OwoKICBtYXJnaW4tbGVmdDogLjc1ZW07Cn0KdWw6Zmlyc3QtY2hpbGQgewogIG1hcmdpbi10b3A6IDA7Cn0KdWwgdWwgewogIG1hcmdpbi10b3A6IC41ZW07Cn0KbGkgewogIHBhZGRpbmc6IDA7CiAgbWFyZ2luOiAwOwoKICBtYXJnaW4tYm90dG9tOiAuNWVtOwp9CnVsPmxpOjpiZWZvcmUgewogIGNvbnRlbnQ6ICfCtyc7CgogIHdpZHRoOiAuNzVlbTsKICBtYXJnaW4tbGVmdDogLS43NWVtOwoKICBwb3NpdGlvbjogYWJzb2x1dGU7Cn0KCnByZSB7CiAgZm9udC1mYW1pbHk6ICdEcm9pZCBTYW5zIE1vbm8nLCAnQ291cmllciBOZXcnLCBtb25vc3BhY2U7CgogIGZvbnQtc2l6ZTogMjBweDsKICBsaW5lLWhlaWdodDogMjhweDsKICBwYWRkaW5nOiA1cHggMTBweDsKCiAgbGV0dGVyLXNwYWNpbmc6IC0xcHg7CgogIG1hcmdpbi10b3A6IDQwcHg7CiAgbWFyZ2luLWJvdHRvbTogNDBweDsKCiAgY29sb3I6IGJsYWNrOwogIGJhY2tncm91bmQ6IHJnYigyNDAsIDI0MCwgMjQwKTsKICBib3JkZXI6IDFweCBzb2xpZCByZ2IoMjI0LCAyMjQsIDIyNCk7CiAgYm94LXNoYWRvdzogaW5zZXQgMCAycHggNnB4IHJnYmEoMCwgMCwgMCwgLjEpOwoKICBvdmVyZmxvdzogaGlkZGVuOwp9Cgpjb2RlIHsKICBmb250LXNpemU6IDk1JTsKICBmb250LWZhbWlseTogJ0Ryb2lkIFNhbnMgTW9ubycsICdDb3VyaWVyIE5ldycsIG1vbm9zcGFjZTsKCiAgY29sb3I6IGJsYWNrOwp9CgppZnJhbWUgewogIHdpZHRoOiAxMDAlOwoKICBoZWlnaHQ6IDYyMHB4OwoKICBiYWNrZ3JvdW5kOiB3aGl0ZTsKICBib3JkZXI6IDFweCBzb2xpZCByZ2IoMTkyLCAxOTIsIDE5Mik7CiAgbWFyZ2luOiAtMXB4OwogIC8qYm94LXNoYWRvdzogaW5zZXQgMCAycHggNnB4IHJnYmEoMCwgMCwgMCwgLjEpOyovCn0KCmgzICsgaWZyYW1lIHsKICBtYXJnaW4tdG9wOiA0MHB4OwogIGhlaWdodDogNTQwcHg7Cn0KCmFydGljbGUuZmlsbCBpZnJhbWUgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBsZWZ0OiAwOwogIHRvcDogMDsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDEwMCU7CgogIGJvcmRlcjogMDsKICBtYXJnaW46IDA7CgogIGJvcmRlci1yYWRpdXM6IDEwcHg7CgogIHotaW5kZXg6IC0xOwp9CgphcnRpY2xlLmZpbGwgaW1nIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogMDsKICB0b3A6IDA7CiAgbWluLXdpZHRoOiAxMDAlOwogIG1pbi1oZWlnaHQ6IDEwMCU7CgogIGJvcmRlci1yYWRpdXM6IDEwcHg7CgogIHotaW5kZXg6IC0xOwp9CmltZy5jZW50ZXJlZCB7CiAgbWFyZ2luOiAwIGF1dG87CiAgZGlzcGxheTogYmxvY2s7Cn0KCnRhYmxlIHsKICB3aWR0aDogMTAwJTsKICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwogIG1hcmdpbi10b3A6IDQwcHg7Cn0KdGggewogIGZvbnQtd2VpZ2h0OiA2MDA7CiAgdGV4dC1hbGlnbjogbGVmdDsKfQp0ZCwKdGggewogIGJvcmRlcjogMXB4IHNvbGlkIHJnYigyMjQsIDIyNCwgMjI0KTsKICBwYWRkaW5nOiA1cHggMTBweDsKICB2ZXJ0aWNhbC1hbGlnbjogdG9wOwp9Cgouc291cmNlIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogNjBweDsKICB0b3A6IDY0NHB4OwogIHBhZGRpbmctcmlnaHQ6IDE3NXB4OwoKICBmb250LXNpemU6IDE1cHg7CiAgbGV0dGVyLXNwYWNpbmc6IDA7CiAgbGluZS1oZWlnaHQ6IDE4cHg7Cn0KCnEsIGJsb2NrcXVvdGUgewogIGRpc3BsYXk6IGJsb2NrOwogIGZvbnQtc2l6ZTogNjBweDsKICBsaW5lLWhlaWdodDogNzJweDsKCiAgbWFyZ2luLWxlZnQ6IDIwcHg7CgogIG1hcmdpbi10b3A6IDEwMHB4OwogIG1hcmdpbi1yaWdodDogMjBweDsKfQpibG9ja3F1b3RlPio6Zmlyc3QtY2hpbGQ6OmJlZm9yZSwgcTo6YmVmb3JlIHsKICBjb250ZW50OiAn4oCcJzsKCiAgcG9zaXRpb246IGFic29sdXRlOwogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBtYXJnaW4tbGVmdDogLTIuMWVtOwogIHdpZHRoOiAyZW07CiAgdGV4dC1hbGlnbjogcmlnaHQ7CgogIGZvbnQtc2l6ZTogOTBweDsKICBjb2xvcjogcmdiKDE5MiwgMTkyLCAxOTIpOwp9CmJsb2NrcXVvdGU+KjpmaXJzdC1jaGlsZDo6YWZ0ZXIsIHE6OmFmdGVyIHsKICBjb250ZW50OiAn4oCdJzsKCiAgcG9zaXRpb246IGFic29sdXRlOwogIG1hcmdpbi1sZWZ0OiAuMWVtOwoKICBmb250LXNpemU6IDkwcHg7CiAgY29sb3I6IHJnYigxOTIsIDE5MiwgMTkyKTsKfQouYXV0aG9yIHsKICB0ZXh0LWFsaWduOiByaWdodDsKICBmb250LXNpemU6IDQwcHg7CgogIG1hcmdpbi10b3A6IDIwcHg7CiAgbWFyZ2luLXJpZ2h0OiAxNTBweDsKfQouYXV0aG9yOjpiZWZvcmUgewogIGNvbnRlbnQ6ICfigJQnOwp9CgovKiBTaXplIHZhcmlhbnRzICovCgphcnRpY2xlLnNtYWxsZXIgcCwKYXJ0aWNsZS5zbWFsbGVyIHVsIHsKICBmb250LXNpemU6IDIwcHg7CiAgbGluZS1oZWlnaHQ6IDI0cHg7CiAgbGV0dGVyLXNwYWNpbmc6IDA7Cn0KYXJ0aWNsZS5zbWFsbGVyIHRhYmxlIHsKICBmb250LXNpemU6IDIwcHg7CiAgbGluZS1oZWlnaHQ6IDI0cHg7CiAgbGV0dGVyLXNwYWNpbmc6IDA7Cn0KYXJ0aWNsZS5zbWFsbGVyIHByZSwgYXJ0aWNsZS5zbWFsbGVyIC5jb2RlIHsKICBmb250LXNpemU6IDE1cHg7CiAgbGluZS1oZWlnaHQ6IDIwcHg7CiAgbGV0dGVyLXNwYWNpbmc6IDA7Cn0KYXJ0aWNsZS5zbWFsbGVyIHEgewogIGZvbnQtc2l6ZTogNDBweDsKICBsaW5lLWhlaWdodDogNDhweDsKfQphcnRpY2xlLnNtYWxsZXIgcTo6YmVmb3JlLAphcnRpY2xlLnNtYWxsZXIgcTo6YWZ0ZXIgewogIGZvbnQtc2l6ZTogNjBweDsKfQoKLyogQnVpbGRzICovCgouYnVpbGQgPiAqIHsKICAtby10cmFuc2l0aW9uOiBvcGFjaXR5IDAuNXMgZWFzZS1pbi1vdXQgMC4yczsKICAtbW96LXRyYW5zaXRpb246IG9wYWNpdHkgMC41cyBlYXNlLWluLW91dCAwLjJzOwogIC13ZWJraXQtdHJhbnNpdGlvbjogb3BhY2l0eSAwLjVzIGVhc2UtaW4tb3V0IDAuMnM7CiAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjVzIGVhc2UtaW4tb3V0IDAuMnM7Cn0KCi50by1idWlsZCB7CiAgb3BhY2l0eTogMDsKfQoKLyogUHJldHR5IHByaW50ICovCgoucHJldHR5cHJpbnQgLnN0ciwgLyogc3RyaW5nIGNvbnRlbnQgKi8KLnByZXR0eXByaW50IC5hdHYgeyAvKiBhIG1hcmt1cCBhdHRyaWJ1dGUgdmFsdWUgKi8KICBjb2xvcjogcmdiKDAsIDEzOCwgNTMpOwp9Ci5wcmV0dHlwcmludCAua3dkLCAvKiBhIGtleXdvcmQgKi8KLnByZXR0eXByaW50IC50YWcgeyAvKiBhIG1hcmt1cCB0YWcgbmFtZSAqLwogIGNvbG9yOiByZ2IoMCwgMTAyLCAyMDQpOwp9Ci5wcmV0dHlwcmludCAuY29tIHsgLyogYSBjb21tZW50ICovCiAgY29sb3I6IHJnYigxMjcsIDEyNywgMTI3KTsKICBmb250LXN0eWxlOiBpdGFsaWM7Cn0KLnByZXR0eXByaW50IC5saXQgeyAvKiBhIGxpdGVyYWwgdmFsdWUgKi8KICBjb2xvcjogcmdiKDEyNywgMCwgMCk7Cn0KLnByZXR0eXByaW50IC5wdW4sIC8qIHB1bmN0dWF0aW9uLCBsaXNwIG9wZW4gYnJhY2tldCwgbGlzcCBjbG9zZSBicmFja2V0ICovCi5wcmV0dHlwcmludCAub3BuLAoucHJldHR5cHJpbnQgLmNsbyB7CiAgY29sb3I6IHJnYigxMjcsIDEyNywgMTI3KTsKfQoucHJldHR5cHJpbnQgLnR5cCwgLyogYSB0eXBlIG5hbWUgKi8KLnByZXR0eXByaW50IC5hdG4sIC8qIGEgbWFya3VwIGF0dHJpYnV0ZSBuYW1lICovCi5wcmV0dHlwcmludCAuZGVjLAoucHJldHR5cHJpbnQgLnZhciB7IC8qIGEgZGVjbGFyYXRpb247IGEgdmFyaWFibGUgbmFtZSAqLwogIGNvbG9yOiByZ2IoMTI3LCAwLCAxMjcpOwp9CgphcnRpY2xlIHsKICBjb3VudGVyLWluY3JlbWVudDogcG5vOwp9CmFydGljbGU6bm90KC5ub2JhY2tncm91bmQpOm5vdCguZmlsbCk6bm90KC5iaWdsb2dvKTphZnRlciB7CiAgYm90dG9tOiAyMHB4OwogIGNvbnRlbnQ6IGNvdW50ZXIocG5vKSAiLyIgYXR0cih0cG4pOwogIGxlZnQ6IDIwcHg7CiAgcG9zaXRpb246IGFic29sdXRlOwp9CmFydGljbGUubm90aXRsZSBoMiwgYXJ0aWNsZS5ub3RpdGxlIGgzIHsKICBkaXNwbGF5OiBub25lOwp9CgphcnRpY2xlIC5zdmctYnV0dG9ucyB7CiAgZGlzcGxheTogbm9uZTsKfQo=</content>
    <filesize>9809</filesize>
  </attachment>
  <object>
    <name>Presentation.PresentationSkin</name>
    <number>0</number>
    <className>XWiki.DocumentSheetBinding</className>
    <guid>0091e8a9-12d8-418d-98db-ca6236019533</guid>
    <class>
      <name>XWiki.DocumentSheetBinding</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <sheet>
        <cache>0</cache>
        <classname/>
        <customDisplay/>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <hint/>
        <idField/>
        <multiSelect>0</multiSelect>
        <name>sheet</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Sheet</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators/>
        <size>30</size>
        <sort>none</sort>
        <sql/>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <valueField/>
        <classType>com.xpn.xwiki.objects.classes.PageClass</classType>
      </sheet>
    </class>
    <property>
      <sheet/>
    </property>
  </object>
  <object>
    <name>Presentation.PresentationSkin</name>
    <number>0</number>
    <className>XWiki.XWikiSkins</className>
    <guid>95909a9a-4b59-4340-af3d-62c56a7ccc61</guid>
    <class>
      <name>XWiki.XWikiSkins</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <baseskin>
        <disabled>0</disabled>
        <name>baseskin</name>
        <number>2</number>
        <prettyName>Base Skin</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </baseskin>
      <edit.vm>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>edit.vm</name>
        <number>10</number>
        <prettyName>Edit</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </edit.vm>
      <footer.vm>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>footer.vm</name>
        <number>7</number>
        <prettyName>Footer</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </footer.vm>
      <header.vm>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>header.vm</name>
        <number>6</number>
        <prettyName>Header</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </header.vm>
      <logo>
        <disabled>0</disabled>
        <name>logo</name>
        <number>3</number>
        <prettyName>Logo</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </logo>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <outputSyntax>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>outputSyntax</name>
        <number>4</number>
        <prettyName>Output Syntax</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators>|, </separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>html/5.0=HTML 5|xhtml/1.0=XHTML 1.0</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </outputSyntax>
      <style.css>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>style.css</name>
        <number>5</number>
        <prettyName>Style</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </style.css>
      <view.vm>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>view.vm</name>
        <number>9</number>
        <prettyName>View</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </view.vm>
      <viewheader.vm>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>viewheader.vm</name>
        <number>8</number>
        <prettyName>View Header</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </viewheader.vm>
    </class>
    <property>
      <baseskin/>
    </property>
    <property>
      <edit.vm/>
    </property>
    <property>
      <footer.vm/>
    </property>
    <property>
      <header.vm/>
    </property>
    <property>
      <logo/>
    </property>
    <property>
      <name>HTML5 Presentation</name>
    </property>
    <property>
      <outputSyntax/>
    </property>
    <property>
      <style.css>#template('colorThemeInit.vm')

.wikimodel-emptyline {
  height: 1em;
}

.loading {
  background: url("$xwiki.getSkinFile('icons/xwiki/spinner.gif')") no-repeat scroll center center transparent;
}

.code, .box {
  background-color: $theme.backgroundSecondaryColor;
  border: 1px dotted $theme.borderColor;
  font-size: 70%;
  line-height: 120%
}

.code, .code pre, .code *  {
  font-family: courier, "courier new", monospace;
  white-space: pre;
}

th {
  background-color: #F3F3F3
}
</style.css>
    </property>
    <property>
      <view.vm>&lt;!DOCTYPE html&gt;

&lt;!-- Adapted from http://code.google.com/p/html5slides/ --&gt;

&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;$doc.plainTitle&lt;/title&gt;
    &lt;meta charset='utf-8'&gt;
    &lt;script src='$xwiki.getSkinFile("js/prototype/prototype.js")'&gt;&lt;/script&gt;
#if(!$request.print)
    &lt;script src='$xwiki.getSkinFile("slides.js")'&gt;&lt;/script&gt;
#end
    &lt;script src='$xwiki.getSkinFile("js/xwiki/xwiki.js")'&gt;&lt;/script&gt;
    &lt;!-- com.xpn.xwiki.plugin.skinx.JsResourceSkinExtensionPlugin --&gt;
    &lt;!-- com.xpn.xwiki.plugin.skinx.JsSkinFileExtensionPlugin --&gt;
    &lt;!-- com.xpn.xwiki.plugin.skinx.JsSkinExtensionPlugin --&gt;
    &lt;script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/markerScript.js", false)" defer="defer"&gt;&lt;/script&gt;
    &lt;link href='$xwiki.getSkinFile("style.css")' rel="stylesheet" type="text/css"/&gt;
#if($request.print)
    &lt;link href='$xwiki.getSkinFile("styles.css")' rel="stylesheet" type="text/css"/&gt;
    &lt;link href='$xwiki.getSkinFile("print.css")' rel="stylesheet" type="text/css"/&gt;
#end
    &lt;!-- com.xpn.xwiki.plugin.skinx.CssResourceSkinExtensionPlugin --&gt;
    &lt;!-- com.xpn.xwiki.plugin.skinx.CssSkinExtensionPlugin --&gt;
    &lt;!-- com.xpn.xwiki.plugin.skinx.CssSkinFileExtensionPlugin --&gt;
  &lt;/head&gt;

#if($request.print)
  &lt;body&gt;
#else
  &lt;body style='display: none'&gt;
#end
    #set($presentation = $doc.getObject("Presentation.PresentationClass"))
    #set($layout = $presentation.getProperty("layout").value)
    #if ("$!layout" == "")
      #set ($layout = "layout-regular")
    #end
    #set($theme = $presentation.getProperty("theme").value)
    #if ("$!theme" == "")
      #set ($theme = "template-default")
    #end

    &lt;section class='slides $layout $theme'&gt;

      &lt;article class='biglogo'&gt;
      &lt;/article&gt;

      #includeInContext("Presentation.PresentationSlideGenerator")

    &lt;/section&gt;

  &lt;/body&gt;
&lt;/html&gt;</view.vm>
    </property>
    <property>
      <viewheader.vm/>
    </property>
  </object>
</xwikidoc>
